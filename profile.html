
<!DOCTYPE html>
<html>
  <head>
<!--    <meta http-equiv="Content-Security-Policy" content="script-src *  'self' 'unsafe-inline' 'unsafe-eval' default-src * data: blob: vscode-webview-resource: ;"> -->
  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:; script-src * 'unsafe-inline' 'unsafe-eval' data: blob:; style-src * 'unsafe-inline' 'unsafe-eval' data: blob:; img-src * 'unsafe-inline' 'unsafe-eval' data: blob:; connect-src * 'unsafe-inline' 'unsafe-eval' data: blob:; font-src * 'unsafe-inline' 'unsafe-eval' data: blob:; object-src * 'unsafe-inline' 'unsafe-eval' data: blob:; media-src * 'unsafe-inline' 'unsafe-eval' data: blob:; frame-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">
<!--    <meta http-equiv="Content-Security-Policy" content="default-src * data: blob: vscode-webview-resource: 'unsafe-inline' 'unsafe-eval' ; script-src * data: blob: vscode-webview-resource: 'unsafe-inline' 'unsafe-eval';"> -->
    <title>Scalene</title>
    <link rel="icon" href="https://raw.githubusercontent.com/plasma-umass/scalene/master/scalene/scalene-gui/favicon.ico" type="image/x-icon">
    <!-- Latest compiled and minified CSS -->
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1543.0.min.js"></script>
    <style>
#vg-tooltip-element {
  z-index: 2000;
}
 body { 
  padding: 0 0 90px 0;
}
    </style>
    <style>
      /* PrismJS 1.26.0
https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+python&plugins=normalize-whitespace */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}


    </style>
    <style>
      .table-condensed>thead>tr>th, .table-condensed>tbody>tr>th, .table-condensed>tfoot>tr>th, .table-condensed>thead>tr>td, .table-condensed>tbody>tr>td, .table-condensed>tfoot>tr>td{
	  padding: 1px; border-spacing: 0px; border:none;
      }
    form label:hover, form button:hover {
      background-color: black;
      color: white;
    }

    form label:active, form button:active {
      background-color: blue;
      color: white;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
	
    .text-and-upload {
      display: inline-flex;
      align-items: center; /* Align items vertically */
      }
      
      /* Ensuring the p tag takes the full width */
    .text-center {
        width: 100%;
        text-align: center;
    }

    /* Styling for the SVG */
    .svg-upload {
        height: 20px;
        width: 20px;
        cursor: pointer;
    }
    
    /* Hiding the file input but keeping it functional */
    #fileinput {
        height: 0;
        width: 0;
        opacity: 0;
        position: absolute;
    }
    </style>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4JXPHEBMTY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      gtag('config', 'G-4JXPHEBMTY');
    </script>

    <script>
      /* PrismJS 1.26.0
https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+python&plugins=normalize-whitespace */
/// <reference lib="WebWorker"/>

var _self =
  typeof window !== "undefined"
    ? window // if in browser
    : typeof WorkerGlobalScope !== "undefined" &&
        self instanceof WorkerGlobalScope
      ? self // if in worker
      : {}; // if in node js

/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */
var Prism = (function (_self) {
  // Private helper vars
  var lang = /(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i;
  var uniqueId = 0;

  // The grammar object for plaintext
  var plainTextGrammar = {};

  var _ = {
    /**
     * By default, Prism will attempt to highlight all code elements (by calling {@link Prism.highlightAll}) on the
     * current page after the page finished loading. This might be a problem if e.g. you wanted to asynchronously load
     * additional languages or plugins yourself.
     *
     * By setting this value to `true`, Prism will not automatically highlight all code elements on the page.
     *
     * You obviously have to change this value before the automatic highlighting started. To do this, you can add an
     * empty Prism object into the global scope before loading the Prism script like this:
     *
     * ```js
     * window.Prism = window.Prism || {};
     * Prism.manual = true;
     * // add a new <script> to load Prism's script
     * ```
     *
     * @default false
     * @type {boolean}
     * @memberof Prism
     * @public
     */
    manual: _self.Prism && _self.Prism.manual,
    /**
     * By default, if Prism is in a web worker, it assumes that it is in a worker it created itself, so it uses
     * `addEventListener` to communicate with its parent instance. However, if you're using Prism manually in your
     * own worker, you don't want it to do this.
     *
     * By setting this value to `true`, Prism will not add its own listeners to the worker.
     *
     * You obviously have to change this value before Prism executes. To do this, you can add an
     * empty Prism object into the global scope before loading the Prism script like this:
     *
     * ```js
     * window.Prism = window.Prism || {};
     * Prism.disableWorkerMessageHandler = true;
     * // Load Prism's script
     * ```
     *
     * @default false
     * @type {boolean}
     * @memberof Prism
     * @public
     */
    disableWorkerMessageHandler:
      _self.Prism && _self.Prism.disableWorkerMessageHandler,

    /**
     * A namespace for utility methods.
     *
     * All function in this namespace that are not explicitly marked as _public_ are for __internal use only__ and may
     * change or disappear at any time.
     *
     * @namespace
     * @memberof Prism
     */
    util: {
      encode: function encode(tokens) {
        if (tokens instanceof Token) {
          return new Token(tokens.type, encode(tokens.content), tokens.alias);
        } else if (Array.isArray(tokens)) {
          return tokens.map(encode);
        } else {
          return tokens
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/\u00a0/g, " ");
        }
      },

      /**
       * Returns the name of the type of the given value.
       *
       * @param {any} o
       * @returns {string}
       * @example
       * type(null)      === 'Null'
       * type(undefined) === 'Undefined'
       * type(123)       === 'Number'
       * type('foo')     === 'String'
       * type(true)      === 'Boolean'
       * type([1, 2])    === 'Array'
       * type({})        === 'Object'
       * type(String)    === 'Function'
       * type(/abc+/)    === 'RegExp'
       */
      type: function (o) {
        return Object.prototype.toString.call(o).slice(8, -1);
      },

      /**
       * Returns a unique number for the given object. Later calls will still return the same number.
       *
       * @param {Object} obj
       * @returns {number}
       */
      objId: function (obj) {
        if (!obj["__id"]) {
          Object.defineProperty(obj, "__id", { value: ++uniqueId });
        }
        return obj["__id"];
      },

      /**
       * Creates a deep clone of the given object.
       *
       * The main intended use of this function is to clone language definitions.
       *
       * @param {T} o
       * @param {Record<number, any>} [visited]
       * @returns {T}
       * @template T
       */
      clone: function deepClone(o, visited) {
        visited = visited || {};

        var clone;
        var id;
        switch (_.util.type(o)) {
          case "Object":
            id = _.util.objId(o);
            if (visited[id]) {
              return visited[id];
            }
            clone = /** @type {Record<string, any>} */ ({});
            visited[id] = clone;

            for (var key in o) {
              if (o.hasOwnProperty(key)) {
                clone[key] = deepClone(o[key], visited);
              }
            }

            return /** @type {any} */ (clone);

          case "Array":
            id = _.util.objId(o);
            if (visited[id]) {
              return visited[id];
            }
            clone = [];
            visited[id] = clone;

            /** @type {Array} */ (/** @type {any} */ (o)).forEach(
              function (v, i) {
                clone[i] = deepClone(v, visited);
              },
            );

            return /** @type {any} */ (clone);

          default:
            return o;
        }
      },

      /**
       * Returns the Prism language of the given element set by a `language-xxxx` or `lang-xxxx` class.
       *
       * If no language is set for the element or the element is `null` or `undefined`, `none` will be returned.
       *
       * @param {Element} element
       * @returns {string}
       */
      getLanguage: function (element) {
        while (element) {
          var m = lang.exec(element.className);
          if (m) {
            return m[1].toLowerCase();
          }
          element = element.parentElement;
        }
        return "none";
      },

      /**
       * Sets the Prism `language-xxxx` class of the given element.
       *
       * @param {Element} element
       * @param {string} language
       * @returns {void}
       */
      setLanguage: function (element, language) {
        // remove all `language-xxxx` classes
        // (this might leave behind a leading space)
        element.className = element.className.replace(RegExp(lang, "gi"), "");

        // add the new `language-xxxx` class
        // (using `classList` will automatically clean up spaces for us)
        element.classList.add("language-" + language);
      },

      /**
       * Returns the script element that is currently executing.
       *
       * This does __not__ work for line script element.
       *
       * @returns {HTMLScriptElement | null}
       */
      currentScript: function () {
        if (typeof document === "undefined") {
          return null;
        }
        if (
          "currentScript" in document &&
          1 < 2 /* hack to trip TS' flow analysis */
        ) {
          return /** @type {any} */ (document.currentScript);
        }

        // IE11 workaround
        // we'll get the src of the current script by parsing IE11's error stack trace
        // this will not work for inline scripts

        try {
          throw new Error();
        } catch (err) {
          // Get file src url from stack. Specifically works with the format of stack traces in IE.
          // A stack will look like this:
          //
          // Error
          //    at _.util.currentScript (http://localhost/components/prism-core.js:119:5)
          //    at Global code (http://localhost/components/prism-core.js:606:1)

          var src = (/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(err.stack) ||
            [])[1];
          if (src) {
            var scripts = document.getElementsByTagName("script");
            for (var i in scripts) {
              if (scripts[i].src == src) {
                return scripts[i];
              }
            }
          }
          return null;
        }
      },

      /**
       * Returns whether a given class is active for `element`.
       *
       * The class can be activated if `element` or one of its ancestors has the given class and it can be deactivated
       * if `element` or one of its ancestors has the negated version of the given class. The _negated version_ of the
       * given class is just the given class with a `no-` prefix.
       *
       * Whether the class is active is determined by the closest ancestor of `element` (where `element` itself is
       * closest ancestor) that has the given class or the negated version of it. If neither `element` nor any of its
       * ancestors have the given class or the negated version of it, then the default activation will be returned.
       *
       * In the paradoxical situation where the closest ancestor contains __both__ the given class and the negated
       * version of it, the class is considered active.
       *
       * @param {Element} element
       * @param {string} className
       * @param {boolean} [defaultActivation=false]
       * @returns {boolean}
       */
      isActive: function (element, className, defaultActivation) {
        var no = "no-" + className;

        while (element) {
          var classList = element.classList;
          if (classList.contains(className)) {
            return true;
          }
          if (classList.contains(no)) {
            return false;
          }
          element = element.parentElement;
        }
        return !!defaultActivation;
      },
    },

    /**
     * This namespace contains all currently loaded languages and the some helper functions to create and modify languages.
     *
     * @namespace
     * @memberof Prism
     * @public
     */
    languages: {
      /**
       * The grammar for plain, unformatted text.
       */
      plain: plainTextGrammar,
      plaintext: plainTextGrammar,
      text: plainTextGrammar,
      txt: plainTextGrammar,

      /**
       * Creates a deep copy of the language with the given id and appends the given tokens.
       *
       * If a token in `redef` also appears in the copied language, then the existing token in the copied language
       * will be overwritten at its original position.
       *
       * ## Best practices
       *
       * Since the position of overwriting tokens (token in `redef` that overwrite tokens in the copied language)
       * doesn't matter, they can technically be in any order. However, this can be confusing to others that trying to
       * understand the language definition because, normally, the order of tokens matters in Prism grammars.
       *
       * Therefore, it is encouraged to order overwriting tokens according to the positions of the overwritten tokens.
       * Furthermore, all non-overwriting tokens should be placed after the overwriting ones.
       *
       * @param {string} id The id of the language to extend. This has to be a key in `Prism.languages`.
       * @param {Grammar} redef The new tokens to append.
       * @returns {Grammar} The new language created.
       * @public
       * @example
       * Prism.languages['css-with-colors'] = Prism.languages.extend('css', {
       *     // Prism.languages.css already has a 'comment' token, so this token will overwrite CSS' 'comment' token
       *     // at its original position
       *     'comment': { ... },
       *     // CSS doesn't have a 'color' token, so this token will be appended
       *     'color': /\b(?:red|green|blue)\b/
       * });
       */
      extend: function (id, redef) {
        var lang = _.util.clone(_.languages[id]);

        for (var key in redef) {
          lang[key] = redef[key];
        }

        return lang;
      },

      /**
       * Inserts tokens _before_ another token in a language definition or any other grammar.
       *
       * ## Usage
       *
       * This helper method makes it easy to modify existing languages. For example, the CSS language definition
       * not only defines CSS highlighting for CSS documents, but also needs to define highlighting for CSS embedded
       * in HTML through `<style>` elements. To do this, it needs to modify `Prism.languages.markup` and add the
       * appropriate tokens. However, `Prism.languages.markup` is a regular JavaScript object literal, so if you do
       * this:
       *
       * ```js
       * Prism.languages.markup.style = {
       *     // token
       * };
       * ```
       *
       * then the `style` token will be added (and processed) at the end. `insertBefore` allows you to insert tokens
       * before existing tokens. For the CSS example above, you would use it like this:
       *
       * ```js
       * Prism.languages.insertBefore('markup', 'cdata', {
       *     'style': {
       *         // token
       *     }
       * });
       * ```
       *
       * ## Special cases
       *
       * If the grammars of `inside` and `insert` have tokens with the same name, the tokens in `inside`'s grammar
       * will be ignored.
       *
       * This behavior can be used to insert tokens after `before`:
       *
       * ```js
       * Prism.languages.insertBefore('markup', 'comment', {
       *     'comment': Prism.languages.markup.comment,
       *     // tokens after 'comment'
       * });
       * ```
       *
       * ## Limitations
       *
       * The main problem `insertBefore` has to solve is iteration order. Since ES2015, the iteration order for object
       * properties is guaranteed to be the insertion order (except for integer keys) but some browsers behave
       * differently when keys are deleted and re-inserted. So `insertBefore` can't be implemented by temporarily
       * deleting properties which is necessary to insert at arbitrary positions.
       *
       * To solve this problem, `insertBefore` doesn't actually insert the given tokens into the target object.
       * Instead, it will create a new object and replace all references to the target object with the new one. This
       * can be done without temporarily deleting properties, so the iteration order is well-defined.
       *
       * However, only references that can be reached from `Prism.languages` or `insert` will be replaced. I.e. if
       * you hold the target object in a variable, then the value of the variable will not change.
       *
       * ```js
       * var oldMarkup = Prism.languages.markup;
       * var newMarkup = Prism.languages.insertBefore('markup', 'comment', { ... });
       *
       * assert(oldMarkup !== Prism.languages.markup);
       * assert(newMarkup === Prism.languages.markup);
       * ```
       *
       * @param {string} inside The property of `root` (e.g. a language id in `Prism.languages`) that contains the
       * object to be modified.
       * @param {string} before The key to insert before.
       * @param {Grammar} insert An object containing the key-value pairs to be inserted.
       * @param {Object<string, any>} [root] The object containing `inside`, i.e. the object that contains the
       * object to be modified.
       *
       * Defaults to `Prism.languages`.
       * @returns {Grammar} The new grammar object.
       * @public
       */
      insertBefore: function (inside, before, insert, root) {
        root = root || /** @type {any} */ (_.languages);
        var grammar = root[inside];
        /** @type {Grammar} */
        var ret = {};

        for (var token in grammar) {
          if (grammar.hasOwnProperty(token)) {
            if (token == before) {
              for (var newToken in insert) {
                if (insert.hasOwnProperty(newToken)) {
                  ret[newToken] = insert[newToken];
                }
              }
            }

            // Do not insert token which also occur in insert. See #1525
            if (!insert.hasOwnProperty(token)) {
              ret[token] = grammar[token];
            }
          }
        }

        var old = root[inside];
        root[inside] = ret;

        // Update references in other language definitions
        _.languages.DFS(_.languages, function (key, value) {
          if (value === old && key != inside) {
            this[key] = ret;
          }
        });

        return ret;
      },

      // Traverse a language definition with Depth First Search
      DFS: function DFS(o, callback, type, visited) {
        visited = visited || {};

        var objId = _.util.objId;

        for (var i in o) {
          if (o.hasOwnProperty(i)) {
            callback.call(o, i, o[i], type || i);

            var property = o[i];
            var propertyType = _.util.type(property);

            if (propertyType === "Object" && !visited[objId(property)]) {
              visited[objId(property)] = true;
              DFS(property, callback, null, visited);
            } else if (propertyType === "Array" && !visited[objId(property)]) {
              visited[objId(property)] = true;
              DFS(property, callback, i, visited);
            }
          }
        }
      },
    },

    plugins: {},

    /**
     * This is the most high-level function in Prism’s API.
     * It fetches all the elements that have a `.language-xxxx` class and then calls {@link Prism.highlightElement} on
     * each one of them.
     *
     * This is equivalent to `Prism.highlightAllUnder(document, async, callback)`.
     *
     * @param {boolean} [async=false] Same as in {@link Prism.highlightAllUnder}.
     * @param {HighlightCallback} [callback] Same as in {@link Prism.highlightAllUnder}.
     * @memberof Prism
     * @public
     */
    highlightAll: function (async, callback) {
      _.highlightAllUnder(document, async, callback);
    },

    /**
     * Fetches all the descendants of `container` that have a `.language-xxxx` class and then calls
     * {@link Prism.highlightElement} on each one of them.
     *
     * The following hooks will be run:
     * 1. `before-highlightall`
     * 2. `before-all-elements-highlight`
     * 3. All hooks of {@link Prism.highlightElement} for each element.
     *
     * @param {ParentNode} container The root element, whose descendants that have a `.language-xxxx` class will be highlighted.
     * @param {boolean} [async=false] Whether each element is to be highlighted asynchronously using Web Workers.
     * @param {HighlightCallback} [callback] An optional callback to be invoked on each element after its highlighting is done.
     * @memberof Prism
     * @public
     */
    highlightAllUnder: function (container, async, callback) {
      var env = {
        callback: callback,
        container: container,
        selector:
          'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code',
      };

      _.hooks.run("before-highlightall", env);

      env.elements = Array.prototype.slice.apply(
        env.container.querySelectorAll(env.selector),
      );

      _.hooks.run("before-all-elements-highlight", env);

      for (var i = 0, element; (element = env.elements[i++]); ) {
        _.highlightElement(element, async === true, env.callback);
      }
    },

    /**
     * Highlights the code inside a single element.
     *
     * The following hooks will be run:
     * 1. `before-sanity-check`
     * 2. `before-highlight`
     * 3. All hooks of {@link Prism.highlight}. These hooks will be run by an asynchronous worker if `async` is `true`.
     * 4. `before-insert`
     * 5. `after-highlight`
     * 6. `complete`
     *
     * Some the above hooks will be skipped if the element doesn't contain any text or there is no grammar loaded for
     * the element's language.
     *
     * @param {Element} element The element containing the code.
     * It must have a class of `language-xxxx` to be processed, where `xxxx` is a valid language identifier.
     * @param {boolean} [async=false] Whether the element is to be highlighted asynchronously using Web Workers
     * to improve performance and avoid blocking the UI when highlighting very large chunks of code. This option is
     * [disabled by default](https://prismjs.com/faq.html#why-is-asynchronous-highlighting-disabled-by-default).
     *
     * Note: All language definitions required to highlight the code must be included in the main `prism.js` file for
     * asynchronous highlighting to work. You can build your own bundle on the
     * [Download page](https://prismjs.com/download.html).
     * @param {HighlightCallback} [callback] An optional callback to be invoked after the highlighting is done.
     * Mostly useful when `async` is `true`, since in that case, the highlighting is done asynchronously.
     * @memberof Prism
     * @public
     */
    highlightElement: function (element, async, callback) {
      // Find language
      var language = _.util.getLanguage(element);
      var grammar = _.languages[language];

      // Set language on the element, if not present
      _.util.setLanguage(element, language);

      // Set language on the parent, for styling
      var parent = element.parentElement;
      if (parent && parent.nodeName.toLowerCase() === "pre") {
        _.util.setLanguage(parent, language);
      }

      var code = element.textContent;

      var env = {
        element: element,
        language: language,
        grammar: grammar,
        code: code,
      };

      function insertHighlightedCode(highlightedCode) {
        env.highlightedCode = highlightedCode;

        _.hooks.run("before-insert", env);

        env.element.innerHTML = env.highlightedCode;

        _.hooks.run("after-highlight", env);
        _.hooks.run("complete", env);
        callback && callback.call(env.element);
      }

      _.hooks.run("before-sanity-check", env);

      // plugins may change/add the parent/element
      parent = env.element.parentElement;
      if (
        parent &&
        parent.nodeName.toLowerCase() === "pre" &&
        !parent.hasAttribute("tabindex")
      ) {
        parent.setAttribute("tabindex", "0");
      }

      if (!env.code) {
        _.hooks.run("complete", env);
        callback && callback.call(env.element);
        return;
      }

      _.hooks.run("before-highlight", env);

      if (!env.grammar) {
        insertHighlightedCode(_.util.encode(env.code));
        return;
      }

      if (async && _self.Worker) {
        var worker = new Worker(_.filename);

        worker.onmessage = function (evt) {
          insertHighlightedCode(evt.data);
        };

        worker.postMessage(
          JSON.stringify({
            language: env.language,
            code: env.code,
            immediateClose: true,
          }),
        );
      } else {
        insertHighlightedCode(_.highlight(env.code, env.grammar, env.language));
      }
    },

    /**
     * Low-level function, only use if you know what you’re doing. It accepts a string of text as input
     * and the language definitions to use, and returns a string with the HTML produced.
     *
     * The following hooks will be run:
     * 1. `before-tokenize`
     * 2. `after-tokenize`
     * 3. `wrap`: On each {@link Token}.
     *
     * @param {string} text A string with the code to be highlighted.
     * @param {Grammar} grammar An object containing the tokens to use.
     *
     * Usually a language definition like `Prism.languages.markup`.
     * @param {string} language The name of the language definition passed to `grammar`.
     * @returns {string} The highlighted HTML.
     * @memberof Prism
     * @public
     * @example
     * Prism.highlight('var foo = true;', Prism.languages.javascript, 'javascript');
     */
    highlight: function (text, grammar, language) {
      var env = {
        code: text,
        grammar: grammar,
        language: language,
      };
      _.hooks.run("before-tokenize", env);
      env.tokens = _.tokenize(env.code, env.grammar);
      _.hooks.run("after-tokenize", env);
      return Token.stringify(_.util.encode(env.tokens), env.language);
    },

    /**
     * This is the heart of Prism, and the most low-level function you can use. It accepts a string of text as input
     * and the language definitions to use, and returns an array with the tokenized code.
     *
     * When the language definition includes nested tokens, the function is called recursively on each of these tokens.
     *
     * This method could be useful in other contexts as well, as a very crude parser.
     *
     * @param {string} text A string with the code to be highlighted.
     * @param {Grammar} grammar An object containing the tokens to use.
     *
     * Usually a language definition like `Prism.languages.markup`.
     * @returns {TokenStream} An array of strings and tokens, a token stream.
     * @memberof Prism
     * @public
     * @example
     * let code = `var foo = 0;`;
     * let tokens = Prism.tokenize(code, Prism.languages.javascript);
     * tokens.forEach(token => {
     *     if (token instanceof Prism.Token && token.type === 'number') {
     *         console.log(`Found numeric literal: ${token.content}`);
     *     }
     * });
     */
    tokenize: function (text, grammar) {
      var rest = grammar.rest;
      if (rest) {
        for (var token in rest) {
          grammar[token] = rest[token];
        }

        delete grammar.rest;
      }

      var tokenList = new LinkedList();
      addAfter(tokenList, tokenList.head, text);

      matchGrammar(text, tokenList, grammar, tokenList.head, 0);

      return toArray(tokenList);
    },

    /**
     * @namespace
     * @memberof Prism
     * @public
     */
    hooks: {
      all: {},

      /**
       * Adds the given callback to the list of callbacks for the given hook.
       *
       * The callback will be invoked when the hook it is registered for is run.
       * Hooks are usually directly run by a highlight function but you can also run hooks yourself.
       *
       * One callback function can be registered to multiple hooks and the same hook multiple times.
       *
       * @param {string} name The name of the hook.
       * @param {HookCallback} callback The callback function which is given environment variables.
       * @public
       */
      add: function (name, callback) {
        var hooks = _.hooks.all;

        hooks[name] = hooks[name] || [];

        hooks[name].push(callback);
      },

      /**
       * Runs a hook invoking all registered callbacks with the given environment variables.
       *
       * Callbacks will be invoked synchronously and in the order in which they were registered.
       *
       * @param {string} name The name of the hook.
       * @param {Object<string, any>} env The environment variables of the hook passed to all callbacks registered.
       * @public
       */
      run: function (name, env) {
        var callbacks = _.hooks.all[name];

        if (!callbacks || !callbacks.length) {
          return;
        }

        for (var i = 0, callback; (callback = callbacks[i++]); ) {
          callback(env);
        }
      },
    },

    Token: Token,
  };
  _self.Prism = _;

  // Typescript note:
  // The following can be used to import the Token type in JSDoc:
  //
  //   @typedef {InstanceType<import("./prism-core")["Token"]>} Token

  /**
   * Creates a new token.
   *
   * @param {string} type See {@link Token#type type}
   * @param {string | TokenStream} content See {@link Token#content content}
   * @param {string|string[]} [alias] The alias(es) of the token.
   * @param {string} [matchedStr=""] A copy of the full string this token was created from.
   * @class
   * @global
   * @public
   */
  function Token(type, content, alias, matchedStr) {
    /**
     * The type of the token.
     *
     * This is usually the key of a pattern in a {@link Grammar}.
     *
     * @type {string}
     * @see GrammarToken
     * @public
     */
    this.type = type;
    /**
     * The strings or tokens contained by this token.
     *
     * This will be a token stream if the pattern matched also defined an `inside` grammar.
     *
     * @type {string | TokenStream}
     * @public
     */
    this.content = content;
    /**
     * The alias(es) of the token.
     *
     * @type {string|string[]}
     * @see GrammarToken
     * @public
     */
    this.alias = alias;
    // Copy of the full string this token was created from
    this.length = (matchedStr || "").length | 0;
  }

  /**
   * A token stream is an array of strings and {@link Token Token} objects.
   *
   * Token streams have to fulfill a few properties that are assumed by most functions (mostly internal ones) that process
   * them.
   *
   * 1. No adjacent strings.
   * 2. No empty strings.
   *
   *    The only exception here is the token stream that only contains the empty string and nothing else.
   *
   * @typedef {Array<string | Token>} TokenStream
   * @global
   * @public
   */

  /**
   * Converts the given token or token stream to an HTML representation.
   *
   * The following hooks will be run:
   * 1. `wrap`: On each {@link Token}.
   *
   * @param {string | Token | TokenStream} o The token or token stream to be converted.
   * @param {string} language The name of current language.
   * @returns {string} The HTML representation of the token or token stream.
   * @memberof Token
   * @static
   */
  Token.stringify = function stringify(o, language) {
    if (typeof o == "string") {
      return o;
    }
    if (Array.isArray(o)) {
      var s = "";
      o.forEach(function (e) {
        s += stringify(e, language);
      });
      return s;
    }

    var env = {
      type: o.type,
      content: stringify(o.content, language),
      tag: "span",
      classes: ["token", o.type],
      attributes: {},
      language: language,
    };

    var aliases = o.alias;
    if (aliases) {
      if (Array.isArray(aliases)) {
        Array.prototype.push.apply(env.classes, aliases);
      } else {
        env.classes.push(aliases);
      }
    }

    _.hooks.run("wrap", env);

    var attributes = "";
    for (var name in env.attributes) {
      attributes +=
        " " +
        name +
        '="' +
        (env.attributes[name] || "").replace(/"/g, "&quot;") +
        '"';
    }

    return (
      "<" +
      env.tag +
      ' class="' +
      env.classes.join(" ") +
      '"' +
      attributes +
      ">" +
      env.content +
      "</" +
      env.tag +
      ">"
    );
  };

  /**
   * @param {RegExp} pattern
   * @param {number} pos
   * @param {string} text
   * @param {boolean} lookbehind
   * @returns {RegExpExecArray | null}
   */
  function matchPattern(pattern, pos, text, lookbehind) {
    pattern.lastIndex = pos;
    var match = pattern.exec(text);
    if (match && lookbehind && match[1]) {
      // change the match to remove the text matched by the Prism lookbehind group
      var lookbehindLength = match[1].length;
      match.index += lookbehindLength;
      match[0] = match[0].slice(lookbehindLength);
    }
    return match;
  }

  /**
   * @param {string} text
   * @param {LinkedList<string | Token>} tokenList
   * @param {any} grammar
   * @param {LinkedListNode<string | Token>} startNode
   * @param {number} startPos
   * @param {RematchOptions} [rematch]
   * @returns {void}
   * @private
   *
   * @typedef RematchOptions
   * @property {string} cause
   * @property {number} reach
   */
  function matchGrammar(
    text,
    tokenList,
    grammar,
    startNode,
    startPos,
    rematch,
  ) {
    for (var token in grammar) {
      if (!grammar.hasOwnProperty(token) || !grammar[token]) {
        continue;
      }

      var patterns = grammar[token];
      patterns = Array.isArray(patterns) ? patterns : [patterns];

      for (var j = 0; j < patterns.length; ++j) {
        if (rematch && rematch.cause == token + "," + j) {
          return;
        }

        var patternObj = patterns[j];
        var inside = patternObj.inside;
        var lookbehind = !!patternObj.lookbehind;
        var greedy = !!patternObj.greedy;
        var alias = patternObj.alias;

        if (greedy && !patternObj.pattern.global) {
          // Without the global flag, lastIndex won't work
          var flags = patternObj.pattern.toString().match(/[imsuy]*$/)[0];
          patternObj.pattern = RegExp(patternObj.pattern.source, flags + "g");
        }

        /** @type {RegExp} */
        var pattern = patternObj.pattern || patternObj;

        for (
          // iterate the token list and keep track of the current token/string position
          var currentNode = startNode.next, pos = startPos;
          currentNode !== tokenList.tail;
          pos += currentNode.value.length, currentNode = currentNode.next
        ) {
          if (rematch && pos >= rematch.reach) {
            break;
          }

          var str = currentNode.value;

          if (tokenList.length > text.length) {
            // Something went terribly wrong, ABORT, ABORT!
            return;
          }

          if (str instanceof Token) {
            continue;
          }

          var removeCount = 1; // this is the to parameter of removeBetween
          var match;

          if (greedy) {
            match = matchPattern(pattern, pos, text, lookbehind);
            if (!match || match.index >= text.length) {
              break;
            }

            var from = match.index;
            var to = match.index + match[0].length;
            var p = pos;

            // find the node that contains the match
            p += currentNode.value.length;
            while (from >= p) {
              currentNode = currentNode.next;
              p += currentNode.value.length;
            }
            // adjust pos (and p)
            p -= currentNode.value.length;
            pos = p;

            // the current node is a Token, then the match starts inside another Token, which is invalid
            if (currentNode.value instanceof Token) {
              continue;
            }

            // find the last node which is affected by this match
            for (
              var k = currentNode;
              k !== tokenList.tail && (p < to || typeof k.value === "string");
              k = k.next
            ) {
              removeCount++;
              p += k.value.length;
            }
            removeCount--;

            // replace with the new match
            str = text.slice(pos, p);
            match.index -= pos;
          } else {
            match = matchPattern(pattern, 0, str, lookbehind);
            if (!match) {
              continue;
            }
          }

          // eslint-disable-next-line no-redeclare
          var from = match.index;
          var matchStr = match[0];
          var before = str.slice(0, from);
          var after = str.slice(from + matchStr.length);

          var reach = pos + str.length;
          if (rematch && reach > rematch.reach) {
            rematch.reach = reach;
          }

          var removeFrom = currentNode.prev;

          if (before) {
            removeFrom = addAfter(tokenList, removeFrom, before);
            pos += before.length;
          }

          removeRange(tokenList, removeFrom, removeCount);

          var wrapped = new Token(
            token,
            inside ? _.tokenize(matchStr, inside) : matchStr,
            alias,
            matchStr,
          );
          currentNode = addAfter(tokenList, removeFrom, wrapped);

          if (after) {
            addAfter(tokenList, currentNode, after);
          }

          if (removeCount > 1) {
            // at least one Token object was removed, so we have to do some rematching
            // this can only happen if the current pattern is greedy

            /** @type {RematchOptions} */
            var nestedRematch = {
              cause: token + "," + j,
              reach: reach,
            };
            matchGrammar(
              text,
              tokenList,
              grammar,
              currentNode.prev,
              pos,
              nestedRematch,
            );

            // the reach might have been extended because of the rematching
            if (rematch && nestedRematch.reach > rematch.reach) {
              rematch.reach = nestedRematch.reach;
            }
          }
        }
      }
    }
  }

  /**
   * @typedef LinkedListNode
   * @property {T} value
   * @property {LinkedListNode<T> | null} prev The previous node.
   * @property {LinkedListNode<T> | null} next The next node.
   * @template T
   * @private
   */

  /**
   * @template T
   * @private
   */
  function LinkedList() {
    /** @type {LinkedListNode<T>} */
    var head = { value: null, prev: null, next: null };
    /** @type {LinkedListNode<T>} */
    var tail = { value: null, prev: head, next: null };
    head.next = tail;

    /** @type {LinkedListNode<T>} */
    this.head = head;
    /** @type {LinkedListNode<T>} */
    this.tail = tail;
    this.length = 0;
  }

  /**
   * Adds a new node with the given value to the list.
   *
   * @param {LinkedList<T>} list
   * @param {LinkedListNode<T>} node
   * @param {T} value
   * @returns {LinkedListNode<T>} The added node.
   * @template T
   */
  function addAfter(list, node, value) {
    // assumes that node != list.tail && values.length >= 0
    var next = node.next;

    var newNode = { value: value, prev: node, next: next };
    node.next = newNode;
    next.prev = newNode;
    list.length++;

    return newNode;
  }
  /**
   * Removes `count` nodes after the given node. The given node will not be removed.
   *
   * @param {LinkedList<T>} list
   * @param {LinkedListNode<T>} node
   * @param {number} count
   * @template T
   */
  function removeRange(list, node, count) {
    var next = node.next;
    for (var i = 0; i < count && next !== list.tail; i++) {
      next = next.next;
    }
    node.next = next;
    next.prev = node;
    list.length -= i;
  }
  /**
   * @param {LinkedList<T>} list
   * @returns {T[]}
   * @template T
   */
  function toArray(list) {
    var array = [];
    var node = list.head.next;
    while (node !== list.tail) {
      array.push(node.value);
      node = node.next;
    }
    return array;
  }

  if (!_self.document) {
    if (!_self.addEventListener) {
      // in Node.js
      return _;
    }

    if (!_.disableWorkerMessageHandler) {
      // In worker
      _self.addEventListener(
        "message",
        function (evt) {
          var message = JSON.parse(evt.data);
          var lang = message.language;
          var code = message.code;
          var immediateClose = message.immediateClose;

          _self.postMessage(_.highlight(code, _.languages[lang], lang));
          if (immediateClose) {
            _self.close();
          }
        },
        false,
      );
    }

    return _;
  }

  // Get current script and highlight
  var script = _.util.currentScript();

  if (script) {
    _.filename = script.src;

    if (script.hasAttribute("data-manual")) {
      _.manual = true;
    }
  }

  function highlightAutomaticallyCallback() {
    if (!_.manual) {
      _.highlightAll();
    }
  }

  if (!_.manual) {
    // If the document state is "loading", then we'll use DOMContentLoaded.
    // If the document state is "interactive" and the prism.js script is deferred, then we'll also use the
    // DOMContentLoaded event because there might be some plugins or languages which have also been deferred and they
    // might take longer one animation frame to execute which can create a race condition where only some plugins have
    // been loaded when Prism.highlightAll() is executed, depending on how fast resources are loaded.
    // See https://github.com/PrismJS/prism/issues/2102
    var readyState = document.readyState;
    if (
      readyState === "loading" ||
      (readyState === "interactive" && script && script.defer)
    ) {
      document.addEventListener(
        "DOMContentLoaded",
        highlightAutomaticallyCallback,
      );
    } else {
      if (window.requestAnimationFrame) {
        window.requestAnimationFrame(highlightAutomaticallyCallback);
      } else {
        window.setTimeout(highlightAutomaticallyCallback, 16);
      }
    }
  }

  return _;
})(_self);

if (typeof module !== "undefined" && module.exports) {
  module.exports = Prism;
}

// hack for components to work correctly in node.js
if (typeof global !== "undefined") {
  global.Prism = Prism;
}

// some additional documentation/types

/**
 * The expansion of a simple `RegExp` literal to support additional properties.
 *
 * @typedef GrammarToken
 * @property {RegExp} pattern The regular expression of the token.
 * @property {boolean} [lookbehind=false] If `true`, then the first capturing group of `pattern` will (effectively)
 * behave as a lookbehind group meaning that the captured text will not be part of the matched text of the new token.
 * @property {boolean} [greedy=false] Whether the token is greedy.
 * @property {string|string[]} [alias] An optional alias or list of aliases.
 * @property {Grammar} [inside] The nested grammar of this token.
 *
 * The `inside` grammar will be used to tokenize the text value of each token of this kind.
 *
 * This can be used to make nested and even recursive language definitions.
 *
 * Note: This can cause infinite recursion. Be careful when you embed different languages or even the same language into
 * each another.
 * @global
 * @public
 */

/**
 * @typedef Grammar
 * @type {Object<string, RegExp | GrammarToken | Array<RegExp | GrammarToken>>}
 * @property {Grammar} [rest] An optional grammar object that will be appended to this grammar.
 * @global
 * @public
 */

/**
 * A function which will invoked after an element was successfully highlighted.
 *
 * @callback HighlightCallback
 * @param {Element} element The element successfully highlighted.
 * @returns {void}
 * @global
 * @public
 */

/**
 * @callback HookCallback
 * @param {Object<string, any>} env The environment variables of the hook.
 * @returns {void}
 * @global
 * @public
 */
Prism.languages.markup = {
  comment: {
    pattern: /<!--(?:(?!<!--)[\s\S])*?-->/,
    greedy: true,
  },
  prolog: {
    pattern: /<\?[\s\S]+?\?>/,
    greedy: true,
  },
  doctype: {
    // https://www.w3.org/TR/xml/#NT-doctypedecl
    pattern:
      /<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,
    greedy: true,
    inside: {
      "internal-subset": {
        pattern: /(^[^\[]*\[)[\s\S]+(?=\]>$)/,
        lookbehind: true,
        greedy: true,
        inside: null, // see below
      },
      string: {
        pattern: /"[^"]*"|'[^']*'/,
        greedy: true,
      },
      punctuation: /^<!|>$|[[\]]/,
      "doctype-tag": /^DOCTYPE/i,
      name: /[^\s<>'"]+/,
    },
  },
  cdata: {
    pattern: /<!\[CDATA\[[\s\S]*?\]\]>/i,
    greedy: true,
  },
  tag: {
    pattern:
      /<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,
    greedy: true,
    inside: {
      tag: {
        pattern: /^<\/?[^\s>\/]+/,
        inside: {
          punctuation: /^<\/?/,
          namespace: /^[^\s>\/:]+:/,
        },
      },
      "special-attr": [],
      "attr-value": {
        pattern: /=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,
        inside: {
          punctuation: [
            {
              pattern: /^=/,
              alias: "attr-equals",
            },
            /"|'/,
          ],
        },
      },
      punctuation: /\/?>/,
      "attr-name": {
        pattern: /[^\s>\/]+/,
        inside: {
          namespace: /^[^\s>\/:]+:/,
        },
      },
    },
  },
  entity: [
    {
      pattern: /&[\da-z]{1,8};/i,
      alias: "named-entity",
    },
    /&#x?[\da-f]{1,8};/i,
  ],
};

Prism.languages.markup["tag"].inside["attr-value"].inside["entity"] =
  Prism.languages.markup["entity"];
Prism.languages.markup["doctype"].inside["internal-subset"].inside =
  Prism.languages.markup;

// Plugin to make entity title show the real entity, idea by Roman Komarov
Prism.hooks.add("wrap", function (env) {
  if (env.type === "entity") {
    env.attributes["title"] = env.content.replace(/&amp;/, "&");
  }
});

Object.defineProperty(Prism.languages.markup.tag, "addInlined", {
  /**
   * Adds an inlined language to markup.
   *
   * An example of an inlined language is CSS with `<style>` tags.
   *
   * @param {string} tagName The name of the tag that contains the inlined language. This name will be treated as
   * case insensitive.
   * @param {string} lang The language key.
   * @example
   * addInlined('style', 'css');
   */
  value: function addInlined(tagName, lang) {
    var includedCdataInside = {};
    includedCdataInside["language-" + lang] = {
      pattern: /(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,
      lookbehind: true,
      inside: Prism.languages[lang],
    };
    includedCdataInside["cdata"] = /^<!\[CDATA\[|\]\]>$/i;

    var inside = {
      "included-cdata": {
        pattern: /<!\[CDATA\[[\s\S]*?\]\]>/i,
        inside: includedCdataInside,
      },
    };
    inside["language-" + lang] = {
      pattern: /[\s\S]+/,
      inside: Prism.languages[lang],
    };

    var def = {};
    def[tagName] = {
      pattern: RegExp(
        /(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(
          /__/g,
          function () {
            return tagName;
          },
        ),
        "i",
      ),
      lookbehind: true,
      greedy: true,
      inside: inside,
    };

    Prism.languages.insertBefore("markup", "cdata", def);
  },
});
Object.defineProperty(Prism.languages.markup.tag, "addAttribute", {
  /**
   * Adds an pattern to highlight languages embedded in HTML attributes.
   *
   * An example of an inlined language is CSS with `style` attributes.
   *
   * @param {string} attrName The name of the tag that contains the inlined language. This name will be treated as
   * case insensitive.
   * @param {string} lang The language key.
   * @example
   * addAttribute('style', 'css');
   */
  value: function (attrName, lang) {
    Prism.languages.markup.tag.inside["special-attr"].push({
      pattern: RegExp(
        /(^|["'\s])/.source +
          "(?:" +
          attrName +
          ")" +
          /\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,
        "i",
      ),
      lookbehind: true,
      inside: {
        "attr-name": /^[^\s=]+/,
        "attr-value": {
          pattern: /=[\s\S]+/,
          inside: {
            value: {
              pattern: /(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,
              lookbehind: true,
              alias: [lang, "language-" + lang],
              inside: Prism.languages[lang],
            },
            punctuation: [
              {
                pattern: /^=/,
                alias: "attr-equals",
              },
              /"|'/,
            ],
          },
        },
      },
    });
  },
});

Prism.languages.html = Prism.languages.markup;
Prism.languages.mathml = Prism.languages.markup;
Prism.languages.svg = Prism.languages.markup;

Prism.languages.xml = Prism.languages.extend("markup", {});
Prism.languages.ssml = Prism.languages.xml;
Prism.languages.atom = Prism.languages.xml;
Prism.languages.rss = Prism.languages.xml;

(function (Prism) {
  var string =
    /(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;

  Prism.languages.css = {
    comment: /\/\*[\s\S]*?\*\//,
    atrule: {
      pattern: /@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,
      inside: {
        rule: /^@[\w-]+/,
        "selector-function-argument": {
          pattern:
            /(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,
          lookbehind: true,
          alias: "selector",
        },
        keyword: {
          pattern: /(^|[^\w-])(?:and|not|only|or)(?![\w-])/,
          lookbehind: true,
        },
        // See rest below
      },
    },
    url: {
      // https://drafts.csswg.org/css-values-3/#urls
      pattern: RegExp(
        "\\burl\\((?:" +
          string.source +
          "|" +
          /(?:[^\\\r\n()"']|\\[\s\S])*/.source +
          ")\\)",
        "i",
      ),
      greedy: true,
      inside: {
        function: /^url/i,
        punctuation: /^\(|\)$/,
        string: {
          pattern: RegExp("^" + string.source + "$"),
          alias: "url",
        },
      },
    },
    selector: {
      pattern: RegExp(
        "(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|" +
          string.source +
          ")*(?=\\s*\\{)",
      ),
      lookbehind: true,
    },
    string: {
      pattern: string,
      greedy: true,
    },
    property: {
      pattern:
        /(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,
      lookbehind: true,
    },
    important: /!important\b/i,
    function: {
      pattern: /(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,
      lookbehind: true,
    },
    punctuation: /[(){};:,]/,
  };

  Prism.languages.css["atrule"].inside.rest = Prism.languages.css;

  var markup = Prism.languages.markup;
  if (markup) {
    markup.tag.addInlined("style", "css");
    markup.tag.addAttribute("style", "css");
  }
})(Prism);

Prism.languages.clike = {
  comment: [
    {
      pattern: /(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,
      lookbehind: true,
      greedy: true,
    },
    {
      pattern: /(^|[^\\:])\/\/.*/,
      lookbehind: true,
      greedy: true,
    },
  ],
  string: {
    pattern: /(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,
    greedy: true,
  },
  "class-name": {
    pattern:
      /(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,
    lookbehind: true,
    inside: {
      punctuation: /[.\\]/,
    },
  },
  keyword:
    /\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,
  boolean: /\b(?:false|true)\b/,
  function: /\b\w+(?=\()/,
  number: /\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,
  operator: /[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,
  punctuation: /[{}[\];(),.:]/,
};

Prism.languages.javascript = Prism.languages.extend("clike", {
  "class-name": [
    Prism.languages.clike["class-name"],
    {
      pattern:
        /(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,
      lookbehind: true,
    },
  ],
  keyword: [
    {
      pattern: /((?:^|\})\s*)catch\b/,
      lookbehind: true,
    },
    {
      pattern:
        /(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,
      lookbehind: true,
    },
  ],
  // Allow for all non-ASCII characters (See http://stackoverflow.com/a/2008444)
  function:
    /#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,
  number: {
    pattern: RegExp(
      /(^|[^\w$])/.source +
        "(?:" +
        // constant
        (/NaN|Infinity/.source +
          "|" +
          // binary integer
          /0[bB][01]+(?:_[01]+)*n?/.source +
          "|" +
          // octal integer
          /0[oO][0-7]+(?:_[0-7]+)*n?/.source +
          "|" +
          // hexadecimal integer
          /0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source +
          "|" +
          // decimal bigint
          /\d+(?:_\d+)*n/.source +
          "|" +
          // decimal number (integer or float) but no bigint
          /(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/
            .source) +
        ")" +
        /(?![\w$])/.source,
    ),
    lookbehind: true,
  },
  operator:
    /--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/,
});

Prism.languages.javascript["class-name"][0].pattern =
  /(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;

Prism.languages.insertBefore("javascript", "keyword", {
  regex: {
    // eslint-disable-next-line regexp/no-dupe-characters-character-class
    pattern:
      /((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)\/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/,
    lookbehind: true,
    greedy: true,
    inside: {
      "regex-source": {
        pattern: /^(\/)[\s\S]+(?=\/[a-z]*$)/,
        lookbehind: true,
        alias: "language-regex",
        inside: Prism.languages.regex,
      },
      "regex-delimiter": /^\/|\/$/,
      "regex-flags": /^[a-z]+$/,
    },
  },
  // This must be declared before keyword because we use "function" inside the look-forward
  "function-variable": {
    pattern:
      /#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,
    alias: "function",
  },
  parameter: [
    {
      pattern:
        /(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,
      lookbehind: true,
      inside: Prism.languages.javascript,
    },
    {
      pattern:
        /(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,
      lookbehind: true,
      inside: Prism.languages.javascript,
    },
    {
      pattern:
        /(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,
      lookbehind: true,
      inside: Prism.languages.javascript,
    },
    {
      pattern:
        /((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,
      lookbehind: true,
      inside: Prism.languages.javascript,
    },
  ],
  constant: /\b[A-Z](?:[A-Z_]|\dx?)*\b/,
});

Prism.languages.insertBefore("javascript", "string", {
  hashbang: {
    pattern: /^#!.*/,
    greedy: true,
    alias: "comment",
  },
  "template-string": {
    pattern:
      /`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,
    greedy: true,
    inside: {
      "template-punctuation": {
        pattern: /^`|`$/,
        alias: "string",
      },
      interpolation: {
        pattern:
          /((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,
        lookbehind: true,
        inside: {
          "interpolation-punctuation": {
            pattern: /^\$\{|\}$/,
            alias: "punctuation",
          },
          rest: Prism.languages.javascript,
        },
      },
      string: /[\s\S]+/,
    },
  },
  "string-property": {
    pattern:
      /((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,
    lookbehind: true,
    greedy: true,
    alias: "property",
  },
});

Prism.languages.insertBefore("javascript", "operator", {
  "literal-property": {
    pattern:
      /((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,
    lookbehind: true,
    alias: "property",
  },
});

if (Prism.languages.markup) {
  Prism.languages.markup.tag.addInlined("script", "javascript");

  // add attribute support for all DOM events.
  // https://developer.mozilla.org/en-US/docs/Web/Events#Standard_events
  Prism.languages.markup.tag.addAttribute(
    /on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/
      .source,
    "javascript",
  );
}

Prism.languages.js = Prism.languages.javascript;

Prism.languages.python = {
  comment: {
    pattern: /(^|[^\\])#.*/,
    lookbehind: true,
    greedy: true,
  },
  "string-interpolation": {
    pattern:
      /(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,
    greedy: true,
    inside: {
      interpolation: {
        // "{" <expression> <optional "!s", "!r", or "!a"> <optional ":" format specifier> "}"
        pattern:
          /((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,
        lookbehind: true,
        inside: {
          "format-spec": {
            pattern: /(:)[^:(){}]+(?=\}$)/,
            lookbehind: true,
          },
          "conversion-option": {
            pattern: /![sra](?=[:}]$)/,
            alias: "punctuation",
          },
          rest: null,
        },
      },
      string: /[\s\S]+/,
    },
  },
  "triple-quoted-string": {
    pattern: /(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,
    greedy: true,
    alias: "string",
  },
  string: {
    pattern: /(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,
    greedy: true,
  },
  function: {
    pattern: /((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,
    lookbehind: true,
  },
  "class-name": {
    pattern: /(\bclass\s+)\w+/i,
    lookbehind: true,
  },
  decorator: {
    pattern: /(^[\t ]*)@\w+(?:\.\w+)*/m,
    lookbehind: true,
    alias: ["annotation", "punctuation"],
    inside: {
      punctuation: /\./,
    },
  },
  keyword:
    /\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,
  builtin:
    /\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,
  boolean: /\b(?:False|None|True)\b/,
  number:
    /\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,
  operator: /[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,
  punctuation: /[{}[\];(),.:]/,
};

Prism.languages.python["string-interpolation"].inside[
  "interpolation"
].inside.rest = Prism.languages.python;

Prism.languages.py = Prism.languages.python;

(function () {
  if (typeof Prism === "undefined") {
    return;
  }

  var assign =
    Object.assign ||
    function (obj1, obj2) {
      for (var name in obj2) {
        if (obj2.hasOwnProperty(name)) {
          obj1[name] = obj2[name];
        }
      }
      return obj1;
    };

  function NormalizeWhitespace(defaults) {
    this.defaults = assign({}, defaults);
  }

  function toCamelCase(value) {
    return value.replace(/-(\w)/g, function (match, firstChar) {
      return firstChar.toUpperCase();
    });
  }

  function tabLen(str) {
    var res = 0;
    for (var i = 0; i < str.length; ++i) {
      if (str.charCodeAt(i) == "\t".charCodeAt(0)) {
        res += 3;
      }
    }
    return str.length + res;
  }

  NormalizeWhitespace.prototype = {
    setDefaults: function (defaults) {
      this.defaults = assign(this.defaults, defaults);
    },
    normalize: function (input, settings) {
      settings = assign(this.defaults, settings);

      for (var name in settings) {
        var methodName = toCamelCase(name);
        if (
          name !== "normalize" &&
          methodName !== "setDefaults" &&
          settings[name] &&
          this[methodName]
        ) {
          input = this[methodName].call(this, input, settings[name]);
        }
      }

      return input;
    },

    /*
     * Normalization methods
     */
    leftTrim: function (input) {
      return input.replace(/^\s+/, "");
    },
    rightTrim: function (input) {
      return input.replace(/\s+$/, "");
    },
    tabsToSpaces: function (input, spaces) {
      spaces = spaces | 0 || 4;
      return input.replace(/\t/g, new Array(++spaces).join(" "));
    },
    spacesToTabs: function (input, spaces) {
      spaces = spaces | 0 || 4;
      return input.replace(RegExp(" {" + spaces + "}", "g"), "\t");
    },
    removeTrailing: function (input) {
      return input.replace(/\s*?$/gm, "");
    },
    // Support for deprecated plugin remove-initial-line-feed
    removeInitialLineFeed: function (input) {
      return input.replace(/^(?:\r?\n|\r)/, "");
    },
    removeIndent: function (input) {
      var indents = input.match(/^[^\S\n\r]*(?=\S)/gm);

      if (!indents || !indents[0].length) {
        return input;
      }

      indents.sort(function (a, b) {
        return a.length - b.length;
      });

      if (!indents[0].length) {
        return input;
      }

      return input.replace(RegExp("^" + indents[0], "gm"), "");
    },
    indent: function (input, tabs) {
      return input.replace(
        /^[^\S\n\r]*(?=\S)/gm,
        new Array(++tabs).join("\t") + "$&",
      );
    },
    breakLines: function (input, characters) {
      characters = characters === true ? 80 : characters | 0 || 80;

      var lines = input.split("\n");
      for (var i = 0; i < lines.length; ++i) {
        if (tabLen(lines[i]) <= characters) {
          continue;
        }

        var line = lines[i].split(/(\s+)/g);
        var len = 0;

        for (var j = 0; j < line.length; ++j) {
          var tl = tabLen(line[j]);
          len += tl;
          if (len > characters) {
            line[j] = "\n" + line[j];
            len = tl;
          }
        }
        lines[i] = line.join("");
      }
      return lines.join("\n");
    },
  };

  // Support node modules
  if (typeof module !== "undefined" && module.exports) {
    module.exports = NormalizeWhitespace;
  }

  Prism.plugins.NormalizeWhitespace = new NormalizeWhitespace({
    "remove-trailing": true,
    "remove-indent": false,
    "left-trim": false,
    "right-trim": true,
    /*'break-lines': 80,
		'indent': 2,
		'remove-initial-line-feed': false,
		'tabs-to-spaces': 4,
		'spaces-to-tabs': 4*/
  });

  Prism.hooks.add("before-sanity-check", function (env) {
    var Normalizer = Prism.plugins.NormalizeWhitespace;

    // Check settings
    if (env.settings && env.settings["whitespace-normalization"] === false) {
      return;
    }

    // Check classes
    if (!Prism.util.isActive(env.element, "whitespace-normalization", true)) {
      return;
    }

    // Simple mode if there is no env.element
    if ((!env.element || !env.element.parentNode) && env.code) {
      env.code = Normalizer.normalize(env.code, env.settings);
      return;
    }

    // Normal mode
    var pre = env.element.parentNode;
    if (!env.code || !pre || pre.nodeName.toLowerCase() !== "pre") {
      return;
    }

    var children = pre.childNodes;
    var before = "";
    var after = "";
    var codeFound = false;

    // Move surrounding whitespace from the <pre> tag into the <code> tag
    for (var i = 0; i < children.length; ++i) {
      var node = children[i];

      if (node == env.element) {
        codeFound = true;
      } else if (node.nodeName === "#text") {
        if (codeFound) {
          after += node.nodeValue;
        } else {
          before += node.nodeValue;
        }

        pre.removeChild(node);
        --i;
      }
    }

    if (!env.element.children.length || !Prism.plugins.KeepMarkup) {
      env.code = before + env.code + after;
      env.code = Normalizer.normalize(env.code, env.settings);
    } else {
      // Preserve markup for keep-markup plugin
      var html = before + env.element.innerHTML + after;
      env.element.innerHTML = Normalizer.normalize(html, env.settings);
      env.code = env.element.textContent;
    }
  });
})();

</script>
    <script>
      (function () {
  function Tablesort(el, options) {
    if (!(this instanceof Tablesort)) return new Tablesort(el, options);

    if (!el || el.tagName !== "TABLE") {
      throw new Error("Element must be a table");
    }
    this.init(el, options || {});
  }

  var sortOptions = [];

  var createEvent = function (name) {
    var evt;

    if (!window.CustomEvent || typeof window.CustomEvent !== "function") {
      evt = document.createEvent("CustomEvent");
      evt.initCustomEvent(name, false, false, undefined);
    } else {
      evt = new CustomEvent(name);
    }

    return evt;
  };

  var getInnerText = function (el, options) {
    return (
      el.getAttribute(options.sortAttribute || "data-sort") ||
      el.textContent ||
      el.innerText ||
      ""
    );
  };

  // Default sort method if no better sort method is found
  var caseInsensitiveSort = function (a, b) {
    a = a.trim().toLowerCase();
    b = b.trim().toLowerCase();

    if (a === b) return 0;
    if (a < b) return 1;

    return -1;
  };

  var getCellByKey = function (cells, key) {
    return [].slice.call(cells).find(function (cell) {
      return cell.getAttribute("data-sort-column-key") === key;
    });
  };

  // Stable sort function
  // If two elements are equal under the original sort function,
  // then there relative order is reversed
  var stabilize = function (sort, antiStabilize) {
    return function (a, b) {
      var unstableResult = sort(a.td, b.td);

      if (unstableResult === 0) {
        if (antiStabilize) return b.index - a.index;
        return a.index - b.index;
      }

      return unstableResult;
    };
  };

  Tablesort.extend = function (name, pattern, sort) {
    if (typeof pattern !== "function" || typeof sort !== "function") {
      throw new Error("Pattern and sort must be a function");
    }

    sortOptions.push({
      name: name,
      pattern: pattern,
      sort: sort,
    });
  };

  Tablesort.prototype = {
    init: function (el, options) {
      var that = this,
        firstRow,
        defaultSort,
        i,
        cell;

      that.table = el;
      that.thead = false;
      that.options = options;

      if (el.rows && el.rows.length > 0) {
        if (el.tHead && el.tHead.rows.length > 0) {
          for (i = 0; i < el.tHead.rows.length; i++) {
            if (el.tHead.rows[i].getAttribute("data-sort-method") === "thead") {
              firstRow = el.tHead.rows[i];
              break;
            }
          }
          if (!firstRow) {
            firstRow = el.tHead.rows[el.tHead.rows.length - 1];
          }
          that.thead = true;
        } else {
          firstRow = el.rows[0];
        }
      }

      if (!firstRow) return;

      var onClick = function () {
        if (that.current && that.current !== this) {
          that.current.removeAttribute("aria-sort");
        }

        that.current = this;
        that.sortTable(this);
      };

      // Assume first row is the header and attach a click handler to each.
      for (i = 0; i < firstRow.cells.length; i++) {
        cell = firstRow.cells[i];
        cell.setAttribute("role", "columnheader");
        if (cell.getAttribute("data-sort-method") !== "none") {
          cell.tabindex = 0;
          cell.addEventListener("click", onClick, false);

          if (cell.getAttribute("data-sort-default") !== null) {
            defaultSort = cell;
          }
        }
      }

      if (defaultSort) {
        that.current = defaultSort;
        that.sortTable(defaultSort);
      }
    },

    sortTable: function (header, update) {
      var that = this,
        columnKey = header.getAttribute("data-sort-column-key"),
        column = header.cellIndex,
        sortFunction = caseInsensitiveSort,
        item = "",
        items = [],
        i = that.thead ? 0 : 1,
        sortMethod = header.getAttribute("data-sort-method"),
        sortOrder = header.getAttribute("aria-sort");

      that.table.dispatchEvent(createEvent("beforeSort"));

      // If updating an existing sort, direction should remain unchanged.
      if (!update) {
        if (sortOrder === "ascending") {
          sortOrder = "descending";
        } else if (sortOrder === "descending") {
          sortOrder = "ascending";
        } else {
          sortOrder = that.options.descending ? "descending" : "ascending";
        }

        header.setAttribute("aria-sort", sortOrder);
      }

      if (that.table.rows.length < 2) return;

      // If we force a sort method, it is not necessary to check rows
      if (!sortMethod) {
        var cell;
        while (items.length < 3 && i < that.table.tBodies[0].rows.length) {
          if (columnKey) {
            cell = getCellByKey(that.table.tBodies[0].rows[i].cells, columnKey);
          } else {
            cell = that.table.tBodies[0].rows[i].cells[column];
          }

          // Treat missing cells as empty cells
          item = cell ? getInnerText(cell, that.options) : "";

          item = item.trim();

          if (item.length > 0) {
            items.push(item);
          }

          i++;
        }

        if (!items) return;
      }

      for (i = 0; i < sortOptions.length; i++) {
        item = sortOptions[i];

        if (sortMethod) {
          if (item.name === sortMethod) {
            sortFunction = item.sort;
            break;
          }
        } else if (items.every(item.pattern)) {
          sortFunction = item.sort;
          break;
        }
      }

      that.col = column;

      for (i = 0; i < that.table.tBodies.length; i++) {
        var newRows = [],
          noSorts = {},
          j,
          totalRows = 0,
          noSortsSoFar = 0;

        if (that.table.tBodies[i].rows.length < 2) continue;

        for (j = 0; j < that.table.tBodies[i].rows.length; j++) {
          var cell;

          item = that.table.tBodies[i].rows[j];
          if (item.getAttribute("data-sort-method") === "none") {
            // keep no-sorts in separate list to be able to insert
            // them back at their original position later
            noSorts[totalRows] = item;
          } else {
            if (columnKey) {
              cell = getCellByKey(item.cells, columnKey);
            } else {
              cell = item.cells[that.col];
            }
            // Save the index for stable sorting
            newRows.push({
              tr: item,
              td: cell ? getInnerText(cell, that.options) : "",
              index: totalRows,
            });
          }
          totalRows++;
        }
        // Before we append should we reverse the new array or not?
        // If we reverse, the sort needs to be `anti-stable` so that
        // the double negatives cancel out
        if (sortOrder === "descending") {
          newRows.sort(stabilize(sortFunction, true));
        } else {
          newRows.sort(stabilize(sortFunction, false));
          newRows.reverse();
        }

        // append rows that already exist rather than creating new ones
        for (j = 0; j < totalRows; j++) {
          if (noSorts[j]) {
            // We have a no-sort row for this position, insert it here.
            item = noSorts[j];
            noSortsSoFar++;
          } else {
            item = newRows[j - noSortsSoFar].tr;
          }

          // appendChild(x) moves x if already present somewhere else in the DOM
          that.table.tBodies[i].appendChild(item);
        }
      }

      that.table.dispatchEvent(createEvent("afterSort"));
    },

    refresh: function () {
      if (this.current !== undefined) {
        this.sortTable(this.current, true);
      }
    },
  };

  if (typeof module !== "undefined" && module.exports) {
    module.exports = Tablesort;
  } else {
    window.Tablesort = Tablesort;
  }
})();

    </script>
    <script>
      (function () {
  var cleanNumber = function (i) {
      return i.replace(/[^\-?0-9.]/g, "");
    },
    compareNumber = function (a, b) {
      a = parseFloat(a);
      b = parseFloat(b);

      a = isNaN(a) ? 0 : a;
      b = isNaN(b) ? 0 : b;

      return a - b;
    };

  Tablesort.extend(
    "number",
    function (item) {
      return (
        item.match(/^[-+]?[£\x24Û¢´€]?\d+\s*([,\.]\d{0,2})/) || // Prefixed currency
        item.match(/^[-+]?\d+\s*([,\.]\d{0,2})?[£\x24Û¢´€]/) || // Suffixed currency
        item.match(/^[-+]?(\d)*-?([,\.]){0,1}-?(\d)+([E,e][\-+][\d]+)?%?$/)
      ); // Number
    },
    function (a, b) {
      a = cleanNumber(a);
      b = cleanNumber(b);

      return compareNumber(b, a);
    },
  );
})();

    </script>
    <script>
      const profile = {
    "alloc_samples": 25427,
    "args": [
        "benchmarking.py",
        "config/train_delphi_demo.py",
        "--out_dir=Delphi-2M"
    ],
    "elapsed_time_sec": 77.32296514511108,
    "entrypoint_dir": "/Users/elenaschramme/Documents/Bachelorarbeit/Delphi",
    "filename": "/Users/elenaschramme/Documents/Bachelorarbeit/Delphi",
    "files": {
        "/Users/elenaschramme/Documents/Bachelorarbeit/Delphi/benchmarking.py": {
            "functions": [],
            "imports": [
                "import os",
                "import time",
                "import torch",
                "from model import DelphiConfig, Delphi",
                "import numpy as np",
                "import matplotlib.pyplot as plt",
                "from utils import get_batch, get_p2i"
            ],
            "leaks": {},
            "lines": [
                {
                    "end_outermost_loop": 1,
                    "end_region_line": 1,
                    "line": "import os\n",
                    "lineno": 1,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 1,
                    "start_region_line": 1
                },
                {
                    "end_outermost_loop": 2,
                    "end_region_line": 2,
                    "line": "import time\n",
                    "lineno": 2,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 2,
                    "start_region_line": 2
                },
                {
                    "end_outermost_loop": 3,
                    "end_region_line": 3,
                    "line": "import torch\n",
                    "lineno": 3,
                    "memory_samples": [
                        [
                            644613269,
                            10.00011157989502
                        ],
                        [
                            644618998,
                            20.000218391418457
                        ],
                        [
                            644622784,
                            30.000279426574707
                        ],
                        [
                            644636722,
                            40.000319480895996
                        ],
                        [
                            1087769588,
                            50.28317451477051
                        ],
                        [
                            1851495581,
                            60.37748622894287
                        ],
                        [
                            2353785600,
                            70.51285743713379
                        ],
                        [
                            2923199787,
                            80.60710716247559
                        ],
                        [
                            3304605441,
                            90.70136165618896
                        ],
                        [
                            3834429053,
                            100.9261827468872
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 12.016032979092227,
                    "n_core_utilization": 0.08158536646460086,
                    "n_cpu_percent_c": 0.4319064753660704,
                    "n_cpu_percent_python": 0.36039359689016265,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 100.17223834991455,
                    "n_malloc_mb": 100.17223834991455,
                    "n_mallocs": 0,
                    "n_peak_mb": 100.17223834991455,
                    "n_python_fraction": 0.7330869365606258,
                    "n_sys_percent": 0.42161258541382335,
                    "n_usage_fraction": 0.0006259504373645196,
                    "start_outermost_loop": 3,
                    "start_region_line": 3
                },
                {
                    "end_outermost_loop": 4,
                    "end_region_line": 4,
                    "line": "import torch.nn.functional as F\n",
                    "lineno": 4,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 4,
                    "start_region_line": 4
                },
                {
                    "end_outermost_loop": 5,
                    "end_region_line": 5,
                    "line": "from model import DelphiConfig, Delphi\n",
                    "lineno": 5,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 5,
                    "start_region_line": 5
                },
                {
                    "end_outermost_loop": 6,
                    "end_region_line": 6,
                    "line": "from tqdm import tqdm\n",
                    "lineno": 6,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 6,
                    "start_region_line": 6
                },
                {
                    "end_outermost_loop": 7,
                    "end_region_line": 7,
                    "line": "import numpy as np\n",
                    "lineno": 7,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 7,
                    "start_region_line": 7
                },
                {
                    "end_outermost_loop": 8,
                    "end_region_line": 8,
                    "line": "import matplotlib.pyplot as plt\n",
                    "lineno": 8,
                    "memory_samples": [
                        [
                            4162623197,
                            111.09398174285889
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 2.1826800033949603,
                    "n_core_utilization": 0.08841661862018742,
                    "n_cpu_percent_c": 0.062077468276704226,
                    "n_cpu_percent_python": 0.0646803550252794,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.073555946350098,
                    "n_malloc_mb": 10.073555946350098,
                    "n_mallocs": 0,
                    "n_peak_mb": 10.073555946350098,
                    "n_python_fraction": 0.984938,
                    "n_sys_percent": 0.05244749081223721,
                    "n_usage_fraction": 6.294704854660142e-05,
                    "start_outermost_loop": 8,
                    "start_region_line": 8
                },
                {
                    "end_outermost_loop": 9,
                    "end_region_line": 9,
                    "line": "from utils import get_batch, get_p2i\n",
                    "lineno": 9,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 10,
                    "end_region_line": 10,
                    "line": "\n",
                    "lineno": 10,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 10,
                    "start_region_line": 10
                },
                {
                    "end_outermost_loop": 11,
                    "end_region_line": 11,
                    "line": "# Configuration\n",
                    "lineno": 11,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 11,
                    "start_region_line": 11
                },
                {
                    "end_outermost_loop": 12,
                    "end_region_line": 12,
                    "line": "out_dir = 'Delphi-2M'\n",
                    "lineno": 12,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 12,
                    "start_region_line": 12
                },
                {
                    "end_outermost_loop": 13,
                    "end_region_line": 13,
                    "line": "device = 'cuda' if torch.cuda.is_available() else 'cpu'\n",
                    "lineno": 13,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 13,
                    "start_region_line": 13
                },
                {
                    "end_outermost_loop": 14,
                    "end_region_line": 14,
                    "line": "dtype = 'float32'\n",
                    "lineno": 14,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 14,
                    "start_region_line": 14
                },
                {
                    "end_outermost_loop": 15,
                    "end_region_line": 15,
                    "line": "seed = 1337\n",
                    "lineno": 15,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 15,
                    "start_region_line": 15
                },
                {
                    "end_outermost_loop": 16,
                    "end_region_line": 16,
                    "line": "vocab_size = 1269\n",
                    "lineno": 16,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 16,
                    "start_region_line": 16
                },
                {
                    "end_outermost_loop": 17,
                    "end_region_line": 17,
                    "line": "batch_size = 128\n",
                    "lineno": 17,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 17,
                    "start_region_line": 17
                },
                {
                    "end_outermost_loop": 18,
                    "end_region_line": 18,
                    "line": "iterations = 1\n",
                    "lineno": 18,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 18,
                    "start_region_line": 18
                },
                {
                    "end_outermost_loop": 19,
                    "end_region_line": 19,
                    "line": "max_age = 85 * 365.25\n",
                    "lineno": 19,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 19,
                    "start_region_line": 19
                },
                {
                    "end_outermost_loop": 20,
                    "end_region_line": 20,
                    "line": "\n",
                    "lineno": 20,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 20,
                    "start_region_line": 20
                },
                {
                    "end_outermost_loop": 21,
                    "end_region_line": 21,
                    "line": "torch.manual_seed(seed)\n",
                    "lineno": 21,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09314711940508313,
                    "n_cpu_percent_c": 0.007749980063202463,
                    "n_cpu_percent_python": 0.002620804187617037,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0035464258532827047,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 21,
                    "start_region_line": 21
                },
                {
                    "end_outermost_loop": 22,
                    "end_region_line": 22,
                    "line": "torch.cuda.manual_seed(seed)\n",
                    "lineno": 22,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 22,
                    "start_region_line": 22
                },
                {
                    "end_outermost_loop": 23,
                    "end_region_line": 23,
                    "line": "\n",
                    "lineno": 23,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 23,
                    "start_region_line": 23
                },
                {
                    "end_outermost_loop": 24,
                    "end_region_line": 24,
                    "line": "device_type = 'cuda' if 'cuda' in device else 'cpu'\n",
                    "lineno": 24,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 24,
                    "start_region_line": 24
                },
                {
                    "end_outermost_loop": 25,
                    "end_region_line": 25,
                    "line": "dtype = {'float32': torch.float32, 'float64': torch.float64, 'bfloat16': torch.bfloat16, 'float16': torch.float16}[dtype]\n",
                    "lineno": 25,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 25,
                    "start_region_line": 25
                },
                {
                    "end_outermost_loop": 26,
                    "end_region_line": 26,
                    "line": "\n",
                    "lineno": 26,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 26,
                    "start_region_line": 26
                },
                {
                    "end_outermost_loop": 27,
                    "end_region_line": 27,
                    "line": "ckpt_path = os.path.join(out_dir, 'ckpt.pt')\n",
                    "lineno": 27,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 27,
                    "start_region_line": 27
                },
                {
                    "end_outermost_loop": 28,
                    "end_region_line": 28,
                    "line": "checkpoint = torch.load(ckpt_path, map_location=device)\n",
                    "lineno": 28,
                    "memory_samples": [
                        [
                            4622692736,
                            121.26498889923096
                        ],
                        [
                            4662467799,
                            131.36919689178467
                        ],
                        [
                            4689506692,
                            141.63390731811523
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 2.1545771056602314,
                    "n_core_utilization": 0.03932128436889149,
                    "n_cpu_percent_c": 0.001377517336500459,
                    "n_cpu_percent_python": 0.011063507641960148,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 30.2571964263916,
                    "n_malloc_mb": 30.2571964263916,
                    "n_mallocs": 0,
                    "n_peak_mb": 30.2571964263916,
                    "n_python_fraction": 0.3591548051485849,
                    "n_sys_percent": 0.027108245785896594,
                    "n_usage_fraction": 0.00018906940334472577,
                    "start_outermost_loop": 28,
                    "start_region_line": 28
                },
                {
                    "end_outermost_loop": 29,
                    "end_region_line": 29,
                    "line": "conf = DelphiConfig(**checkpoint['model_args'])\n",
                    "lineno": 29,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 29,
                    "start_region_line": 29
                },
                {
                    "end_outermost_loop": 30,
                    "end_region_line": 30,
                    "line": "model = Delphi(conf)\n",
                    "lineno": 30,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 30,
                    "start_region_line": 30
                },
                {
                    "end_outermost_loop": 31,
                    "end_region_line": 31,
                    "line": "state_dict = checkpoint['model']\n",
                    "lineno": 31,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 31
                },
                {
                    "end_outermost_loop": 32,
                    "end_region_line": 32,
                    "line": "model.load_state_dict(state_dict)\n",
                    "lineno": 32,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 32,
                    "start_region_line": 32
                },
                {
                    "end_outermost_loop": 33,
                    "end_region_line": 33,
                    "line": "\n",
                    "lineno": 33,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 33,
                    "start_region_line": 33
                },
                {
                    "end_outermost_loop": 34,
                    "end_region_line": 34,
                    "line": "model.eval()\n",
                    "lineno": 34,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4619553671133092,
                    "n_cpu_percent_c": 0.011076510955462122,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 34,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 35,
                    "end_region_line": 35,
                    "line": "model = model.to(device)\n",
                    "lineno": 35,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 35,
                    "start_region_line": 35
                },
                {
                    "end_outermost_loop": 36,
                    "end_region_line": 36,
                    "line": "\n",
                    "lineno": 36,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 36,
                    "start_region_line": 36
                },
                {
                    "end_outermost_loop": 37,
                    "end_region_line": 37,
                    "line": "# Function to generate synthetic input with padding and end tokens\n",
                    "lineno": 37,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 37,
                    "start_region_line": 37
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "def generate_synthetic_input(seq_length, batch_size, vocab_size, max_age):\n",
                    "lineno": 38,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "    # Token-Daten erzeugen, initialisiere mit 0 (Padding)\n",
                    "lineno": 39,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 40,
                    "end_region_line": 60,
                    "line": "    d0 = torch.zeros(batch_size, seq_length, dtype=torch.long).to(device)\n",
                    "lineno": 40,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 40,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 41,
                    "end_region_line": 60,
                    "line": "    \n",
                    "lineno": 41,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 41,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "    # Altersdaten erzeugen\n",
                    "lineno": 42,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 43,
                    "end_region_line": 60,
                    "line": "    d1 = torch.rand(batch_size, seq_length).to(device) * max_age\n",
                    "lineno": 43,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 43,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 44,
                    "end_region_line": 60,
                    "line": "\n",
                    "lineno": 44,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 44,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "    # Beispielhafter Token-Bereich f\u00fcr Tokens au\u00dfer dem Ende-Token\n",
                    "lineno": 45,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 46,
                    "end_region_line": 60,
                    "line": "    non_end_token_limit = vocab_size - 2  # Reserviere Platz f\u00fcr Token 0 und 1\n",
                    "lineno": 46,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 46,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 60,
                    "line": "    \n",
                    "lineno": 47,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 47,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "    # Zuf\u00e4llige Tokens zwischen 0 und (vocab_size - 2) au\u00dfer dem End-Token (1)\n",
                    "lineno": 48,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 49,
                    "end_region_line": 60,
                    "line": "    random_tokens = torch.randint(2, non_end_token_limit, (batch_size, seq_length - 1), dtype=torch.long).to(device)\n",
                    "lineno": 49,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 49,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 50,
                    "end_region_line": 60,
                    "line": "    \n",
                    "lineno": 50,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "    # In die Sequenzen einf\u00fcgen, End-Token (1) am Ende jeder Sequenz\n",
                    "lineno": 51,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 52,
                    "end_region_line": 60,
                    "line": "    d0[:, :-1] = random_tokens  # F\u00fclle die Sequenzen mit zuf\u00e4lligen Tokens\n",
                    "lineno": 52,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 52,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 53,
                    "end_region_line": 60,
                    "line": "    d0[:, -1] = 1  # End-Token am Ende jeder Sequenz\n",
                    "lineno": 53,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 53,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 54,
                    "end_region_line": 60,
                    "line": "    \n",
                    "lineno": 54,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 54,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "    # Sortiere `d1` (Alterswerte) aufsteigend und wende die gleiche Sortierung auf `d0` an\n",
                    "lineno": 55,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 56,
                    "end_region_line": 60,
                    "line": "    o = d1.argsort(1)\n",
                    "lineno": 56,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 56,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 57,
                    "end_region_line": 60,
                    "line": "    d0 = d0.gather(1, o)\n",
                    "lineno": 57,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 57,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 58,
                    "end_region_line": 60,
                    "line": "    d1 = d1.gather(1, o)\n",
                    "lineno": 58,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 58,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 60,
                    "line": "    \n",
                    "lineno": 59,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 59,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 60,
                    "line": "    return d0, d1\n",
                    "lineno": 60,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 60,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 61,
                    "end_region_line": 61,
                    "line": "\n",
                    "lineno": 61,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 61,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 62,
                    "end_region_line": 62,
                    "line": "# Benchmarking function\n",
                    "lineno": 62,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 62,
                    "start_region_line": 62
                },
                {
                    "end_outermost_loop": 71,
                    "end_region_line": 71,
                    "line": "def benchmark(model, start_length, seq_length, use_kvcache, iterations):\n",
                    "lineno": 63,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 63,
                    "start_region_line": 63
                },
                {
                    "end_outermost_loop": 64,
                    "end_region_line": 71,
                    "line": "    token_data, age_data = generate_synthetic_input(start_length, batch_size, vocab_size, max_age=max_age) \n",
                    "lineno": 64,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 64,
                    "start_region_line": 63
                },
                {
                    "end_outermost_loop": 65,
                    "end_region_line": 71,
                    "line": "    times = []\n",
                    "lineno": 65,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 65,
                    "start_region_line": 63
                },
                {
                    "end_outermost_loop": 70,
                    "end_region_line": 70,
                    "line": "    for _ in range(iterations):\n",
                    "lineno": 66,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 66,
                    "start_region_line": 66
                },
                {
                    "end_outermost_loop": 70,
                    "end_region_line": 70,
                    "line": "        start_time = time.time()\n",
                    "lineno": 67,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 66,
                    "start_region_line": 66
                },
                {
                    "end_outermost_loop": 70,
                    "end_region_line": 70,
                    "line": "        with torch.no_grad():\n",
                    "lineno": 68,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 66,
                    "start_region_line": 66
                },
                {
                    "end_outermost_loop": 70,
                    "end_region_line": 70,
                    "line": "            _,_,_,_,times = model.generate(token_data, age_data, max_new_tokens = seq_length, max_age=max_age, no_repeat=False, use_kvcache=use_kvcache)\n",
                    "lineno": 69,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 66,
                    "start_region_line": 66
                },
                {
                    "end_outermost_loop": 70,
                    "end_region_line": 70,
                    "line": "        end_time = time.time()\n",
                    "lineno": 70,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 66,
                    "start_region_line": 66
                },
                {
                    "end_outermost_loop": 71,
                    "end_region_line": 71,
                    "line": "    return times\n",
                    "lineno": 71,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 71,
                    "start_region_line": 63
                },
                {
                    "end_outermost_loop": 72,
                    "end_region_line": 72,
                    "line": "\n",
                    "lineno": 72,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 72,
                    "start_region_line": 72
                },
                {
                    "end_outermost_loop": 73,
                    "end_region_line": 73,
                    "line": "# Define sequence lengths\n",
                    "lineno": 73,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 73,
                    "start_region_line": 73
                },
                {
                    "end_outermost_loop": 74,
                    "end_region_line": 74,
                    "line": "seq_length = 61\n",
                    "lineno": 74,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 74,
                    "start_region_line": 74
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 75,
                    "line": "start_length = 5\n",
                    "lineno": 75,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 75,
                    "start_region_line": 75
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "\n",
                    "lineno": 76,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 76,
                    "start_region_line": 76
                },
                {
                    "end_outermost_loop": 77,
                    "end_region_line": 77,
                    "line": "# Run benchmarks\n",
                    "lineno": 77,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 77,
                    "start_region_line": 77
                },
                {
                    "end_outermost_loop": 78,
                    "end_region_line": 78,
                    "line": "results_naive = []\n",
                    "lineno": 78,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 78,
                    "start_region_line": 78
                },
                {
                    "end_outermost_loop": 79,
                    "end_region_line": 79,
                    "line": "results_cache = []\n",
                    "lineno": 79,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 79,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 80,
                    "end_region_line": 80,
                    "line": "\n",
                    "lineno": 80,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 80,
                    "start_region_line": 80
                },
                {
                    "end_outermost_loop": 81,
                    "end_region_line": 81,
                    "line": "print(f\"Benchmarking for sequence length: {seq_length}\")\n",
                    "lineno": 81,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 81,
                    "start_region_line": 81
                },
                {
                    "end_outermost_loop": 82,
                    "end_region_line": 82,
                    "line": "naive_times = benchmark(model, start_length, seq_length, use_kvcache=False, iterations=iterations)\n",
                    "lineno": 82,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 82,
                    "start_region_line": 82
                },
                {
                    "end_outermost_loop": 83,
                    "end_region_line": 83,
                    "line": "cache_times = benchmark(model, start_length, seq_length, use_kvcache=True, iterations=iterations)\n",
                    "lineno": 83,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 83,
                    "start_region_line": 83
                },
                {
                    "end_outermost_loop": 84,
                    "end_region_line": 84,
                    "line": "\n",
                    "lineno": 84,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 84,
                    "start_region_line": 84
                },
                {
                    "end_outermost_loop": 85,
                    "end_region_line": 85,
                    "line": "# Plot results\n",
                    "lineno": 85,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 85,
                    "start_region_line": 85
                },
                {
                    "end_outermost_loop": 86,
                    "end_region_line": 86,
                    "line": "plt.figure(figsize=(10, 6))\n",
                    "lineno": 86,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.15874436766533429,
                    "n_cpu_percent_c": 0.12677457046259252,
                    "n_cpu_percent_python": 0.008288375453027382,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0368716273913836,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 86,
                    "start_region_line": 86
                },
                {
                    "end_outermost_loop": 87,
                    "end_region_line": 87,
                    "line": "plt.plot([i for i in range(seq_length) if i % 20 == 0], naive_times, label='Naive (No Cache)', marker='o')\n",
                    "lineno": 87,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.11321315245907256,
                    "n_cpu_percent_c": 0.0025444861135310963,
                    "n_cpu_percent_python": 0.003185385720493592,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0005965484068745328,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 87,
                    "start_region_line": 87
                },
                {
                    "end_outermost_loop": 88,
                    "end_region_line": 88,
                    "line": "plt.plot([i for i in range(seq_length) if i % 20 == 0], cache_times, label='With Cache', marker='o')\n",
                    "lineno": 88,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 88,
                    "start_region_line": 88
                },
                {
                    "end_outermost_loop": 89,
                    "end_region_line": 89,
                    "line": "plt.xlabel('Sequence Length')\n",
                    "lineno": 89,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 90,
                    "end_region_line": 90,
                    "line": "plt.ylabel('Time to generate the next token (seconds)')\n",
                    "lineno": 90,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 90,
                    "start_region_line": 90
                },
                {
                    "end_outermost_loop": 91,
                    "end_region_line": 91,
                    "line": "plt.title('Benchmarking Sampling Speed with and without KV Cache')\n",
                    "lineno": 91,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 91,
                    "start_region_line": 91
                },
                {
                    "end_outermost_loop": 92,
                    "end_region_line": 92,
                    "line": "plt.legend()\n",
                    "lineno": 92,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 92,
                    "start_region_line": 92
                },
                {
                    "end_outermost_loop": 93,
                    "end_region_line": 93,
                    "line": "plt.grid(True)\n",
                    "lineno": 93,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 93,
                    "start_region_line": 93
                },
                {
                    "end_outermost_loop": 94,
                    "end_region_line": 94,
                    "line": "# Save the plot to a file\n",
                    "lineno": 94,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 94,
                    "start_region_line": 94
                },
                {
                    "end_outermost_loop": 95,
                    "end_region_line": 95,
                    "line": "plt.savefig('benchmarking_results.png')",
                    "lineno": 95,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 1.1034465636113409,
                    "n_core_utilization": 0.10821891635045383,
                    "n_cpu_percent_c": 0.04753189615753497,
                    "n_cpu_percent_python": 0.03044866990649738,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.012092141062674762,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 95,
                    "start_region_line": 95
                }
            ],
            "percent_cpu_time": 1.7295116868761453
        },
        "/Users/elenaschramme/Documents/Bachelorarbeit/Delphi/model.py": {
            "functions": [
                {
                    "line": "MLP.new_gelu",
                    "lineno": 20,
                    "memory_samples": [
                        [
                            5677781570,
                            293.937481880188
                        ],
                        [
                            6610363791,
                            350.50294399261475
                        ],
                        [
                            7758650327,
                            405.8331298828125
                        ],
                        [
                            10213177118,
                            528.2224378585815
                        ],
                        [
                            14319149829,
                            598.0300064086914
                        ],
                        [
                            15789078795,
                            780.5413017272949
                        ],
                        [
                            19368270323,
                            710.4283790588379
                        ],
                        [
                            21124893316,
                            795.9004859924316
                        ],
                        [
                            22134344329,
                            862.7464408874512
                        ],
                        [
                            22966521932,
                            865.5912590026855
                        ],
                        [
                            23152897338,
                            921.7861671447754
                        ],
                        [
                            23753587344,
                            939.7395973205566
                        ],
                        [
                            24349425896,
                            875.9091987609863
                        ],
                        [
                            24682813561,
                            1006.5754280090332
                        ],
                        [
                            25220272510,
                            869.2153816223145
                        ],
                        [
                            25220277910,
                            869.215991973877
                        ],
                        [
                            25537615694,
                            954.1951026916504
                        ],
                        [
                            25817634431,
                            1086.0489540100098
                        ],
                        [
                            26855137762,
                            1098.190341949463
                        ],
                        [
                            26855151336,
                            1098.1897315979004
                        ],
                        [
                            27268513707,
                            886.9272880554199
                        ],
                        [
                            27686829870,
                            1057.7211418151855
                        ],
                        [
                            27835523539,
                            1097.9498176574707
                        ],
                        [
                            28625318773,
                            1097.6247673034668
                        ],
                        [
                            29278870177,
                            807.6982765197754
                        ],
                        [
                            31385343981,
                            914.4509010314941
                        ],
                        [
                            31513777219,
                            977.461009979248
                        ],
                        [
                            31732582163,
                            1108.7286262512207
                        ],
                        [
                            31815787588,
                            1125.1407661437988
                        ],
                        [
                            32171261474,
                            1076.3524208068848
                        ],
                        [
                            32701335398,
                            1311.9596977233887
                        ],
                        [
                            34026152685,
                            1418.9963493347168
                        ],
                        [
                            34100810623,
                            1432.594295501709
                        ],
                        [
                            34368821968,
                            1085.4910774230957
                        ],
                        [
                            34645927914,
                            716.3827476501465
                        ],
                        [
                            34716905011,
                            738.0516624450684
                        ],
                        [
                            34803141327,
                            774.9162101745605
                        ],
                        [
                            35607327958,
                            1173.1602668762207
                        ],
                        [
                            36066737628,
                            1376.3990898132324
                        ],
                        [
                            36243804310,
                            1481.8778190612793
                        ],
                        [
                            36930826064,
                            685.5786933898926
                        ],
                        [
                            37201523082,
                            829.9999351501465
                        ],
                        [
                            37541411523,
                            974.4262275695801
                        ],
                        [
                            38709709001,
                            1435.2209663391113
                        ],
                        [
                            38781005679,
                            1468.647029876709
                        ],
                        [
                            39528039041,
                            769.8381538391113
                        ],
                        [
                            39781504125,
                            913.7504768371582
                        ],
                        [
                            40967449663,
                            1558.4698600769043
                        ],
                        [
                            41526459158,
                            1281.768756866455
                        ],
                        [
                            42132254374,
                            1536.9973945617676
                        ],
                        [
                            42719237924,
                            1262.550380706787
                        ],
                        [
                            43433564796,
                            1590.1408424377441
                        ],
                        [
                            43927720568,
                            1645.4578742980957
                        ],
                        [
                            46403434555,
                            1731.6772270202637
                        ],
                        [
                            46667138347,
                            455.6971855163574
                        ],
                        [
                            49120208164,
                            536.6811866760254
                        ],
                        [
                            49691725496,
                            596.848575592041
                        ],
                        [
                            50068764934,
                            598.9158363342285
                        ],
                        [
                            50791400903,
                            578.8989601135254
                        ],
                        [
                            50852684234,
                            617.5757026672363
                        ],
                        [
                            51458590301,
                            659.0161170959473
                        ],
                        [
                            51853592472,
                            632.7424201965332
                        ],
                        [
                            52884578858,
                            656.7190437316895
                        ],
                        [
                            53374638028,
                            622.3536720275879
                        ],
                        [
                            53716534854,
                            729.2457618713379
                        ],
                        [
                            54665891053,
                            715.8065528869629
                        ],
                        [
                            57078911304,
                            595.4077110290527
                        ],
                        [
                            57290267910,
                            680.498477935791
                        ],
                        [
                            57809137650,
                            847.0808601379395
                        ],
                        [
                            58189409602,
                            678.573902130127
                        ],
                        [
                            58916431386,
                            902.586727142334
                        ],
                        [
                            59097995920,
                            632.8519706726074
                        ],
                        [
                            59845272368,
                            1010.5356483459473
                        ],
                        [
                            59878926097,
                            1032.476474761963
                        ],
                        [
                            60354360343,
                            1031.9079093933105
                        ],
                        [
                            60507632445,
                            1082.7417182922363
                        ],
                        [
                            60558702405,
                            1097.0998039245605
                        ],
                        [
                            60846243564,
                            944.1208610534668
                        ],
                        [
                            61054523414,
                            1014.445728302002
                        ],
                        [
                            61830136823,
                            1031.818515777588
                        ],
                        [
                            62105256030,
                            1134.938564300537
                        ],
                        [
                            62331076177,
                            921.2049217224121
                        ],
                        [
                            62838637539,
                            787.630298614502
                        ],
                        [
                            63400483809,
                            1069.225284576416
                        ],
                        [
                            63452828129,
                            1088.7942237854004
                        ],
                        [
                            63509339781,
                            1098.731243133545
                        ],
                        [
                            63690885076,
                            1094.498622894287
                        ],
                        [
                            64325187372,
                            903.2401847839355
                        ],
                        [
                            65388334718,
                            1183.3862342834473
                        ],
                        [
                            68017859190,
                            1401.990032196045
                        ],
                        [
                            68952417085,
                            1352.5074653625488
                        ],
                        [
                            69527043714,
                            1200.3370323181152
                        ],
                        [
                            71432568517,
                            1219.9839363098145
                        ],
                        [
                            72375288270,
                            903.1582221984863
                        ],
                        [
                            72901179008,
                            982.8657417297363
                        ],
                        [
                            73130813082,
                            1086.5796012878418
                        ],
                        [
                            73854119366,
                            1320.690357208252
                        ],
                        [
                            73971594039,
                            1406.9544105529785
                        ],
                        [
                            74685272764,
                            936.6988716125488
                        ],
                        [
                            75770614211,
                            1383.44144821167
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.40689814128803026,
                    "n_cpu_percent_c": 20.474920301806282,
                    "n_cpu_percent_python": 4.05161002752654,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 88394.10130882263,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.000360355655772794,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.5523519019453794
                },
                {
                    "line": "LayerNorm.forward",
                    "lineno": 35,
                    "memory_samples": [
                        [
                            16924975416,
                            795.690486907959
                        ],
                        [
                            28037017803,
                            1110.6903343200684
                        ],
                        [
                            28745030699,
                            1098.2871437072754
                        ],
                        [
                            30029081203,
                            1045.3704948425293
                        ],
                        [
                            30315249679,
                            937.7252311706543
                        ],
                        [
                            30470790035,
                            804.7580986022949
                        ],
                        [
                            40028838915,
                            995.1458015441895
                        ],
                        [
                            56902622124,
                            770.3738746643066
                        ],
                        [
                            57468198257,
                            680.3074226379395
                        ],
                        [
                            57522357208,
                            703.0722846984863
                        ],
                        [
                            59005856416,
                            864.6336250305176
                        ],
                        [
                            62497428456,
                            906.5780906677246
                        ],
                        [
                            63668745559,
                            1079.0201683044434
                        ],
                        [
                            64427513622,
                            887.3613624572754
                        ],
                        [
                            64806813223,
                            899.8041343688965
                        ],
                        [
                            64938251469,
                            939.6995735168457
                        ],
                        [
                            70473786436,
                            1114.656650543213
                        ],
                        [
                            75297845702,
                            1087.8421821594238
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.41573021801607274,
                    "n_cpu_percent_c": 0.4760029948535162,
                    "n_cpu_percent_python": 0.13033726070411344,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 206.9514446258545,
                    "n_malloc_mb": 206.9514446258545,
                    "n_mallocs": 0,
                    "n_peak_mb": 206.9514446258545,
                    "n_python_fraction": 0.0006267271590098037,
                    "n_sys_percent": 0.015396536577015939,
                    "n_usage_fraction": 0.0012931861103499369
                },
                {
                    "line": "CausalSelfAttention.__init__",
                    "lineno": 40,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.26129822595964464,
                    "n_cpu_percent_c": 0.006257838300328194,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0
                },
                {
                    "line": "CausalSelfAttention.forward",
                    "lineno": 61,
                    "memory_samples": [
                        [
                            10556881737,
                            460.41560649871826
                        ],
                        [
                            13321252477,
                            629.901177406311
                        ],
                        [
                            14724318594,
                            499.00376892089844
                        ],
                        [
                            16034996432,
                            702.4646110534668
                        ],
                        [
                            16802619576,
                            747.6863059997559
                        ],
                        [
                            16900973845,
                            784.2579383850098
                        ],
                        [
                            18097433559,
                            735.580509185791
                        ],
                        [
                            18217875617,
                            789.4086952209473
                        ],
                        [
                            18712290694,
                            702.2520942687988
                        ],
                        [
                            18735248868,
                            699.7924919128418
                        ],
                        [
                            18786211039,
                            722.4368705749512
                        ],
                        [
                            18838227624,
                            742.6198539733887
                        ],
                        [
                            19384660089,
                            692.0381126403809
                        ],
                        [
                            19966072558,
                            898.6954460144043
                        ],
                        [
                            20104093180,
                            675.4680671691895
                        ],
                        [
                            20188226414,
                            697.1300315856934
                        ],
                        [
                            21019560316,
                            727.3377723693848
                        ],
                        [
                            22213806385,
                            857.3603401184082
                        ],
                        [
                            22242240547,
                            872.4594688415527
                        ],
                        [
                            22801913170,
                            792.051685333252
                        ],
                        [
                            23073700030,
                            864.776065826416
                        ],
                        [
                            23540422645,
                            805.839672088623
                        ],
                        [
                            23610214357,
                            849.7241554260254
                        ],
                        [
                            23860072413,
                            954.3640937805176
                        ],
                        [
                            24532040457,
                            914.0878105163574
                        ],
                        [
                            24729529705,
                            999.091381072998
                        ],
                        [
                            24963174826,
                            1073.181552886963
                        ],
                        [
                            25328145588,
                            867.9985618591309
                        ],
                        [
                            25698534117,
                            982.274600982666
                        ],
                        [
                            26401250884,
                            892.8560829162598
                        ],
                        [
                            26655085725,
                            968.1770057678223
                        ],
                        [
                            26688005308,
                            986.4126243591309
                        ],
                        [
                            27861218012,
                            1112.5324440002441
                        ],
                        [
                            28492706116,
                            1010.6541862487793
                        ],
                        [
                            28594779361,
                            1063.1475105285645
                        ],
                        [
                            28713341978,
                            1105.0831565856934
                        ],
                        [
                            29250055233,
                            769.6978492736816
                        ],
                        [
                            29567581857,
                            905.1668968200684
                        ],
                        [
                            30533393463,
                            856.6793403625488
                        ],
                        [
                            30646854681,
                            889.6064872741699
                        ],
                        [
                            30794909092,
                            995.3204460144043
                        ],
                        [
                            31422244900,
                            912.4447822570801
                        ],
                        [
                            31536617034,
                            975.4541893005371
                        ],
                        [
                            31788043612,
                            1089.0407600402832
                        ],
                        [
                            32369434354,
                            1126.855281829834
                        ],
                        [
                            32795618111,
                            1337.582103729248
                        ],
                        [
                            32971721672,
                            1386.0803031921387
                        ],
                        [
                            33290305448,
                            1059.5276679992676
                        ],
                        [
                            33440611092,
                            1142.8461112976074
                        ],
                        [
                            33922664732,
                            1329.843563079834
                        ],
                        [
                            34000475522,
                            1363.1529350280762
                        ],
                        [
                            34050728372,
                            1412.7193183898926
                        ],
                        [
                            35057372602,
                            884.4616584777832
                        ],
                        [
                            36101491527,
                            1341.9390602111816
                        ],
                        [
                            36216006589,
                            1419.2927589416504
                        ],
                        [
                            36890285985,
                            674.8451728820801
                        ],
                        [
                            37137119877,
                            783.1634330749512
                        ],
                        [
                            37993591735,
                            1118.2724113464355
                        ],
                        [
                            38186965942,
                            1184.504810333252
                        ],
                        [
                            38240217028,
                            1218.5522499084473
                        ],
                        [
                            38396401639,
                            1269.5254249572754
                        ],
                        [
                            40930559439,
                            1482.5592765808105
                        ],
                        [
                            41461916002,
                            1243.9980506896973
                        ],
                        [
                            42059275051,
                            1458.9063911437988
                        ],
                        [
                            42069872614,
                            1523.9775581359863
                        ],
                        [
                            42920848748,
                            1371.2282781600952
                        ],
                        [
                            43287129652,
                            1510.4087562561035
                        ],
                        [
                            43548058376,
                            1600.203540802002
                        ],
                        [
                            47527595962,
                            475.4111442565918
                        ],
                        [
                            49020463798,
                            494.7043876647949
                        ],
                        [
                            50744042383,
                            552.6428260803223
                        ],
                        [
                            50935657437,
                            622.2649955749512
                        ],
                        [
                            52909379537,
                            636.7946510314941
                        ],
                        [
                            56891738808,
                            815.1207237243652
                        ],
                        [
                            57745052437,
                            798.6247901916504
                        ],
                        [
                            59497087452,
                            788.9394111633301
                        ],
                        [
                            59693490332,
                            890.5273094177246
                        ],
                        [
                            59855024878,
                            988.9800834655762
                        ],
                        [
                            62725319783,
                            714.5548896789551
                        ],
                        [
                            63321520304,
                            988.1088829040527
                        ],
                        [
                            64558313987,
                            851.1445121765137
                        ],
                        [
                            65893080006,
                            684.3091468811035
                        ],
                        [
                            66541922290,
                            1029.6491813659668
                        ],
                        [
                            66663437944,
                            1081.092975616455
                        ],
                        [
                            66912630022,
                            1183.9806175231934
                        ],
                        [
                            67250363567,
                            994.4444999694824
                        ],
                        [
                            67834153772,
                            1283.9753532409668
                        ],
                        [
                            68995172078,
                            1346.1482582092285
                        ],
                        [
                            70301416171,
                            1057.0118446350098
                        ],
                        [
                            71009926846,
                            961.6418800354004
                        ],
                        [
                            71304175795,
                            1095.3204612731934
                        ],
                        [
                            71994609901,
                            1380.190486907959
                        ],
                        [
                            72845013424,
                            900.5416297912598
                        ],
                        [
                            73396786220,
                            1048.2495307922363
                        ],
                        [
                            73455849131,
                            1047.2842750549316
                        ],
                        [
                            74539315487,
                            927.7165489196777
                        ],
                        [
                            74574636334,
                            918.3591575622559
                        ],
                        [
                            75119237564,
                            1037.817310333252
                        ],
                        [
                            75263047622,
                            1102.573787689209
                        ],
                        [
                            76248588408,
                            1555.9382286071777
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 41.211285602164914,
                    "n_core_utilization": 0.4407386186705268,
                    "n_cpu_percent_c": 38.740780775920825,
                    "n_cpu_percent_python": 6.239198080583455,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 41111.13536930084,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.0005716701751528606,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.25689286362031044
                },
                {
                    "line": "MLP.__init__",
                    "lineno": 108,
                    "memory_samples": [
                        [
                            4751692161,
                            151.7818832397461
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.461025511871033,
                    "n_cpu_percent_c": 0.056194635294112394,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.053732872009277,
                    "n_malloc_mb": 10.053732872009277,
                    "n_mallocs": 0,
                    "n_peak_mb": 10.053732872009277,
                    "n_python_fraction": 0.742699,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 6.282317927645293e-05
                },
                {
                    "line": "MLP.forward",
                    "lineno": 114,
                    "memory_samples": [
                        [
                            7442801414,
                            388.79785919189453
                        ],
                        [
                            7809519614,
                            416.3849906921387
                        ],
                        [
                            14573411956,
                            680.0807571411133
                        ],
                        [
                            15081430124,
                            473.7902183532715
                        ],
                        [
                            16213321464,
                            758.1373481750488
                        ],
                        [
                            16798305755,
                            731.6868858337402
                        ],
                        [
                            17621474253,
                            761.3174476623535
                        ],
                        [
                            18643643869,
                            674.682689666748
                        ],
                        [
                            18757564940,
                            714.5568504333496
                        ],
                        [
                            22768094218,
                            747.7036552429199
                        ],
                        [
                            23536020590,
                            801.3314933776855
                        ],
                        [
                            23980280741,
                            1034.2509880065918
                        ],
                        [
                            24831343130,
                            1022.0643424987793
                        ],
                        [
                            25864887694,
                            1068.4741325378418
                        ],
                        [
                            26860555624,
                            1046.7873725891113
                        ],
                        [
                            26998532734,
                            1101.1865196228027
                        ],
                        [
                            27280773402,
                            837.5682334899902
                        ],
                        [
                            27698200805,
                            1008.3623924255371
                        ],
                        [
                            27995443889,
                            1117.4595832824707
                        ],
                        [
                            28344388434,
                            920.2545356750488
                        ],
                        [
                            29843910805,
                            1010.8691444396973
                        ],
                        [
                            30266291875,
                            962.2177543640137
                        ],
                        [
                            30710942005,
                            934.091869354248
                        ],
                        [
                            30782331713,
                            955.046314239502
                        ],
                        [
                            32183209614,
                            1008.7856407165527
                        ],
                        [
                            32408872167,
                            1117.8354530334473
                        ],
                        [
                            32631275332,
                            1215.0447959899902
                        ],
                        [
                            32829824241,
                            1326.6403541564941
                        ],
                        [
                            34008835234,
                            1367.9644203186035
                        ],
                        [
                            34113056025,
                            1404.6727714538574
                        ],
                        [
                            34728350179,
                            707.3211555480957
                        ],
                        [
                            34808706414,
                            727.724536895752
                        ],
                        [
                            35044323835,
                            839.582332611084
                        ],
                        [
                            36096895590,
                            1358.8219718933105
                        ],
                        [
                            36875860051,
                            632.7119483947754
                        ],
                        [
                            37378383287,
                            849.3494834899902
                        ],
                        [
                            37545309087,
                            921.5622978210449
                        ],
                        [
                            38223517496,
                            1173.000675201416
                        ],
                        [
                            38305087982,
                            1228.232135772705
                        ],
                        [
                            38524732973,
                            1324.7573585510254
                        ],
                        [
                            38721886006,
                            1373.5609397888184
                        ],
                        [
                            39214482121,
                            616.6907997131348
                        ],
                        [
                            39778976741,
                            868.6883277893066
                        ],
                        [
                            40711704203,
                            1351.676700592041
                        ],
                        [
                            41705519102,
                            1310.664394378662
                        ],
                        [
                            42144507695,
                            1510.6577949523926
                        ],
                        [
                            42231584080,
                            1550.6547355651855
                        ],
                        [
                            42231586679,
                            1535.4203834533691
                        ],
                        [
                            42993846734,
                            1317.479335784912
                        ],
                        [
                            43055500405,
                            1369.690372467041
                        ],
                        [
                            46569140637,
                            1194.5543479919434
                        ],
                        [
                            46801667004,
                            491.70468521118164
                        ],
                        [
                            47227013212,
                            562.6601448059082
                        ],
                        [
                            47677035282,
                            529.0259742736816
                        ],
                        [
                            48266084924,
                            496.9717445373535
                        ],
                        [
                            48494139777,
                            572.9259071350098
                        ],
                        [
                            48911938874,
                            595.048038482666
                        ],
                        [
                            50496733094,
                            610.0408515930176
                        ],
                        [
                            54937043552,
                            597.6421928405762
                        ],
                        [
                            58412682390,
                            730.876880645752
                        ],
                        [
                            58807468427,
                            840.8873329162598
                        ],
                        [
                            59610641237,
                            854.7017784118652
                        ],
                        [
                            60090702789,
                            898.6626014709473
                        ],
                        [
                            60241539568,
                            955.2378120422363
                        ],
                        [
                            61041318653,
                            988.0776786804199
                        ],
                        [
                            61196138190,
                            1052.539951324463
                        ],
                        [
                            62734199421,
                            719.3743324279785
                        ],
                        [
                            63763911449,
                            1082.065586090088
                        ],
                        [
                            64309953028,
                            873.497013092041
                        ],
                        [
                            64435511618,
                            875.6411018371582
                        ],
                        [
                            65187134757,
                            1062.1850242614746
                        ],
                        [
                            65793493329,
                            638.1630516052246
                        ],
                        [
                            66202800700,
                            884.2879600524902
                        ],
                        [
                            66536821952,
                            1034.146541595459
                        ],
                        [
                            66843436527,
                            1162.75590133667
                        ],
                        [
                            66881851529,
                            1185.1372871398926
                        ],
                        [
                            67440277985,
                            1096.0770988464355
                        ],
                        [
                            67632958163,
                            1194.6499061584473
                        ],
                        [
                            67699942660,
                            1215.71529006958
                        ],
                        [
                            67699945397,
                            1202.1215019226074
                        ],
                        [
                            68022896647,
                            1348.2709007263184
                        ],
                        [
                            68537410090,
                            1154.3858528137207
                        ],
                        [
                            69347743207,
                            1091.3428001403809
                        ],
                        [
                            69348559354,
                            1077.280361175537
                        ],
                        [
                            70434677043,
                            1118.163631439209
                        ],
                        [
                            70601078036,
                            782.8763542175293
                        ],
                        [
                            71070864045,
                            989.1459541320801
                        ],
                        [
                            71445394915,
                            1158.2029609680176
                        ],
                        [
                            71519271783,
                            1209.7999153137207
                        ],
                        [
                            71591606587,
                            1217.7876014709473
                        ],
                        [
                            71664104031,
                            1247.579891204834
                        ],
                        [
                            71806769798,
                            1328.9692878723145
                        ],
                        [
                            71923537528,
                            1384.9202690124512
                        ],
                        [
                            72531071592,
                            933.8062705993652
                        ],
                        [
                            72914640317,
                            957.0265312194824
                        ],
                        [
                            73596945898,
                            1156.418888092041
                        ],
                        [
                            73773803238,
                            1250.928623199463
                        ],
                        [
                            74439524951,
                            874.4117393493652
                        ],
                        [
                            74533008573,
                            910.5995674133301
                        ],
                        [
                            74585243108,
                            893.0428504943848
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.42453582281559804,
                    "n_cpu_percent_c": 8.195964823890634,
                    "n_cpu_percent_python": 2.103726283026348,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 12171.904574394226,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.00036265999856702826,
                    "n_sys_percent": 0.014542130176216873,
                    "n_usage_fraction": 0.07605908700259928
                },
                {
                    "line": "Block.forward",
                    "lineno": 130,
                    "memory_samples": [
                        [
                            5491471770,
                            268.4931411743164
                        ],
                        [
                            5549103827,
                            286.08445167541504
                        ],
                        [
                            5568912263,
                            291.9480037689209
                        ],
                        [
                            7282163769,
                            336.3425226211548
                        ],
                        [
                            8348736852,
                            485.2781410217285
                        ],
                        [
                            8457644409,
                            526.5388898849487
                        ],
                        [
                            10389445249,
                            567.7870683670044
                        ],
                        [
                            10491078507,
                            605.7647199630737
                        ],
                        [
                            10776471693,
                            536.1376533508301
                        ],
                        [
                            11122124285,
                            490.09331798553467
                        ],
                        [
                            12468455915,
                            629.9241809844971
                        ],
                        [
                            12771589469,
                            594.2639398574829
                        ],
                        [
                            13302493761,
                            604.7603845596313
                        ],
                        [
                            15427516389,
                            609.2463445663452
                        ],
                        [
                            16749397040,
                            713.4021263122559
                        ],
                        [
                            17758608710,
                            836.3297157287598
                        ],
                        [
                            18484758781,
                            874.2319068908691
                        ],
                        [
                            21950538608,
                            756.5382652282715
                        ],
                        [
                            22150370899,
                            831.4817161560059
                        ],
                        [
                            22425191222,
                            942.0074729919434
                        ],
                        [
                            24073889722,
                            1069.6954460144043
                        ],
                        [
                            24472922680,
                            885.6553916931152
                        ],
                        [
                            24564632551,
                            919.8288612365723
                        ],
                        [
                            25024268597,
                            1095.868953704834
                        ],
                        [
                            25630423794,
                            952.9733695983887
                        ],
                        [
                            28528030221,
                            1007.5482215881348
                        ],
                        [
                            28671043185,
                            1065.3236198425293
                        ],
                        [
                            29742465382,
                            961.4960899353027
                        ],
                        [
                            29955975292,
                            1047.572452545166
                        ],
                        [
                            31433826759,
                            896.728588104248
                        ],
                        [
                            31666226810,
                            1022.7471122741699
                        ],
                        [
                            32557871351,
                            1182.6412391662598
                        ],
                        [
                            33471751550,
                            1110.2746391296387
                        ],
                        [
                            34488813319,
                            579.077808380127
                        ],
                        [
                            34543713879,
                            615.5945014953613
                        ],
                        [
                            35257673329,
                            935.3607978820801
                        ],
                        [
                            35820384302,
                            1225.9078330993652
                        ],
                        [
                            35981195657,
                            1296.2297554016113
                        ],
                        [
                            37947783799,
                            1065.3325462341309
                        ],
                        [
                            38027490346,
                            1098.7592430114746
                        ],
                        [
                            39522340321,
                            736.6146049499512
                        ],
                        [
                            39605782093,
                            774.174129486084
                        ],
                        [
                            40746338759,
                            1355.9220924377441
                        ],
                        [
                            42016817175,
                            1447.4789085388184
                        ],
                        [
                            43409070407,
                            1514.341968536377
                        ],
                        [
                            43447929926,
                            1522.4646949768066
                        ],
                        [
                            44189390074,
                            1647.1576118469238
                        ],
                        [
                            44293591126,
                            1664.477108001709
                        ],
                        [
                            45103959412,
                            1687.3913536071777
                        ],
                        [
                            45591944814,
                            1681.6383171081543
                        ],
                        [
                            45689556153,
                            1705.6950340270996
                        ],
                        [
                            47041915513,
                            496.6092720031738
                        ],
                        [
                            47460604902,
                            560.9995307922363
                        ],
                        [
                            48173322941,
                            579.325626373291
                        ],
                        [
                            49545755060,
                            531.7988395690918
                        ],
                        [
                            50011659060,
                            549.8680076599121
                        ],
                        [
                            50396863372,
                            546.2804832458496
                        ],
                        [
                            50582883606,
                            643.7979469299316
                        ],
                        [
                            50728666799,
                            542.1561546325684
                        ],
                        [
                            50953211206,
                            623.3821830749512
                        ],
                        [
                            52058897781,
                            679.9206275939941
                        ],
                        [
                            52532290359,
                            678.3510780334473
                        ],
                        [
                            53389876175,
                            606.7678565979004
                        ],
                        [
                            55312128234,
                            722.1185340881348
                        ],
                        [
                            57489329560,
                            682.9460029602051
                        ],
                        [
                            58362665781,
                            699.7059898376465
                        ],
                        [
                            58856448670,
                            840.9880027770996
                        ],
                        [
                            59574305603,
                            815.9831581115723
                        ],
                        [
                            60310659080,
                            969.3118553161621
                        ],
                        [
                            60832324704,
                            888.5536308288574
                        ],
                        [
                            60933069849,
                            929.5750923156738
                        ],
                        [
                            61783356008,
                            971.4474906921387
                        ],
                        [
                            61815732560,
                            986.7896156311035
                        ],
                        [
                            61838677820,
                            995.6582374572754
                        ],
                        [
                            62577047218,
                            632.2822685241699
                        ],
                        [
                            62630135261,
                            654.2625389099121
                        ],
                        [
                            63270269658,
                            954.3857307434082
                        ],
                        [
                            63575207920,
                            1073.8745765686035
                        ],
                        [
                            64187938205,
                            807.775074005127
                        ],
                        [
                            66183100896,
                            849.5037422180176
                        ],
                        [
                            66659255575,
                            1067.2149543762207
                        ],
                        [
                            66690762726,
                            1083.013729095459
                        ],
                        [
                            67347104709,
                            1059.4667167663574
                        ],
                        [
                            67862170865,
                            1271.5561180114746
                        ],
                        [
                            68023519373,
                            1334.676830291748
                        ],
                        [
                            68401227075,
                            1079.1096458435059
                        ],
                        [
                            68430680652,
                            1089.3841667175293
                        ],
                        [
                            68532344522,
                            1133.740566253662
                        ],
                        [
                            68697191746,
                            1198.646884918213
                        ],
                        [
                            69001032993,
                            1328.4085121154785
                        ],
                        [
                            70298224517,
                            1056.675624847412
                        ],
                        [
                            70601758106,
                            768.579158782959
                        ],
                        [
                            71773746099,
                            1296.3621635437012
                        ],
                        [
                            72035183922,
                            1290.6935539245605
                        ],
                        [
                            72348461062,
                            843.0434455871582
                        ],
                        [
                            73474849014,
                            1071.009334564209
                        ],
                        [
                            74065978258,
                            1386.0417366027832
                        ],
                        [
                            74352874008,
                            815.4303321838379
                        ],
                        [
                            75923214473,
                            1370.293544769287
                        ],
                        [
                            76612720784,
                            1577.1843299865723
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4209991567709288,
                    "n_cpu_percent_c": 1.8462029795005321,
                    "n_cpu_percent_python": 0.5029342308474876,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0
                },
                {
                    "line": "AgeEncoding.forward",
                    "lineno": 145,
                    "memory_samples": [
                        [
                            23462198942,
                            766.0431251525879
                        ],
                        [
                            28184602790,
                            840.9785499572754
                        ],
                        [
                            29196553372,
                            699.7103157043457
                        ],
                        [
                            30176961735,
                            896.7685966491699
                        ],
                        [
                            31221412444,
                            743.4188499450684
                        ],
                        [
                            35430493504,
                            1017.0758399963379
                        ],
                        [
                            36596914480,
                            1009.5810356140137
                        ],
                        [
                            37794289519,
                            990.5630378723145
                        ],
                        [
                            38996694783,
                            965.9665031433105
                        ],
                        [
                            40200063921,
                            1065.7336235046387
                        ],
                        [
                            41254950274,
                            1083.079288482666
                        ],
                        [
                            42528474608,
                            1092.380947113037
                        ],
                        [
                            57371751295,
                            700.3146781921387
                        ],
                        [
                            58083972219,
                            589.5450477600098
                        ],
                        [
                            58760891979,
                            803.5853996276855
                        ],
                        [
                            59478261634,
                            758.1010780334473
                        ],
                        [
                            59987748879,
                            838.5167503356934
                        ],
                        [
                            60736184994,
                            846.8890571594238
                        ],
                        [
                            61495502350,
                            855.5147972106934
                        ],
                        [
                            62286624473,
                            864.2820014953613
                        ],
                        [
                            63057887422,
                            859.7420921325684
                        ],
                        [
                            63903239839,
                            689.6166572570801
                        ],
                        [
                            64750287685,
                            933.9715843200684
                        ],
                        [
                            65677413381,
                            693.0754661560059
                        ],
                        [
                            66338536051,
                            921.2505149841309
                        ],
                        [
                            67239012305,
                            983.2594337463379
                        ],
                        [
                            68217161262,
                            996.2081489562988
                        ],
                        [
                            69197566776,
                            1006.1018867492676
                        ],
                        [
                            70204090304,
                            1012.7103385925293
                        ],
                        [
                            71214139087,
                            1050.0080070495605
                        ],
                        [
                            72295075178,
                            807.8815422058105
                        ],
                        [
                            73371313587,
                            1097.5646476745605
                        ],
                        [
                            74303713291,
                            778.4212226867676
                        ],
                        [
                            75485620308,
                            1160.8195610046387
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.348098007044477,
                    "n_cpu_percent_c": 0.445039466831779,
                    "n_cpu_percent_python": 0.04220427112006886,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 383.9967212677002,
                    "n_malloc_mb": 383.9967212677002,
                    "n_mallocs": 0,
                    "n_peak_mb": 383.9967212677002,
                    "n_python_fraction": 0.0008915706609187829,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0023994963034013454
                },
                {
                    "line": "Delphi.__init__",
                    "lineno": 175,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.45556410915759327,
                    "n_cpu_percent_c": 0.048044638838567806,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0
                },
                {
                    "line": "Delphi._init_weights",
                    "lineno": 221,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.44390860557164213,
                    "n_cpu_percent_c": 0.013538075068539974,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0
                },
                {
                    "line": "Delphi.forward",
                    "lineno": 229,
                    "memory_samples": [
                        [
                            7850065733,
                            442.16686630249023
                        ],
                        [
                            8915950135,
                            602.4209184646606
                        ],
                        [
                            9612332093,
                            624.5287656784058
                        ],
                        [
                            10512057573,
                            650.6926221847534
                        ],
                        [
                            11013219579,
                            652.9373788833618
                        ],
                        [
                            12527342989,
                            708.3953952789307
                        ],
                        [
                            12921320099,
                            722.5246992111206
                        ],
                        [
                            13482297088,
                            735.4825143814087
                        ],
                        [
                            14053408012,
                            752.1165208816528
                        ],
                        [
                            15283829023,
                            624.2226781845093
                        ],
                        [
                            17293608274,
                            679.9279670715332
                        ],
                        [
                            17852007936,
                            943.1670341491699
                        ],
                        [
                            18000359212,
                            667.5751152038574
                        ],
                        [
                            18521978900,
                            982.8160591125488
                        ],
                        [
                            19252847089,
                            1003.0074729919434
                        ],
                        [
                            20054708365,
                            1036.97456741333
                        ],
                        [
                            21647908655,
                            1066.2076530456543
                        ],
                        [
                            21673628423,
                            1008.4060173034668
                        ],
                        [
                            22330567150,
                            892.9451560974121
                        ],
                        [
                            22520517545,
                            1064.3322257995605
                        ],
                        [
                            23423623423,
                            854.5232353210449
                        ],
                        [
                            23760111798,
                            893.6050453186035
                        ],
                        [
                            23857199540,
                            943.1124610900879
                        ],
                        [
                            24151708463,
                            1228.8828010559082
                        ],
                        [
                            25075379343,
                            1256.075740814209
                        ],
                        [
                            25108444589,
                            1128.8155479431152
                        ],
                        [
                            25362882805,
                            862.136531829834
                        ],
                        [
                            25564044724,
                            917.8112144470215
                        ],
                        [
                            25695851863,
                            970.5545539855957
                        ],
                        [
                            26132796605,
                            1159.7846870422363
                        ],
                        [
                            26439656409,
                            874.6234931945801
                        ],
                        [
                            27151944718,
                            1330.9450187683105
                        ],
                        [
                            27151965439,
                            1224.2469520568848
                        ],
                        [
                            29562471870,
                            865.9273109436035
                        ],
                        [
                            30268148451,
                            932.2395973205566
                        ],
                        [
                            31823069217,
                            1079.1938514709473
                        ],
                        [
                            32021356073,
                            1362.7029991149902
                        ],
                        [
                            32783216331,
                            1269.8309135437012
                        ],
                        [
                            33009114921,
                            1367.0395011901855
                        ],
                        [
                            34186997464,
                            1609.8819541931152
                        ],
                        [
                            35376842256,
                            1173.204433441162
                        ],
                        [
                            35621381812,
                            1104.2379035949707
                        ],
                        [
                            35776116151,
                            1187.232006072998
                        ],
                        [
                            36177611319,
                            1363.0369453430176
                        ],
                        [
                            36544256677,
                            1692.0553703308105
                        ],
                        [
                            39303733027,
                            620.713794708252
                        ],
                        [
                            39723800950,
                            808.5117073059082
                        ],
                        [
                            40443540501,
                            1175.8982887268066
                        ],
                        [
                            40778990623,
                            1352.1726341247559
                        ],
                        [
                            41048591002,
                            1493.192714691162
                        ],
                        [
                            42462053746,
                            1699.1769905090332
                        ],
                        [
                            45525579454,
                            1736.814250946045
                        ],
                        [
                            46608470816,
                            762.758487701416
                        ],
                        [
                            48213787187,
                            629.9041175842285
                        ],
                        [
                            48337325569,
                            506.46699142456055
                        ],
                        [
                            48598389948,
                            643.1728553771973
                        ],
                        [
                            49405246093,
                            668.897029876709
                        ],
                        [
                            49839508140,
                            682.9874000549316
                        ],
                        [
                            49848340070,
                            701.5955009460449
                        ],
                        [
                            51078420664,
                            727.0266532897949
                        ],
                        [
                            52088540002,
                            757.8479118347168
                        ],
                        [
                            52596823575,
                            773.6945610046387
                        ],
                        [
                            53184545289,
                            743.4118995666504
                        ],
                        [
                            54867862602,
                            827.3369026184082
                        ],
                        [
                            56058484613,
                            731.8180656433105
                        ],
                        [
                            56082391905,
                            757.8677024841309
                        ],
                        [
                            56082418934,
                            654.5044975280762
                        ],
                        [
                            56690711992,
                            988.579044342041
                        ],
                        [
                            56690729412,
                            912.7249717712402
                        ],
                        [
                            57341278341,
                            777.925594329834
                        ],
                        [
                            58719980395,
                            952.4447898864746
                        ],
                        [
                            58923923306,
                            859.3454322814941
                        ],
                        [
                            59257108245,
                            638.6468162536621
                        ],
                        [
                            59444598555,
                            849.3355751037598
                        ],
                        [
                            59885342345,
                            988.0359382629395
                        ],
                        [
                            59964982412,
                            1136.4895973205566
                        ],
                        [
                            61321197295,
                            1073.0522270202637
                        ],
                        [
                            62217263442,
                            1293.9156074523926
                        ],
                        [
                            62248998426,
                            1185.3749732971191
                        ],
                        [
                            63052803865,
                            925.9113426208496
                        ],
                        [
                            63823967857,
                            1254.4112129211426
                        ],
                        [
                            64710594038,
                            1061.609287261963
                        ],
                        [
                            66294338206,
                            1081.8168601989746
                        ],
                        [
                            66332715056,
                            1021.3868522644043
                        ],
                        [
                            66969429030,
                            1185.804027557373
                        ],
                        [
                            67203447526,
                            1456.282382965088
                        ],
                        [
                            68561354853,
                            1133.6430931091309
                        ],
                        [
                            70143344400,
                            1610.2216835021973
                        ],
                        [
                            70143381705,
                            1399.2805976867676
                        ],
                        [
                            70736742379,
                            819.3429222106934
                        ],
                        [
                            71157787987,
                            1222.1826515197754
                        ],
                        [
                            72233806318,
                            1509.332706451416
                        ],
                        [
                            73311725371,
                            1321.715145111084
                        ],
                        [
                            73356810851,
                            1147.7720756530762
                        ],
                        [
                            73807493187,
                            1228.4284019470215
                        ],
                        [
                            74186908686,
                            1670.193286895752
                        ],
                        [
                            75042400203,
                            975.5559577941895
                        ],
                        [
                            75475218515,
                            1396.6570320129395
                        ],
                        [
                            75475239354,
                            1223.3498344421387
                        ],
                        [
                            76760969161,
                            1920.529941558838
                        ]
                    ],
                    "n_avg_mb": 343.495078086853,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3081757802220179,
                    "n_cpu_percent_c": 9.600934449303711,
                    "n_cpu_percent_python": 1.1253283211443283,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 15628.210331916809,
                    "n_mallocs": 1,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 8.214567541450211e-05,
                    "n_sys_percent": 0.0011333992020200214,
                    "n_usage_fraction": 0.09765664872453532
                },
                {
                    "line": "Delphi.generate",
                    "lineno": 394,
                    "memory_samples": [
                        [
                            5589892478,
                            257.77135848999023
                        ],
                        [
                            6561577425,
                            316.1542720794678
                        ],
                        [
                            8565429996,
                            566.4226226806641
                        ],
                        [
                            8931363348,
                            600.4464769363403
                        ],
                        [
                            8931375449,
                            557.3186082839966
                        ],
                        [
                            9246520760,
                            438.61041259765625
                        ],
                        [
                            9640983695,
                            442.06556224823
                        ],
                        [
                            10048683430,
                            593.3020582199097
                        ],
                        [
                            10048696798,
                            581.3482160568237
                        ],
                        [
                            10530192771,
                            604.0635709762573
                        ],
                        [
                            10545181921,
                            449.40542125701904
                        ],
                        [
                            11029900551,
                            453.28917026519775
                        ],
                        [
                            11507909500,
                            655.254846572876
                        ],
                        [
                            11523140911,
                            457.30722999572754
                        ],
                        [
                            13531645473,
                            474.8125009536743
                        ],
                        [
                            14078169979,
                            741.1810503005981
                        ],
                        [
                            14078176540,
                            693.3663988113403
                        ],
                        [
                            15304219142,
                            560.104323387146
                        ],
                        [
                            16607662917,
                            899.0721778869629
                        ],
                        [
                            16607665517,
                            885.531681060791
                        ],
                        [
                            24215095340,
                            768.0836143493652
                        ],
                        [
                            26135748378,
                            1121.3870887756348
                        ],
                        [
                            27186955316,
                            789.0607643127441
                        ],
                        [
                            29191644642,
                            689.1894111633301
                        ],
                        [
                            33184995514,
                            961.0869636535645
                        ],
                        [
                            34274299677,
                            969.2456092834473
                        ],
                        [
                            36588451674,
                            1023.0583152770996
                        ],
                        [
                            41202293266,
                            1541.875774383545
                        ],
                        [
                            42466448599,
                            1613.4747047424316
                        ],
                        [
                            44348511326,
                            1662.752758026123
                        ],
                        [
                            44348520066,
                            1641.4577522277832
                        ],
                        [
                            44645866005,
                            1690.8514671325684
                        ],
                        [
                            44645870941,
                            1670.0973472595215
                        ],
                        [
                            44994331463,
                            1709.532627105713
                        ],
                        [
                            44994339881,
                            1664.160243988037
                        ],
                        [
                            45319886944,
                            1720.4177055358887
                        ],
                        [
                            45757181492,
                            1697.8989601135254
                        ],
                        [
                            46012598031,
                            1706.4881782531738
                        ],
                        [
                            46928924580,
                            514.8262138366699
                        ],
                        [
                            47254253306,
                            592.487621307373
                        ],
                        [
                            47254260406,
                            570.9236869812012
                        ],
                        [
                            47863050278,
                            558.3711891174316
                        ],
                        [
                            47876934758,
                            469.188663482666
                        ],
                        [
                            48229183320,
                            585.001033782959
                        ],
                        [
                            48239893553,
                            543.048999786377
                        ],
                        [
                            48239895948,
                            532.792537689209
                        ],
                        [
                            48239900123,
                            474.19462966918945
                        ],
                        [
                            48614429386,
                            647.1716957092285
                        ],
                        [
                            49436503926,
                            561.5952949523926
                        ],
                        [
                            49856344852,
                            632.9217414855957
                        ],
                        [
                            49856346874,
                            620.6163368225098
                        ],
                        [
                            49870402535,
                            575.1574821472168
                        ],
                        [
                            49870404362,
                            564.9599723815918
                        ],
                        [
                            50626049789,
                            703.6390419006348
                        ],
                        [
                            50626051818,
                            688.6383247375488
                        ],
                        [
                            50626053503,
                            673.6376075744629
                        ],
                        [
                            50641471438,
                            607.461742401123
                        ],
                        [
                            50641474841,
                            596.561107635498
                        ],
                        [
                            51115411023,
                            596.4363441467285
                        ],
                        [
                            51115413057,
                            585.1841468811035
                        ],
                        [
                            51115415065,
                            513.183650970459
                        ],
                        [
                            51590770682,
                            595.8853645324707
                        ],
                        [
                            52126487659,
                            642.7336158752441
                        ],
                        [
                            52618133090,
                            764.2170372009277
                        ],
                        [
                            52618144598,
                            697.557918548584
                        ],
                        [
                            52635489688,
                            636.592098236084
                        ],
                        [
                            53790671201,
                            796.2697410583496
                        ],
                        [
                            53790676922,
                            742.8300895690918
                        ],
                        [
                            53809678929,
                            682.7060813903809
                        ],
                        [
                            54424337844,
                            684.8551597595215
                        ],
                        [
                            58079377122,
                            759.5140953063965
                        ],
                        [
                            58079382997,
                            729.2753257751465
                        ],
                        [
                            58079384791,
                            719.1957359313965
                        ],
                        [
                            58079388532,
                            579.043155670166
                        ],
                        [
                            60731691080,
                            998.0196571350098
                        ],
                        [
                            63897340433,
                            919.9648933410645
                        ],
                        [
                            63897346196,
                            896.0557136535645
                        ],
                        [
                            63897348768,
                            884.1011238098145
                        ],
                        [
                            65668880635,
                            1008.7368965148926
                        ],
                        [
                            65668887818,
                            983.8902168273926
                        ],
                        [
                            65668893546,
                            959.0435371398926
                        ],
                        [
                            65668896153,
                            946.6201972961426
                        ],
                        [
                            65668899067,
                            748.9876365661621
                        ],
                        [
                            65668902058,
                            716.1163902282715
                        ],
                        [
                            67206920853,
                            1255.2452278137207
                        ],
                        [
                            68211946463,
                            1241.7404747009277
                        ],
                        [
                            69150070608,
                            1367.9853172302246
                        ],
                        [
                            70198505109,
                            1299.312831878662
                        ],
                        [
                            70198510835,
                            1278.568447113037
                        ],
                        [
                            70198517235,
                            1257.824062347412
                        ],
                        [
                            72290077580,
                            1102.8142433166504
                        ],
                        [
                            72290079333,
                            1092.2662773132324
                        ],
                        [
                            74297528155,
                            1118.8372077941895
                        ],
                        [
                            74297554429,
                            1097.0381355285645
                        ],
                        [
                            74297561647,
                            1086.1385917663574
                        ],
                        [
                            74297567283,
                            766.3753929138184
                        ],
                        [
                            76831226431,
                            1239.4089469909668
                        ],
                        [
                            76831229278,
                            1228.1578559875488
                        ],
                        [
                            76831239583,
                            1171.9023551940918
                        ],
                        [
                            76831241671,
                            1160.6512641906738
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.8483631807743375,
                    "n_core_utilization": 0.34898039502520595,
                    "n_cpu_percent_c": 3.714637058813574,
                    "n_cpu_percent_python": 0.41149164342067157,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.480225563049316,
                    "n_malloc_mb": 10.480225563049316,
                    "n_mallocs": 0,
                    "n_peak_mb": 10.480225563049316,
                    "n_python_fraction": 0.000975,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 6.548822191587909e-05
                }
            ],
            "imports": [
                "import math",
                "import inspect",
                "from dataclasses import dataclass, field",
                "import torch",
                "import time"
            ],
            "leaks": {},
            "lines": [
                {
                    "end_outermost_loop": 1,
                    "end_region_line": 1,
                    "line": "\"\"\"\n",
                    "lineno": 1,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 1,
                    "start_region_line": 1
                },
                {
                    "end_outermost_loop": 2,
                    "end_region_line": 2,
                    "line": "Full definition of a GPT Language Model, all of it in this single file.\n",
                    "lineno": 2,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 2,
                    "start_region_line": 2
                },
                {
                    "end_outermost_loop": 3,
                    "end_region_line": 3,
                    "line": "References:\n",
                    "lineno": 3,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 3,
                    "start_region_line": 3
                },
                {
                    "end_outermost_loop": 4,
                    "end_region_line": 4,
                    "line": "1) the official GPT-2 TensorFlow implementation released by OpenAI:\n",
                    "lineno": 4,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 4,
                    "start_region_line": 4
                },
                {
                    "end_outermost_loop": 5,
                    "end_region_line": 5,
                    "line": "https://github.com/openai/gpt-2/blob/master/src/model.py\n",
                    "lineno": 5,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 5,
                    "start_region_line": 5
                },
                {
                    "end_outermost_loop": 6,
                    "end_region_line": 6,
                    "line": "2) huggingface/transformers PyTorch implementation:\n",
                    "lineno": 6,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 6,
                    "start_region_line": 6
                },
                {
                    "end_outermost_loop": 7,
                    "end_region_line": 7,
                    "line": "https://github.com/huggingface/transformers/blob/main/src/transformers/models/gpt2/modeling_gpt2.py\n",
                    "lineno": 7,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 7,
                    "start_region_line": 7
                },
                {
                    "end_outermost_loop": 8,
                    "end_region_line": 8,
                    "line": "\"\"\"\n",
                    "lineno": 8,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 8,
                    "start_region_line": 8
                },
                {
                    "end_outermost_loop": 9,
                    "end_region_line": 9,
                    "line": "\n",
                    "lineno": 9,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 10,
                    "end_region_line": 10,
                    "line": "import math\n",
                    "lineno": 10,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 10,
                    "start_region_line": 10
                },
                {
                    "end_outermost_loop": 11,
                    "end_region_line": 11,
                    "line": "import inspect\n",
                    "lineno": 11,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 11,
                    "start_region_line": 11
                },
                {
                    "end_outermost_loop": 12,
                    "end_region_line": 12,
                    "line": "from dataclasses import dataclass, field\n",
                    "lineno": 12,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 12,
                    "start_region_line": 12
                },
                {
                    "end_outermost_loop": 13,
                    "end_region_line": 13,
                    "line": "\n",
                    "lineno": 13,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 13,
                    "start_region_line": 13
                },
                {
                    "end_outermost_loop": 14,
                    "end_region_line": 14,
                    "line": "import torch\n",
                    "lineno": 14,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 14,
                    "start_region_line": 14
                },
                {
                    "end_outermost_loop": 15,
                    "end_region_line": 15,
                    "line": "import torch.nn as nn\n",
                    "lineno": 15,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 15,
                    "start_region_line": 15
                },
                {
                    "end_outermost_loop": 16,
                    "end_region_line": 16,
                    "line": "from torch.nn import functional as F\n",
                    "lineno": 16,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 16,
                    "start_region_line": 16
                },
                {
                    "end_outermost_loop": 17,
                    "end_region_line": 17,
                    "line": "import time\n",
                    "lineno": 17,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 17,
                    "start_region_line": 17
                },
                {
                    "end_outermost_loop": 18,
                    "end_region_line": 18,
                    "line": "\n",
                    "lineno": 18,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 18,
                    "start_region_line": 18
                },
                {
                    "end_outermost_loop": 19,
                    "end_region_line": 19,
                    "line": "# @torch.jit.script # good to enable when not using torch.compile, disable when using (our default)\n",
                    "lineno": 19,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 19,
                    "start_region_line": 19
                },
                {
                    "end_outermost_loop": 25,
                    "end_region_line": 25,
                    "line": "def new_gelu(x):\n",
                    "lineno": 20,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.45349682805824443,
                    "n_cpu_percent_c": 0.018420054130345986,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 20,
                    "start_region_line": 20
                },
                {
                    "end_outermost_loop": 21,
                    "end_region_line": 25,
                    "line": "    \"\"\"\n",
                    "lineno": 21,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 21,
                    "start_region_line": 20
                },
                {
                    "end_outermost_loop": 22,
                    "end_region_line": 25,
                    "line": "    Implementation of the GELU activation function currently in Google BERT repo (identical to OpenAI GPT).\n",
                    "lineno": 22,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 22,
                    "start_region_line": 20
                },
                {
                    "end_outermost_loop": 23,
                    "end_region_line": 25,
                    "line": "    Reference: Gaussian Error Linear Units (GELU) paper: https://arxiv.org/abs/1606.08415\n",
                    "lineno": 23,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 23,
                    "start_region_line": 20
                },
                {
                    "end_outermost_loop": 24,
                    "end_region_line": 25,
                    "line": "    \"\"\"\n",
                    "lineno": 24,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 24,
                    "start_region_line": 20
                },
                {
                    "end_outermost_loop": 25,
                    "end_region_line": 25,
                    "line": "    return 0.5 * x * (1.0 + torch.tanh(math.sqrt(2.0 / math.pi) * (x + 0.044715 * torch.pow(x, 3.0))))\n",
                    "lineno": 25,
                    "memory_samples": [
                        [
                            5677781570,
                            293.937481880188
                        ],
                        [
                            6610363791,
                            350.50294399261475
                        ],
                        [
                            7758650327,
                            405.8331298828125
                        ],
                        [
                            10213177118,
                            528.2224378585815
                        ],
                        [
                            14319149829,
                            598.0300064086914
                        ],
                        [
                            15789078795,
                            780.5413017272949
                        ],
                        [
                            19368270323,
                            710.4283790588379
                        ],
                        [
                            21124893316,
                            795.9004859924316
                        ],
                        [
                            22134344329,
                            862.7464408874512
                        ],
                        [
                            22966521932,
                            865.5912590026855
                        ],
                        [
                            23152897338,
                            921.7861671447754
                        ],
                        [
                            23753587344,
                            939.7395973205566
                        ],
                        [
                            24349425896,
                            875.9091987609863
                        ],
                        [
                            24682813561,
                            1006.5754280090332
                        ],
                        [
                            25220272510,
                            869.2153816223145
                        ],
                        [
                            25220277910,
                            869.215991973877
                        ],
                        [
                            25537615694,
                            954.1951026916504
                        ],
                        [
                            25817634431,
                            1086.0489540100098
                        ],
                        [
                            26855137762,
                            1098.190341949463
                        ],
                        [
                            26855151336,
                            1098.1897315979004
                        ],
                        [
                            27268513707,
                            886.9272880554199
                        ],
                        [
                            27686829870,
                            1057.7211418151855
                        ],
                        [
                            27835523539,
                            1097.9498176574707
                        ],
                        [
                            28625318773,
                            1097.6247673034668
                        ],
                        [
                            29278870177,
                            807.6982765197754
                        ],
                        [
                            31385343981,
                            914.4509010314941
                        ],
                        [
                            31513777219,
                            977.461009979248
                        ],
                        [
                            31732582163,
                            1108.7286262512207
                        ],
                        [
                            31815787588,
                            1125.1407661437988
                        ],
                        [
                            32171261474,
                            1076.3524208068848
                        ],
                        [
                            32701335398,
                            1311.9596977233887
                        ],
                        [
                            34026152685,
                            1418.9963493347168
                        ],
                        [
                            34100810623,
                            1432.594295501709
                        ],
                        [
                            34368821968,
                            1085.4910774230957
                        ],
                        [
                            34645927914,
                            716.3827476501465
                        ],
                        [
                            34716905011,
                            738.0516624450684
                        ],
                        [
                            34803141327,
                            774.9162101745605
                        ],
                        [
                            35607327958,
                            1173.1602668762207
                        ],
                        [
                            36066737628,
                            1376.3990898132324
                        ],
                        [
                            36243804310,
                            1481.8778190612793
                        ],
                        [
                            36930826064,
                            685.5786933898926
                        ],
                        [
                            37201523082,
                            829.9999351501465
                        ],
                        [
                            37541411523,
                            974.4262275695801
                        ],
                        [
                            38709709001,
                            1435.2209663391113
                        ],
                        [
                            38781005679,
                            1468.647029876709
                        ],
                        [
                            39528039041,
                            769.8381538391113
                        ],
                        [
                            39781504125,
                            913.7504768371582
                        ],
                        [
                            40967449663,
                            1558.4698600769043
                        ],
                        [
                            41526459158,
                            1281.768756866455
                        ],
                        [
                            42132254374,
                            1536.9973945617676
                        ],
                        [
                            42719237924,
                            1262.550380706787
                        ],
                        [
                            43433564796,
                            1590.1408424377441
                        ],
                        [
                            43927720568,
                            1645.4578742980957
                        ],
                        [
                            46403434555,
                            1731.6772270202637
                        ],
                        [
                            46667138347,
                            455.6971855163574
                        ],
                        [
                            49120208164,
                            536.6811866760254
                        ],
                        [
                            49691725496,
                            596.848575592041
                        ],
                        [
                            50068764934,
                            598.9158363342285
                        ],
                        [
                            50791400903,
                            578.8989601135254
                        ],
                        [
                            50852684234,
                            617.5757026672363
                        ],
                        [
                            51458590301,
                            659.0161170959473
                        ],
                        [
                            51853592472,
                            632.7424201965332
                        ],
                        [
                            52884578858,
                            656.7190437316895
                        ],
                        [
                            53374638028,
                            622.3536720275879
                        ],
                        [
                            53716534854,
                            729.2457618713379
                        ],
                        [
                            54665891053,
                            715.8065528869629
                        ],
                        [
                            57078911304,
                            595.4077110290527
                        ],
                        [
                            57290267910,
                            680.498477935791
                        ],
                        [
                            57809137650,
                            847.0808601379395
                        ],
                        [
                            58189409602,
                            678.573902130127
                        ],
                        [
                            58916431386,
                            902.586727142334
                        ],
                        [
                            59097995920,
                            632.8519706726074
                        ],
                        [
                            59845272368,
                            1010.5356483459473
                        ],
                        [
                            59878926097,
                            1032.476474761963
                        ],
                        [
                            60354360343,
                            1031.9079093933105
                        ],
                        [
                            60507632445,
                            1082.7417182922363
                        ],
                        [
                            60558702405,
                            1097.0998039245605
                        ],
                        [
                            60846243564,
                            944.1208610534668
                        ],
                        [
                            61054523414,
                            1014.445728302002
                        ],
                        [
                            61830136823,
                            1031.818515777588
                        ],
                        [
                            62105256030,
                            1134.938564300537
                        ],
                        [
                            62331076177,
                            921.2049217224121
                        ],
                        [
                            62838637539,
                            787.630298614502
                        ],
                        [
                            63400483809,
                            1069.225284576416
                        ],
                        [
                            63452828129,
                            1088.7942237854004
                        ],
                        [
                            63509339781,
                            1098.731243133545
                        ],
                        [
                            63690885076,
                            1094.498622894287
                        ],
                        [
                            64325187372,
                            903.2401847839355
                        ],
                        [
                            65388334718,
                            1183.3862342834473
                        ],
                        [
                            68017859190,
                            1401.990032196045
                        ],
                        [
                            68952417085,
                            1352.5074653625488
                        ],
                        [
                            69527043714,
                            1200.3370323181152
                        ],
                        [
                            71432568517,
                            1219.9839363098145
                        ],
                        [
                            72375288270,
                            903.1582221984863
                        ],
                        [
                            72901179008,
                            982.8657417297363
                        ],
                        [
                            73130813082,
                            1086.5796012878418
                        ],
                        [
                            73854119366,
                            1320.690357208252
                        ],
                        [
                            73971594039,
                            1406.9544105529785
                        ],
                        [
                            74685272764,
                            936.6988716125488
                        ],
                        [
                            75770614211,
                            1383.44144821167
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4068576558955279,
                    "n_cpu_percent_c": 20.45650024767594,
                    "n_cpu_percent_python": 4.048093004933201,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 88394.10130882263,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.000360355655772794,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.5523519019453794,
                    "start_outermost_loop": 25,
                    "start_region_line": 20
                },
                {
                    "end_outermost_loop": 26,
                    "end_region_line": 26,
                    "line": "\n",
                    "lineno": 26,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 26,
                    "start_region_line": 26
                },
                {
                    "end_outermost_loop": 36,
                    "end_region_line": 36,
                    "line": "class LayerNorm(nn.Module):\n",
                    "lineno": 27,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 27,
                    "start_region_line": 27
                },
                {
                    "end_outermost_loop": 28,
                    "end_region_line": 36,
                    "line": "    \"\"\" LayerNorm but with an optional bias. PyTorch doesn't support simply bias=False \"\"\"\n",
                    "lineno": 28,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 28,
                    "start_region_line": 27
                },
                {
                    "end_outermost_loop": 29,
                    "end_region_line": 36,
                    "line": "\n",
                    "lineno": 29,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 29,
                    "start_region_line": 27
                },
                {
                    "end_outermost_loop": 33,
                    "end_region_line": 33,
                    "line": "    def __init__(self, ndim, bias):\n",
                    "lineno": 30,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 30,
                    "start_region_line": 30
                },
                {
                    "end_outermost_loop": 31,
                    "end_region_line": 33,
                    "line": "        super().__init__()\n",
                    "lineno": 31,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 30
                },
                {
                    "end_outermost_loop": 32,
                    "end_region_line": 33,
                    "line": "        self.weight = nn.Parameter(torch.ones(ndim))\n",
                    "lineno": 32,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 32,
                    "start_region_line": 30
                },
                {
                    "end_outermost_loop": 33,
                    "end_region_line": 33,
                    "line": "        self.bias = nn.Parameter(torch.zeros(ndim)) if bias else None\n",
                    "lineno": 33,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 33,
                    "start_region_line": 30
                },
                {
                    "end_outermost_loop": 34,
                    "end_region_line": 36,
                    "line": "\n",
                    "lineno": 34,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 34,
                    "start_region_line": 27
                },
                {
                    "end_outermost_loop": 36,
                    "end_region_line": 36,
                    "line": "    def forward(self, input):\n",
                    "lineno": 35,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 35,
                    "start_region_line": 35
                },
                {
                    "end_outermost_loop": 36,
                    "end_region_line": 36,
                    "line": "        return F.layer_norm(input, self.weight.shape, self.weight, self.bias, 1e-5)\n",
                    "lineno": 36,
                    "memory_samples": [
                        [
                            16924975416,
                            795.690486907959
                        ],
                        [
                            28037017803,
                            1110.6903343200684
                        ],
                        [
                            28745030699,
                            1098.2871437072754
                        ],
                        [
                            30029081203,
                            1045.3704948425293
                        ],
                        [
                            30315249679,
                            937.7252311706543
                        ],
                        [
                            30470790035,
                            804.7580986022949
                        ],
                        [
                            40028838915,
                            995.1458015441895
                        ],
                        [
                            56902622124,
                            770.3738746643066
                        ],
                        [
                            57468198257,
                            680.3074226379395
                        ],
                        [
                            57522357208,
                            703.0722846984863
                        ],
                        [
                            59005856416,
                            864.6336250305176
                        ],
                        [
                            62497428456,
                            906.5780906677246
                        ],
                        [
                            63668745559,
                            1079.0201683044434
                        ],
                        [
                            64427513622,
                            887.3613624572754
                        ],
                        [
                            64806813223,
                            899.8041343688965
                        ],
                        [
                            64938251469,
                            939.6995735168457
                        ],
                        [
                            70473786436,
                            1114.656650543213
                        ],
                        [
                            75297845702,
                            1087.8421821594238
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.41573021801607274,
                    "n_cpu_percent_c": 0.47600299485351616,
                    "n_cpu_percent_python": 0.13033726070411342,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 206.9514446258545,
                    "n_malloc_mb": 206.9514446258545,
                    "n_mallocs": 0,
                    "n_peak_mb": 206.9514446258545,
                    "n_python_fraction": 0.0006267271590098037,
                    "n_sys_percent": 0.015396536577016008,
                    "n_usage_fraction": 0.0012931861103499369,
                    "start_outermost_loop": 36,
                    "start_region_line": 35
                },
                {
                    "end_outermost_loop": 37,
                    "end_region_line": 37,
                    "line": "\n",
                    "lineno": 37,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 37,
                    "start_region_line": 37
                },
                {
                    "end_outermost_loop": 104,
                    "end_region_line": 104,
                    "line": "class CausalSelfAttention(nn.Module):\n",
                    "lineno": 38,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 38,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 39,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 39,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 39,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "    def __init__(self, config):\n",
                    "lineno": 40,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 40,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 41,
                    "end_region_line": 59,
                    "line": "        super().__init__()\n",
                    "lineno": 41,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 41,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 42,
                    "end_region_line": 59,
                    "line": "        assert config.n_embd % config.n_head == 0\n",
                    "lineno": 42,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 42,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "        # key, query, value projections for all heads, but in a batch\n",
                    "lineno": 43,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 40,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 44,
                    "end_region_line": 59,
                    "line": "        self.c_attn = nn.Linear(config.n_embd, 3 * config.n_embd, bias=config.bias)\n",
                    "lineno": 44,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.26129822595964464,
                    "n_cpu_percent_c": 0.006257838300328194,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 44,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "        # output projection\n",
                    "lineno": 45,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 40,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 46,
                    "end_region_line": 59,
                    "line": "        self.c_proj = nn.Linear(config.n_embd, config.n_embd, bias=config.bias)\n",
                    "lineno": 46,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 46,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "        # regularization\n",
                    "lineno": 47,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 40,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 48,
                    "end_region_line": 59,
                    "line": "        self.attn_dropout = nn.Dropout(config.dropout)\n",
                    "lineno": 48,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 48,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 49,
                    "end_region_line": 59,
                    "line": "        self.resid_dropout = nn.Dropout(config.dropout)\n",
                    "lineno": 49,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 49,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 50,
                    "end_region_line": 59,
                    "line": "        self.n_head = config.n_head\n",
                    "lineno": 50,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 51,
                    "end_region_line": 59,
                    "line": "        self.n_embd = config.n_embd\n",
                    "lineno": 51,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 51,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 52,
                    "end_region_line": 59,
                    "line": "        self.dropout = config.dropout\n",
                    "lineno": 52,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 52,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "        # flash attention make GPU go brrrrr but support is only in PyTorch nightly and still a bit scary\n",
                    "lineno": 53,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 40,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 54,
                    "end_region_line": 59,
                    "line": "        self.flash = False #hasattr(torch.nn.functional, 'scaled_dot_product_attention') and self.dropout == 0.0\n",
                    "lineno": 54,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 54,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "        if not self.flash:\n",
                    "lineno": 55,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 55,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 56,
                    "end_region_line": 59,
                    "line": "            print(\"WARNING: using slow attention. Flash Attention atm needs PyTorch nightly and dropout=0.0\")\n",
                    "lineno": 56,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 56,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "            # causal mask to ensure that attention is only applied to the left in the input sequence\n",
                    "lineno": 57,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 55,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 58,
                    "end_region_line": 59,
                    "line": "            self.register_buffer(\"bias\", torch.tril(torch.ones(config.block_size, config.block_size))\n",
                    "lineno": 58,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 58,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 59,
                    "line": "                                        .view(1, 1, config.block_size, config.block_size))\n",
                    "lineno": 59,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 59,
                    "start_region_line": 40
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 60,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 60,
                    "start_region_line": 38
                },
                {
                    "end_outermost_loop": 104,
                    "end_region_line": 104,
                    "line": "    def forward(self, x, attn_mask, kvcache=None):\n",
                    "lineno": 61,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4748518570354222,
                    "n_cpu_percent_c": 0.011091282450346839,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 61,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 62,
                    "end_region_line": 104,
                    "line": "        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)\n",
                    "lineno": 62,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 62,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 63,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 63,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 63,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 104,
                    "end_region_line": 104,
                    "line": "        # calculate query, key, values for all heads in batch and move head forward to be the batch dim\n",
                    "lineno": 64,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 61,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 65,
                    "end_region_line": 104,
                    "line": "        q, k ,v  = self.c_attn(x).split(self.n_embd, dim=2)\n",
                    "lineno": 65,
                    "memory_samples": [
                        [
                            8213683527,
                            436.5148916244507
                        ],
                        [
                            9256492565,
                            448.88987731933594
                        ],
                        [
                            10074859881,
                            456.43210887908936
                        ],
                        [
                            10556881737,
                            460.41560649871826
                        ],
                        [
                            11532545213,
                            470.44542121887207
                        ],
                        [
                            14724318594,
                            499.00376892089844
                        ],
                        [
                            15039559664,
                            459.02102279663086
                        ],
                        [
                            15317356862,
                            578.0169973373413
                        ],
                        [
                            15975493992,
                            671.7539100646973
                        ],
                        [
                            16643972352,
                            677.2858772277832
                        ],
                        [
                            18002510664,
                            679.5884895324707
                        ],
                        [
                            19769808214,
                            820.0621070861816
                        ],
                        [
                            20230063183,
                            702.285083770752
                        ],
                        [
                            20339879762,
                            745.6048851013184
                        ],
                        [
                            20453609033,
                            788.9251747131348
                        ],
                        [
                            20562539383,
                            832.2456092834473
                        ],
                        [
                            21371181472,
                            844.7001152038574
                        ],
                        [
                            21488681561,
                            889.5368614196777
                        ],
                        [
                            21976171865,
                            764.625789642334
                        ],
                        [
                            22213806385,
                            857.3603401184082
                        ],
                        [
                            22978817216,
                            822.352222442627
                        ],
                        [
                            23540422645,
                            805.839672088623
                        ],
                        [
                            23811792065,
                            932.4230003356934
                        ],
                        [
                            23860072413,
                            954.3640937805176
                        ],
                        [
                            23955505911,
                            1003.8721809387207
                        ],
                        [
                            24233955486,
                            790.5730857849121
                        ],
                        [
                            24437706684,
                            868.7112617492676
                        ],
                        [
                            24567721281,
                            919.8284721374512
                        ],
                        [
                            24697211320,
                            970.9460487365723
                        ],
                        [
                            24834748790,
                            1022.0639839172363
                        ],
                        [
                            24963174826,
                            1073.181552886963
                        ],
                        [
                            25365372101,
                            876.7874336242676
                        ],
                        [
                            25698534117,
                            982.274600982666
                        ],
                        [
                            25962934014,
                            1090.69047164917
                        ],
                        [
                            26290132348,
                            832.1785163879395
                        ],
                        [
                            26655085725,
                            968.1770057678223
                        ],
                        [
                            27701846150,
                            1008.3620719909668
                        ],
                        [
                            27852279755,
                            1064.434368133545
                        ],
                        [
                            27923061915,
                            1092.4704627990723
                        ],
                        [
                            28196199880,
                            859.0558815002441
                        ],
                        [
                            28348561816,
                            923.6760902404785
                        ],
                        [
                            28705373797,
                            1071.5353736877441
                        ],
                        [
                            29425933648,
                            822.2553749084473
                        ],
                        [
                            29777593961,
                            967.8254280090332
                        ],
                        [
                            29918054366,
                            1027.3193550109863
                        ],
                        [
                            30270906095,
                            952.5501747131348
                        ],
                        [
                            30431482902,
                            790.1942329406738
                        ],
                        [
                            30646854681,
                            889.6064872741699
                        ],
                        [
                            30715622032,
                            927.6466255187988
                        ],
                        [
                            30786223872,
                            959.2413063049316
                        ],
                        [
                            31413705095,
                            875.0693626403809
                        ],
                        [
                            31470639385,
                            903.2924613952637
                        ],
                        [
                            32189225021,
                            1015.2314109802246
                        ],
                        [
                            32486428642,
                            1153.578311920166
                        ],
                        [
                            32561666492,
                            1185.9814796447754
                        ],
                        [
                            32634882698,
                            1218.3845176696777
                        ],
                        [
                            32862204093,
                            1315.594181060791
                        ],
                        [
                            32936983648,
                            1347.9971809387207
                        ],
                        [
                            33358793598,
                            1057.2514533996582
                        ],
                        [
                            33509389493,
                            1123.870403289795
                        ],
                        [
                            33583016968,
                            1157.1797065734863
                        ],
                        [
                            33966028156,
                            1323.7260627746582
                        ],
                        [
                            34293801058,
                            996.2908058166504
                        ],
                        [
                            34732997565,
                            696.9501075744629
                        ],
                        [
                            35443420930,
                            1041.642505645752
                        ],
                        [
                            35624633919,
                            1124.6372261047363
                        ],
                        [
                            35779324202,
                            1201.2952308654785
                        ],
                        [
                            36101491527,
                            1341.9390602111816
                        ],
                        [
                            36180789972,
                            1377.1002922058105
                        ],
                        [
                            37466413352,
                            868.5691032409668
                        ],
                        [
                            37809058306,
                            1005.7459144592285
                        ],
                        [
                            37906703580,
                            1039.173053741455
                        ],
                        [
                            37984235269,
                            1072.599681854248
                        ],
                        [
                            38145469488,
                            1139.452922821045
                        ],
                        [
                            38313046802,
                            1206.306339263916
                        ],
                        [
                            38393596338,
                            1239.7327690124512
                        ],
                        [
                            39013727035,
                            887.4011726379395
                        ],
                        [
                            39223394533,
                            597.452075958252
                        ],
                        [
                            39896788376,
                            899.334300994873
                        ],
                        [
                            40450046593,
                            1187.1492958068848
                        ],
                        [
                            40518075626,
                            1222.4041557312012
                        ],
                        [
                            40585632208,
                            1257.65913772583
                        ],
                        [
                            40719269887,
                            1328.168788909912
                        ],
                        [
                            40987547923,
                            1469.1884880065918
                        ],
                        [
                            41795920378,
                            1338.9151420593262
                        ],
                        [
                            41971920777,
                            1418.9091911315918
                        ],
                        [
                            42059275051,
                            1458.9063911437988
                        ],
                        [
                            42237020333,
                            1538.9085426330566
                        ],
                        [
                            42645440639,
                            1156.9715614318848
                        ],
                        [
                            42736353512,
                            1197.9686698913574
                        ],
                        [
                            43095367369,
                            1361.9567680358887
                        ],
                        [
                            43544201870,
                            1566.9421348571777
                        ],
                        [
                            75788761282,
                            1299.9027824401855
                        ],
                        [
                            75877245056,
                            1340.899730682373
                        ],
                        [
                            75970291296,
                            1381.896572113037
                        ],
                        [
                            76060460199,
                            1422.893497467041
                        ],
                        [
                            76150827346,
                            1463.8905601501465
                        ],
                        [
                            76241098441,
                            1504.8873252868652
                        ],
                        [
                            76330247707,
                            1545.8844718933105
                        ],
                        [
                            76418681832,
                            1586.8814506530762
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.8936342466608079,
                    "n_core_utilization": 0.42245400962047536,
                    "n_cpu_percent_c": 0.6022623346308252,
                    "n_cpu_percent_python": 0.1582660167002583,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 3338.20716381073,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.0031914224157041696,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0208595941212936,
                    "start_outermost_loop": 65,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 66,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 66,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 66,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 70,
                    "end_region_line": 104,
                    "line": "        if kvcache:\n",
                    "lineno": 67,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4856811567019592,
                    "n_cpu_percent_c": 0.010870413431493007,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 67,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 68,
                    "end_region_line": 104,
                    "line": "            prev_k, prev_v = kvcache\n",
                    "lineno": 68,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 68,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 69,
                    "end_region_line": 104,
                    "line": "            k = torch.cat([prev_k, k], dim=1)  # concatenate previous and current key\n",
                    "lineno": 69,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.41467272958802276,
                    "n_cpu_percent_c": 0.053884654854810844,
                    "n_cpu_percent_python": 0.01758511296669536,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 69,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 70,
                    "end_region_line": 104,
                    "line": "            v = torch.cat([prev_v, v], dim=1)  # concatenate previous and current value\n",
                    "lineno": 70,
                    "memory_samples": [
                        [
                            51598354673,
                            529.3958168029785
                        ],
                        [
                            52134624735,
                            535.9685249328613
                        ],
                        [
                            52643908390,
                            542.6863136291504
                        ],
                        [
                            53212994855,
                            549.5524635314941
                        ],
                        [
                            53818276551,
                            556.5553779602051
                        ],
                        [
                            54432904853,
                            563.699405670166
                        ],
                        [
                            54901152339,
                            570.9956245422363
                        ],
                        [
                            55500657494,
                            578.4324684143066
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.40509860184704205,
                    "n_cpu_percent_c": 0.14191256504575608,
                    "n_cpu_percent_python": 0.03868724852672978,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 89.24357604980469,
                    "n_malloc_mb": 89.24357604980469,
                    "n_mallocs": 0,
                    "n_peak_mb": 89.24357604980469,
                    "n_python_fraction": 0.0009546241862461994,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0005576600501350048,
                    "start_outermost_loop": 70,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 71,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 71,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 71,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 72,
                    "end_region_line": 104,
                    "line": "        new_kvcache = [k, v]  # update the key-value cache with the concatenated key and value\n",
                    "lineno": 72,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 72,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 73,
                    "end_region_line": 104,
                    "line": "        curr_T = k.shape[1]  # get the current length of the sequence\n",
                    "lineno": 73,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 73,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 74,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 74,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 74,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 104,
                    "line": "        k = k.view(B, curr_T, self.n_head, C // self.n_head).transpose(1, 2)  # (B, nh, curr_T, hs)\n",
                    "lineno": 75,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4155710508967351,
                    "n_cpu_percent_c": 0.035066473766887665,
                    "n_cpu_percent_python": 0.010551067780017215,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 75,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 104,
                    "line": "        q = q.view(B, T, self.n_head, C // self.n_head).transpose(1, 2)  # (B, nh, T, hs)\n",
                    "lineno": 76,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 76,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 77,
                    "end_region_line": 104,
                    "line": "        v = v.view(B, curr_T, self.n_head, C // self.n_head).transpose(1, 2)  # (B, nh, curr_T, hs)\n",
                    "lineno": 77,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4502509450182109,
                    "n_cpu_percent_c": 0.011646620317842419,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 77,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 78,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 78,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 78,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 104,
                    "end_region_line": 104,
                    "line": "        # causal self-attention; Self-attend: (B, nh, T, hs) x (B, nh, hs, T) -\\u003e (B, nh, T, T)\n",
                    "lineno": 79,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 61,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "        if self.flash:\n",
                    "lineno": 80,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 80,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "            # efficient attention using Flash Attention CUDA kernels\n",
                    "lineno": 81,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 80,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 82,
                    "end_region_line": 104,
                    "line": "            y = torch.nn.functional.scaled_dot_product_attention(q, k, v, attn_mask=None, dropout_p=self.dropout, is_causal=True)\n",
                    "lineno": 82,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 82,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "        elif kvcache:\n",
                    "lineno": 83,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 83,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "            # manual implementation of attention with kv cache -\\u003e so far the same as for attention without kv cache\n",
                    "lineno": 84,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 83,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 85,
                    "end_region_line": 104,
                    "line": "            att = (q @ k.transpose(-2, -1)) * (1.0 / math.sqrt(k.size(-1)))\n",
                    "lineno": 85,
                    "memory_samples": [
                        [
                            49020463798,
                            494.7043876647949
                        ],
                        [
                            49444181495,
                            500.50243759155273
                        ],
                        [
                            49877958198,
                            506.37785720825195
                        ],
                        [
                            50323831488,
                            512.4449882507324
                        ],
                        [
                            50650429637,
                            518.6624794006348
                        ],
                        [
                            51124410212,
                            525.0169639587402
                        ],
                        [
                            64391837319,
                            888.3798713684082
                        ],
                        [
                            65699151751,
                            568.8918266296387
                        ],
                        [
                            65969007678,
                            721.8159294128418
                        ],
                        [
                            66185870561,
                            846.519115447998
                        ],
                        [
                            66350602082,
                            932.2601203918457
                        ],
                        [
                            66419766590,
                            961.3225440979004
                        ],
                        [
                            67250363567,
                            994.4444999694824
                        ],
                        [
                            67316184419,
                            1039.9917106628418
                        ],
                        [
                            68965859465,
                            1308.2458992004395
                        ],
                        [
                            69287078720,
                            1045.971607208252
                        ],
                        [
                            69864344342,
                            1299.1257362365723
                        ],
                        [
                            70215985273,
                            1024.4800910949707
                        ],
                        [
                            70301416171,
                            1057.0118446350098
                        ],
                        [
                            70605221837,
                            768.9147605895996
                        ],
                        [
                            71225568956,
                            1061.8944664001465
                        ],
                        [
                            71304175795,
                            1095.3204612731934
                        ],
                        [
                            72305902338,
                            820.0602607727051
                        ],
                        [
                            72391044494,
                            854.3965492248535
                        ],
                        [
                            72845013424,
                            900.5416297912598
                        ],
                        [
                            73393457847,
                            1012.0304298400879
                        ],
                        [
                            73455849131,
                            1047.2842750549316
                        ],
                        [
                            74315315284,
                            790.9473304748535
                        ],
                        [
                            74398419110,
                            827.1350364685059
                        ],
                        [
                            74700588309,
                            886.374439239502
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4304912990453256,
                    "n_cpu_percent_c": 0.30253217326548654,
                    "n_cpu_percent_python": 0.08440854224013775,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 328.4946746826172,
                    "n_malloc_mb": 328.4946746826172,
                    "n_mallocs": 0,
                    "n_peak_mb": 328.4946746826172,
                    "n_python_fraction": 0.0008619877911944398,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0020526783535697564,
                    "start_outermost_loop": 85,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "            #att = att.masked_fill(self.bias[:,:,:T,:curr_T] == 0, float('-inf'))\n",
                    "lineno": 86,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 83,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 87,
                    "end_region_line": 104,
                    "line": "            att = att.masked_fill(attn_mask.to(att.dtype) == 0, float('-inf'))\n",
                    "lineno": 87,
                    "memory_samples": [
                        [
                            47527595962,
                            475.4111442565918
                        ],
                        [
                            48637667778,
                            492.1636848449707
                        ],
                        [
                            55699063491,
                            499.36459732055664
                        ],
                        [
                            55942978893,
                            593.4244728088379
                        ],
                        [
                            56195238289,
                            711.513126373291
                        ],
                        [
                            56280385326,
                            743.2659034729004
                        ],
                        [
                            56729184040,
                            752.1506233215332
                        ],
                        [
                            56957048472,
                            524.5396385192871
                        ],
                        [
                            57129938587,
                            590.5490303039551
                        ],
                        [
                            57384843728,
                            716.0317802429199
                        ],
                        [
                            57496497304,
                            695.6337928771973
                        ],
                        [
                            57542761953,
                            718.434154510498
                        ],
                        [
                            57588846189,
                            738.2142677307129
                        ],
                        [
                            58153390468,
                            626.6445045471191
                        ],
                        [
                            58339556688,
                            697.8126945495605
                        ],
                        [
                            58386930341,
                            712.908504486084
                        ],
                        [
                            58431205843,
                            733.3960609436035
                        ],
                        [
                            58479104185,
                            748.493335723877
                        ],
                        [
                            58577922979,
                            784.077579498291
                        ],
                        [
                            58630563677,
                            804.5642585754395
                        ],
                        [
                            58927469416,
                            875.9601173400879
                        ],
                        [
                            59598108871,
                            835.9561195373535
                        ],
                        [
                            59630973221,
                            852.271297454834
                        ],
                        [
                            59693490332,
                            890.5273094177246
                        ],
                        [
                            59758383310,
                            928.7840766906738
                        ],
                        [
                            59789807706,
                            950.7239875793457
                        ],
                        [
                            59855024878,
                            988.9800834655762
                        ],
                        [
                            60003402569,
                            856.8041343688965
                        ],
                        [
                            60162304342,
                            919.1701316833496
                        ],
                        [
                            60263350547,
                            958.8009605407715
                        ],
                        [
                            60315571140,
                            975.7441444396973
                        ],
                        [
                            60418323980,
                            1015.3759422302246
                        ],
                        [
                            60571866420,
                            1077.6938209533691
                        ],
                        [
                            61065125424,
                            992.0196876525879
                        ],
                        [
                            61117962635,
                            1009.5997047424316
                        ],
                        [
                            61167576515,
                            1033.0402030944824
                        ],
                        [
                            61271474689,
                            1074.0619773864746
                        ],
                        [
                            61329190760,
                            1091.6430702209473
                        ],
                        [
                            61628681173,
                            918.2463264465332
                        ],
                        [
                            61680869073,
                            942.4573554992676
                        ],
                        [
                            61735853824,
                            960.6897239685059
                        ],
                        [
                            61897390916,
                            1027.3442649841309
                        ],
                        [
                            61952137656,
                            1045.57670211792
                        ],
                        [
                            62114161150,
                            1112.2303504943848
                        ],
                        [
                            62551936748,
                            630.1352958679199
                        ],
                        [
                            62606437542,
                            652.1154594421387
                        ],
                        [
                            63134352526,
                            907.3491325378418
                        ],
                        [
                            63241248206,
                            952.6991920471191
                        ],
                        [
                            63298096026,
                            972.2687721252441
                        ],
                        [
                            63353393464,
                            998.0503044128418
                        ],
                        [
                            63466399414,
                            1043.3990440368652
                        ],
                        [
                            63524720285,
                            1062.9681205749512
                        ],
                        [
                            63707849528,
                            1055.0066947937012
                        ],
                        [
                            63988692508,
                            738.9432487487793
                        ],
                        [
                            64276081880,
                            852.8654518127441
                        ],
                        [
                            64335997981,
                            879.4460945129395
                        ],
                        [
                            64767057938,
                            957.1416435241699
                        ],
                        [
                            64841010251,
                            916.6504783630371
                        ],
                        [
                            64907438141,
                            944.0952110290527
                        ],
                        [
                            65031234402,
                            992.5423545837402
                        ],
                        [
                            65403513759,
                            1137.59273147583
                        ],
                        [
                            65467862789,
                            1158.5445365905762
                        ],
                        [
                            65705119825,
                            584.9294319152832
                        ],
                        [
                            65756517960,
                            613.1512870788574
                        ],
                        [
                            65843248384,
                            663.0322914123535
                        ],
                        [
                            65886938123,
                            684.6932182312012
                        ],
                        [
                            65971187647,
                            737.8553733825684
                        ],
                        [
                            66055193797,
                            787.7353553771973
                        ],
                        [
                            66422209826,
                            978.205738067627
                        ],
                        [
                            66541922290,
                            1029.6491813659668
                        ],
                        [
                            66663437944,
                            1081.092975616455
                        ],
                        [
                            66849320912,
                            1158.2589836120605
                        ],
                        [
                            66912630022,
                            1183.9806175231934
                        ],
                        [
                            66975243304,
                            1209.7026176452637
                        ],
                        [
                            67252950149,
                            1026.3004035949707
                        ],
                        [
                            67444440754,
                            1124.9081535339355
                        ],
                        [
                            67834153772,
                            1283.9753532409668
                        ],
                        [
                            67899298058,
                            1310.4863319396973
                        ],
                        [
                            68305781169,
                            1049.7563667297363
                        ],
                        [
                            68435685705,
                            1104.3871269226074
                        ],
                        [
                            68566285340,
                            1159.0190773010254
                        ],
                        [
                            68902596133,
                            1295.597583770752
                        ],
                        [
                            69353540568,
                            1092.861484527588
                        ],
                        [
                            69867681436,
                            1317.8878364562988
                        ],
                        [
                            70539656669,
                            755.3328742980957
                        ],
                        [
                            70673225900,
                            816.8593635559082
                        ],
                        [
                            71009926846,
                            961.6418800354004
                        ],
                        [
                            71234270171,
                            1081.9300270080566
                        ],
                        [
                            71306853453,
                            1115.39506149292
                        ],
                        [
                            71524607938,
                            1204.7716178894043
                        ],
                        [
                            71669436768,
                            1264.3561973571777
                        ],
                        [
                            71741292316,
                            1294.1485862731934
                        ],
                        [
                            71886001851,
                            1353.7332801818848
                        ],
                        [
                            72770772312,
                            886.6664619445801
                        ],
                        [
                            73396786220,
                            1048.2495307922363
                        ],
                        [
                            74049815246,
                            1398.6602516174316
                        ],
                        [
                            74539315487,
                            927.7165489196777
                        ],
                        [
                            74704199262,
                            908.2849769592285
                        ],
                        [
                            75119237564,
                            1037.817310333252
                        ],
                        [
                            75263047622,
                            1102.573787689209
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4083140219681111,
                    "n_cpu_percent_c": 1.0087826666157678,
                    "n_cpu_percent_python": 0.2672937170937696,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 5843.370428085327,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.0003597492849628483,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.036513712136153245,
                    "start_outermost_loop": 87,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 88,
                    "end_region_line": 104,
                    "line": "            att = F.softmax(att, dim=-1)\n",
                    "lineno": 88,
                    "memory_samples": [
                        [
                            46286616544,
                            1682.8503150939941
                        ],
                        [
                            47593507018,
                            496.4495658874512
                        ],
                        [
                            47787120705,
                            568.243968963623
                        ],
                        [
                            47987351747,
                            511.931697845459
                        ],
                        [
                            48159509440,
                            577.4548835754395
                        ],
                        [
                            48349108070,
                            518.9194831848145
                        ],
                        [
                            50460985847,
                            590.0230751037598
                        ],
                        [
                            50744042383,
                            552.6428260803223
                        ],
                        [
                            50935657437,
                            622.2649955749512
                        ],
                        [
                            50967014341,
                            633.8688163757324
                        ],
                        [
                            51885489221,
                            629.904712677002
                        ],
                        [
                            51959230324,
                            654.5182991027832
                        ],
                        [
                            51997351570,
                            666.8248023986816
                        ],
                        [
                            52200743674,
                            563.8163261413574
                        ],
                        [
                            52337223063,
                            614.4501152038574
                        ],
                        [
                            52512048813,
                            677.741641998291
                        ],
                        [
                            52662137167,
                            558.9546394348145
                        ],
                        [
                            52909379537,
                            636.7946510314941
                        ],
                        [
                            52987061173,
                            662.8144874572754
                        ],
                        [
                            53487208483,
                            646.645206451416
                        ],
                        [
                            53573841883,
                            673.591983795166
                        ],
                        [
                            53976481933,
                            615.5246772766113
                        ],
                        [
                            54319927372,
                            725.4612922668457
                        ],
                        [
                            54511619258,
                            610.5805244445801
                        ],
                        [
                            54592007735,
                            653.0100898742676
                        ],
                        [
                            55136456030,
                            663.9928016662598
                        ],
                        [
                            55291954934,
                            722.6265068054199
                        ],
                        [
                            55612527833,
                            629.6263999938965
                        ],
                        [
                            55653021034,
                            644.8863868713379
                        ],
                        [
                            55996807997,
                            618.4026222229004
                        ],
                        [
                            56255668215,
                            740.491024017334
                        ],
                        [
                            56514189431,
                            835.5006980895996
                        ],
                        [
                            56891738808,
                            815.1207237243652
                        ],
                        [
                            57515622800,
                            707.2360191345215
                        ],
                        [
                            57607305256,
                            749.8317222595215
                        ],
                        [
                            57745052437,
                            798.6247901916504
                        ],
                        [
                            58117526451,
                            618.2470054626465
                        ],
                        [
                            58172399199,
                            638.7739677429199
                        ],
                        [
                            58219626307,
                            653.8701667785645
                        ],
                        [
                            58499048634,
                            760.6219062805176
                        ],
                        [
                            58898493246,
                            872.9302406311035
                        ],
                        [
                            59182217892,
                            630.9863243103027
                        ],
                        [
                            59280660513,
                            667.8987083435059
                        ],
                        [
                            59376475881,
                            704.8109931945801
                        ],
                        [
                            59497087452,
                            788.9394111633301
                        ],
                        [
                            59603664994,
                            849.1755790710449
                        ],
                        [
                            59698820439,
                            890.2470054626465
                        ],
                        [
                            59729395331,
                            925.6872062683105
                        ],
                        [
                            59828148752,
                            980.2585182189941
                        ],
                        [
                            59860300737,
                            988.6992835998535
                        ],
                        [
                            60438124176,
                            1029.1490440368652
                        ],
                        [
                            60591205021,
                            1091.4669227600098
                        ],
                        [
                            60878619545,
                            924.3163642883301
                        ],
                        [
                            60929154405,
                            941.8970985412598
                        ],
                        [
                            61291370913,
                            1088.4024238586426
                        ],
                        [
                            61595183683,
                            914.6351585388184
                        ],
                        [
                            61650730271,
                            932.8676872253418
                        ],
                        [
                            61703073169,
                            957.0781135559082
                        ],
                        [
                            61919763551,
                            1041.9650230407715
                        ],
                        [
                            62725319783,
                            714.5548896789551
                        ],
                        [
                            62879388399,
                            777.3563652038574
                        ],
                        [
                            63321520304,
                            988.1088829040527
                        ],
                        [
                            63376843382,
                            1013.8898124694824
                        ],
                        [
                            63731148031,
                            1070.8468055725098
                        ],
                        [
                            64417858928,
                            919.3293342590332
                        ],
                        [
                            64558313987,
                            851.1445121765137
                        ],
                        [
                            65055250669,
                            1009.6480903625488
                        ],
                        [
                            65367238605,
                            1127.30025100708
                        ],
                        [
                            65761441680,
                            631.143627166748
                        ],
                        [
                            65806313386,
                            652.8027534484863
                        ],
                        [
                            65807263718,
                            634.4279441833496
                        ],
                        [
                            65893080006,
                            684.3091468811035
                        ],
                        [
                            66020208141,
                            759.1310157775879
                        ],
                        [
                            66062133481,
                            787.3531227111816
                        ],
                        [
                            66444508765,
                            996.6233406066895
                        ],
                        [
                            66935870384,
                            1202.3992881774902
                        ],
                        [
                            67252964173,
                            1060.9324102401733
                        ],
                        [
                            67341347785,
                            1090.9760398864746
                        ],
                        [
                            67530607501,
                            1170.5096015930176
                        ],
                        [
                            67661553852,
                            1223.5316886901855
                        ],
                        [
                            67986821654,
                            1356.087100982666
                        ],
                        [
                            68331839678,
                            1069.533977508545
                        ],
                        [
                            68527212480,
                            1151.4805183410645
                        ],
                        [
                            68592930427,
                            1178.7963523864746
                        ],
                        [
                            68862301219,
                            1288.058765411377
                        ],
                        [
                            68995172078,
                            1346.1482582092285
                        ],
                        [
                            69312619021,
                            1085.205997467041
                        ],
                        [
                            69761481461,
                            1282.1036643981934
                        ],
                        [
                            70634279209,
                            809.2507133483887
                        ],
                        [
                            70766806248,
                            867.1635322570801
                        ],
                        [
                            71256591514,
                            1103.8324394226074
                        ],
                        [
                            71769252709,
                            1316.051197052002
                        ],
                        [
                            71840850044,
                            1345.8436012268066
                        ],
                        [
                            72492026089,
                            928.427417755127
                        ],
                        [
                            72634814588,
                            989.7150535583496
                        ],
                        [
                            72873529565,
                            943.8892402648926
                        ],
                        [
                            73102620118,
                            1035.6882438659668
                        ],
                        [
                            73884225661,
                            1327.6507759094238
                        ],
                        [
                            74059728420,
                            1422.1605186462402
                        ],
                        [
                            75216648693,
                            1094.4341621398926
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 18.771962453338183,
                    "n_core_utilization": 0.45152169844056633,
                    "n_cpu_percent_c": 15.012401092004696,
                    "n_cpu_percent_python": 1.9941518104232268,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 6635.531669616699,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.00023334147380502907,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.04146372307498944,
                    "start_outermost_loop": 88,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 89,
                    "end_region_line": 104,
                    "line": "            att = self.attn_dropout(att)\n",
                    "lineno": 89,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.42154241186692737,
                    "n_cpu_percent_c": 0.18743725719617857,
                    "n_cpu_percent_python": 0.052755338900086074,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 90,
                    "end_region_line": 104,
                    "line": "            y = att @ v # (B, nh, T, T) x (B, nh, T, hs) -\\u003e (B, nh, T, hs)\n",
                    "lineno": 90,
                    "memory_samples": [
                        [
                            45772001635,
                            1675.014850616455
                        ],
                        [
                            46313584520,
                            1692.6982460021973
                        ],
                        [
                            46422350282,
                            1730.8919868469238
                        ],
                        [
                            46486109648,
                            1753.0457725524902
                        ],
                        [
                            46983438975,
                            481.76037216186523
                        ],
                        [
                            47714622084,
                            544.7830696105957
                        ],
                        [
                            47763059287,
                            562.384693145752
                        ],
                        [
                            47963429886,
                            505.8380470275879
                        ],
                        [
                            48013933182,
                            524.1232643127441
                        ],
                        [
                            48063000832,
                            542.4099235534668
                        ],
                        [
                            48087465642,
                            553.0758934020996
                        ],
                        [
                            48135961454,
                            571.3612937927246
                        ],
                        [
                            48324270784,
                            512.5914573669434
                        ],
                        [
                            48377210837,
                            531.5798606872559
                        ],
                        [
                            48429717656,
                            550.5684471130371
                        ],
                        [
                            48482643691,
                            569.5569725036621
                        ],
                        [
                            48535447414,
                            588.546558380127
                        ],
                        [
                            48562373641,
                            599.622745513916
                        ],
                        [
                            48713515938,
                            519.5093269348145
                        ],
                        [
                            48766525168,
                            539.2029151916504
                        ],
                        [
                            48820509751,
                            558.8943214416504
                        ],
                        [
                            48873244401,
                            578.5869255065918
                        ],
                        [
                            48898725991,
                            590.0733299255371
                        ],
                        [
                            48950889211,
                            609.7646751403809
                        ],
                        [
                            49036366510,
                            506.15878677368164
                        ],
                        [
                            49078453433,
                            514.7043876647949
                        ],
                        [
                            49107958056,
                            524.9019355773926
                        ],
                        [
                            49136680475,
                            535.0994453430176
                        ],
                        [
                            49165668880,
                            545.2968940734863
                        ],
                        [
                            49194703349,
                            555.4944038391113
                        ],
                        [
                            49223554457,
                            565.6918525695801
                        ],
                        [
                            49252045210,
                            575.8893013000488
                        ],
                        [
                            49282133934,
                            586.0866889953613
                        ],
                        [
                            49310369647,
                            596.2842597961426
                        ],
                        [
                            49338861603,
                            606.4816474914551
                        ],
                        [
                            49368559072,
                            616.6791572570801
                        ],
                        [
                            49459940362,
                            510.9374580383301
                        ],
                        [
                            49501033927,
                            521.5413475036621
                        ],
                        [
                            49531415721,
                            532.0901832580566
                        ],
                        [
                            49561142932,
                            542.6391944885254
                        ],
                        [
                            49589866543,
                            553.1882057189941
                        ],
                        [
                            49619963041,
                            563.7372779846191
                        ],
                        [
                            49649606056,
                            574.2863502502441
                        ],
                        [
                            49680097089,
                            584.8353004455566
                        ],
                        [
                            49710613489,
                            595.3843116760254
                        ],
                        [
                            49739690915,
                            605.9333076477051
                        ],
                        [
                            49770385732,
                            616.4823188781738
                        ],
                        [
                            49803402037,
                            627.0312690734863
                        ],
                        [
                            49894979179,
                            517.5862770080566
                        ],
                        [
                            49934997696,
                            528.4946403503418
                        ],
                        [
                            49965889913,
                            539.3953742980957
                        ],
                        [
                            49995959169,
                            550.2960090637207
                        ],
                        [
                            50027875147,
                            561.1966438293457
                        ],
                        [
                            50058260864,
                            572.0972175598145
                        ],
                        [
                            50088948860,
                            582.997730255127
                        ],
                        [
                            50120322257,
                            593.8982429504395
                        ],
                        [
                            50150286549,
                            604.7988166809082
                        ],
                        [
                            50181107843,
                            615.6994514465332
                        ],
                        [
                            50212428554,
                            626.600025177002
                        ],
                        [
                            50244501787,
                            637.5005378723145
                        ],
                        [
                            50329248787,
                            524.3877601623535
                        ],
                        [
                            54924497452,
                            593.1050987243652
                        ],
                        [
                            55523792888,
                            601.5693397521973
                        ],
                        [
                            55715963500,
                            511.6702766418457
                        ],
                        [
                            55757398906,
                            529.4307975769043
                        ],
                        [
                            55921193781,
                            588.009449005127
                        ],
                        [
                            55960143214,
                            605.730785369873
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 735.0116558074951,
                    "n_malloc_mb": 735.0116558074951,
                    "n_mallocs": 0,
                    "n_peak_mb": 735.0116558074951,
                    "n_python_fraction": 0.0004070256640574836,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.004592897942577658,
                    "start_outermost_loop": 90,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "        else:\n",
                    "lineno": 91,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 83,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "            # manual implementation of attention\n",
                    "lineno": 92,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 83,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 93,
                    "end_region_line": 104,
                    "line": "            att = (q @ k.transpose(-2, -1)) * (1.0 / math.sqrt(k.size(-1)))\n",
                    "lineno": 93,
                    "memory_samples": [
                        [
                            7882090569,
                            339.31220149993896
                        ],
                        [
                            8160645708,
                            455.29691219329834
                        ],
                        [
                            8726871014,
                            504.5673656463623
                        ],
                        [
                            8752169393,
                            515.3512783050537
                        ],
                        [
                            9026044967,
                            487.76366806030273
                        ],
                        [
                            9321958771,
                            482.4151430130005
                        ],
                        [
                            9894980868,
                            557.1504135131836
                        ],
                        [
                            10254480970,
                            528.2279968261719
                        ],
                        [
                            10673989135,
                            508.24186515808105
                        ],
                        [
                            11125315040,
                            501.75703716278076
                        ],
                        [
                            11192505313,
                            528.9506502151489
                        ],
                        [
                            11227819901,
                            542.5473375320435
                        ],
                        [
                            11403246861,
                            610.5304279327393
                        ],
                        [
                            11534267607,
                            480.76150703430176
                        ],
                        [
                            11763669149,
                            564.6857242584229
                        ],
                        [
                            11799426135,
                            578.7511157989502
                        ],
                        [
                            11944690419,
                            635.0131893157959
                        ],
                        [
                            12280554939,
                            573.6049299240112
                        ],
                        [
                            12688155755,
                            551.1308526992798
                        ],
                        [
                            12741395891,
                            581.1368370056152
                        ],
                        [
                            12982093962,
                            494.75812816619873
                        ],
                        [
                            13226666306,
                            587.3551187515259
                        ],
                        [
                            14463280280,
                            639.0586929321289
                        ],
                        [
                            14726255000,
                            511.1948013305664
                        ],
                        [
                            15129467020,
                            493.0151319503784
                        ],
                        [
                            15753710197,
                            745.8534812927246
                        ],
                        [
                            16034996432,
                            702.4646110534668
                        ],
                        [
                            16802619576,
                            747.6863059997559
                        ],
                        [
                            16900973845,
                            784.2579383850098
                        ],
                        [
                            16976761065,
                            499.8827934265137
                        ],
                        [
                            17077149629,
                            526.392894744873
                        ],
                        [
                            17661492461,
                            796.479808807373
                        ],
                        [
                            17694453149,
                            815.2333793640137
                        ],
                        [
                            18097433559,
                            735.580509185791
                        ],
                        [
                            18591392077,
                            661.885311126709
                        ],
                        [
                            18712290694,
                            702.2520942687988
                        ],
                        [
                            19119028441,
                            866.1779441833496
                        ],
                        [
                            19384656133,
                            681.2024040222168
                        ],
                        [
                            19384660089,
                            692.0381126403809
                        ],
                        [
                            20104086264,
                            661.5461311340332
                        ],
                        [
                            20104093180,
                            675.4680671691895
                        ],
                        [
                            20619273281,
                            872.9879341125488
                        ],
                        [
                            21019560316,
                            727.3377723693848
                        ],
                        [
                            21079497225,
                            740.525074005127
                        ],
                        [
                            22098396236,
                            828.7856941223145
                        ],
                        [
                            22155382104,
                            854.6651649475098
                        ],
                        [
                            22916004299,
                            819.5983085632324
                        ],
                        [
                            23543244705,
                            824.9682655334473
                        ],
                        [
                            23911682723,
                            987.5601081848145
                        ],
                        [
                            24965308347,
                            1092.997646331787
                        ],
                        [
                            25635353948,
                            964.6962699890137
                        ],
                        [
                            26865638328,
                            1058.7447395324707
                        ],
                        [
                            27562789841,
                            983.9226341247559
                        ],
                        [
                            27781017126,
                            1061.386661529541
                        ],
                        [
                            28002182153,
                            1145.4947242736816
                        ],
                        [
                            28492706116,
                            1010.6541862487793
                        ],
                        [
                            28801026256,
                            911.0206489562988
                        ],
                        [
                            28874399688,
                            958.7720985412598
                        ],
                        [
                            28945325321,
                            987.425350189209
                        ],
                        [
                            28945329613,
                            970.964054107666
                        ],
                        [
                            29567581857,
                            905.1668968200684
                        ],
                        [
                            30942104730,
                            1038.2155799865723
                        ],
                        [
                            31419002391,
                            911.8233909606934
                        ],
                        [
                            31419007031,
                            893.4480323791504
                        ],
                        [
                            32113319313,
                            1021.1320686340332
                        ],
                        [
                            32194714484,
                            1049.9616432189941
                        ],
                        [
                            32268712007,
                            1086.7323188781738
                        ],
                        [
                            32867312432,
                            1350.3244132995605
                        ],
                        [
                            33290305448,
                            1059.5276679992676
                        ],
                        [
                            33437132724,
                            1122.5133171081543
                        ],
                        [
                            33585367901,
                            1183.6911125183105
                        ],
                        [
                            34735642299,
                            724.2662010192871
                        ],
                        [
                            34818982154,
                            774.615161895752
                        ],
                        [
                            34896613090,
                            811.4792747497559
                        ],
                        [
                            34972763123,
                            849.6088523864746
                        ],
                        [
                            35222471512,
                            931.9042015075684
                        ],
                        [
                            35552068730,
                            1104.2377433776855
                        ],
                        [
                            35782227788,
                            1229.4238243103027
                        ],
                        [
                            36267425970,
                            1454.4526634216309
                        ],
                        [
                            36883873421,
                            644.7815055847168
                        ],
                        [
                            36887627770,
                            674.2233467102051
                        ],
                        [
                            36964810372,
                            680.8877296447754
                        ],
                        [
                            37050541410,
                            724.6308784484863
                        ],
                        [
                            38152796957,
                            1184.5038261413574
                        ],
                        [
                            38396401639,
                            1269.5254249572754
                        ],
                        [
                            38652977336,
                            1385.063892364502
                        ],
                        [
                            39566556735,
                            808.3115653991699
                        ],
                        [
                            39816676574,
                            891.9503746032715
                        ],
                        [
                            40722749576,
                            1359.6723823547363
                        ],
                        [
                            40860671419,
                            1422.6826133728027
                        ],
                        [
                            41543627347,
                            1283.3736000061035
                        ],
                        [
                            42561247545,
                            1177.9430351257324
                        ],
                        [
                            42829269610,
                            1304.801815032959
                        ],
                        [
                            43279077228,
                            1477.2122764587402
                        ],
                        [
                            43548058376,
                            1600.203540802002
                        ],
                        [
                            75706516010,
                            1309.9566459655762
                        ],
                        [
                            75880470409,
                            1374.1611366271973
                        ],
                        [
                            76159044058,
                            1489.417667388916
                        ],
                        [
                            76248588408,
                            1555.9382286071777
                        ],
                        [
                            76338044410,
                            1571.41157913208
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4194218351769865,
                    "n_cpu_percent_c": 1.4826174042282863,
                    "n_cpu_percent_python": 0.37280439489394185,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 15360.156443595886,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.00046412685613937465,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.09598164922970887,
                    "start_outermost_loop": 93,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "            #att = att.masked_fill(self.bias[:,:,:T,:T] == 0, float('-inf'))\n",
                    "lineno": 94,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 83,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 95,
                    "end_region_line": 104,
                    "line": "            att = att.masked_fill(attn_mask == 0, float('-inf'))\n",
                    "lineno": 95,
                    "memory_samples": [
                        [
                            27215672398,
                            860.6775016784668
                        ],
                        [
                            27294124708,
                            888.2447853088379
                        ],
                        [
                            27355521116,
                            919.3278999328613
                        ],
                        [
                            27491167028,
                            975.3993873596191
                        ],
                        [
                            27641049048,
                            1031.4714698791504
                        ],
                        [
                            27861218012,
                            1112.5324440002441
                        ],
                        [
                            28286348347,
                            928.0200309753418
                        ],
                        [
                            28355794746,
                            957.2233848571777
                        ],
                        [
                            28425620524,
                            992.6384086608887
                        ],
                        [
                            28570195237,
                            1047.308032989502
                        ],
                        [
                            28713341978,
                            1105.0831565856934
                        ],
                        [
                            28803200394,
                            928.1034965515137
                        ],
                        [
                            29225439364,
                            753.2333717346191
                        ],
                        [
                            29296588936,
                            789.9495124816895
                        ],
                        [
                            29366980728,
                            820.336498260498
                        ],
                        [
                            29432860650,
                            857.0526695251465
                        ],
                        [
                            29642271506,
                            943.1290626525879
                        ],
                        [
                            29856202757,
                            1035.534091949463
                        ],
                        [
                            29996481400,
                            1095.0279960632324
                        ],
                        [
                            30205200609,
                            953.8112602233887
                        ],
                        [
                            30439143350,
                            826.272777557373
                        ],
                        [
                            30582778118,
                            894.7161445617676
                        ],
                        [
                            30654600574,
                            925.6850318908691
                        ],
                        [
                            30794909092,
                            995.3204460144043
                        ],
                        [
                            31422244900,
                            912.4447822570801
                        ],
                        [
                            31536617034,
                            975.4541893005371
                        ],
                        [
                            31594948675,
                            1003.677547454834
                        ],
                        [
                            31713846980,
                            1066.686206817627
                        ],
                        [
                            31834709664,
                            1129.6955680847168
                        ],
                        [
                            31893834973,
                            1164.481777191162
                        ],
                        [
                            32123526867,
                            1034.1135902404785
                        ],
                        [
                            32271860670,
                            1106.3931312561035
                        ],
                        [
                            32643667705,
                            1272.775562286377
                        ],
                        [
                            32718370357,
                            1305.1787300109863
                        ],
                        [
                            32795618111,
                            1337.582103729248
                        ],
                        [
                            33215903532,
                            1043.6210670471191
                        ],
                        [
                            33367075217,
                            1112.9354667663574
                        ],
                        [
                            33440611092,
                            1142.8461112976074
                        ],
                        [
                            33517150445,
                            1179.5544166564941
                        ],
                        [
                            33591460094,
                            1212.8637199401855
                        ],
                        [
                            33666077362,
                            1246.1729698181152
                        ],
                        [
                            33743260827,
                            1279.4821510314941
                        ],
                        [
                            33822309664,
                            1312.7912559509277
                        ],
                        [
                            33896941484,
                            1346.1007041931152
                        ],
                        [
                            33974728512,
                            1379.4100761413574
                        ],
                        [
                            34050728372,
                            1412.7193183898926
                        ],
                        [
                            34512470234,
                            633.158374786377
                        ],
                        [
                            34588758412,
                            669.9095268249512
                        ],
                        [
                            34742592929,
                            738.3724021911621
                        ],
                        [
                            34822380654,
                            775.2365531921387
                        ],
                        [
                            34899346553,
                            812.1006660461426
                        ],
                        [
                            35057372602,
                            884.4616584777832
                        ],
                        [
                            35140074242,
                            918.6934242248535
                        ],
                        [
                            35225821213,
                            952.9248237609863
                        ],
                        [
                            35789455734,
                            1244.1081504821777
                        ],
                        [
                            36030344067,
                            1349.59135055542
                        ],
                        [
                            36111244708,
                            1384.7524147033691
                        ],
                        [
                            36647494476,
                            888.1007499694824
                        ],
                        [
                            36733266365,
                            603.1009330749512
                        ],
                        [
                            36890285985,
                            674.8451728820801
                        ],
                        [
                            37137119877,
                            783.1634330749512
                        ],
                        [
                            37308663184,
                            855.3766746520996
                        ],
                        [
                            37560122252,
                            963.6959037780762
                        ],
                        [
                            37915515482,
                            1084.8455924987793
                        ],
                        [
                            37993591735,
                            1118.2724113464355
                        ],
                        [
                            38074784722,
                            1151.6990547180176
                        ],
                        [
                            38240217028,
                            1218.5522499084473
                        ],
                        [
                            39146832178,
                            622.0731544494629
                        ],
                        [
                            39401808694,
                            733.814281463623
                        ],
                        [
                            39653328475,
                            846.9616889953613
                        ],
                        [
                            39738275321,
                            884.989803314209
                        ],
                        [
                            39823995440,
                            923.0179023742676
                        ],
                        [
                            40461218890,
                            1235.7750282287598
                        ],
                        [
                            40528631945,
                            1271.029941558838
                        ],
                        [
                            40596251321,
                            1306.2848777770996
                        ],
                        [
                            40729791175,
                            1376.7945747375488
                        ],
                        [
                            40863529376,
                            1447.3043632507324
                        ],
                        [
                            40930559439,
                            1482.5592765808105
                        ],
                        [
                            40998367628,
                            1517.8142280578613
                        ],
                        [
                            41289912463,
                            1164.003993988037
                        ],
                        [
                            41461916002,
                            1243.9980506896973
                        ],
                        [
                            41546681493,
                            1283.9949913024902
                        ],
                        [
                            41720610147,
                            1363.9889945983887
                        ],
                        [
                            41894199107,
                            1443.9833335876465
                        ],
                        [
                            41982266121,
                            1483.9803581237793
                        ],
                        [
                            42069872614,
                            1523.9775581359863
                        ],
                        [
                            42247938907,
                            1603.9797096252441
                        ],
                        [
                            42662029401,
                            1223.4294700622559
                        ],
                        [
                            42746507229,
                            1264.4265098571777
                        ],
                        [
                            42832890699,
                            1305.4232063293457
                        ],
                        [
                            42920832342,
                            1346.4205436706543
                        ],
                        [
                            43287129652,
                            1510.4087562561035
                        ],
                        [
                            43462974082,
                            1592.4029579162598
                        ],
                        [
                            75623313496,
                            1269.5814476013184
                        ],
                        [
                            75710168605,
                            1310.5784721374512
                        ],
                        [
                            75888189624,
                            1392.572338104248
                        ],
                        [
                            76071298015,
                            1474.5662269592285
                        ],
                        [
                            76162163817,
                            1515.5631523132324
                        ],
                        [
                            76341124360,
                            1597.5571403503418
                        ],
                        [
                            76531200092,
                            1679.551097869873
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.42221410836865053,
                    "n_cpu_percent_c": 3.741959752234517,
                    "n_cpu_percent_python": 0.8898067161147816,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 4220.661213874817,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.00017290075699016478,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.02637382149297515,
                    "start_outermost_loop": 95,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 96,
                    "end_region_line": 104,
                    "line": "            att = F.softmax(att, dim=-1)\n",
                    "lineno": 96,
                    "memory_samples": [
                        [
                            13280952228,
                            614.4291009902954
                        ],
                        [
                            13321252477,
                            629.901177406311
                        ],
                        [
                            13919853429,
                            656.8863916397095
                        ],
                        [
                            17483340222,
                            716.7774696350098
                        ],
                        [
                            18217875617,
                            789.4086952209473
                        ],
                        [
                            18942632711,
                            790.8603935241699
                        ],
                        [
                            20919344067,
                            689.0956077575684
                        ],
                        [
                            21947041048,
                            781.3375358581543
                        ],
                        [
                            22421146463,
                            966.8067436218262
                        ],
                        [
                            22801913170,
                            792.051685333252
                        ],
                        [
                            23670550237,
                            895.8520774841309
                        ],
                        [
                            24338924482,
                            858.3477210998535
                        ],
                        [
                            24729529705,
                            999.091381072998
                        ],
                        [
                            24867063224,
                            1050.209316253662
                        ],
                        [
                            25398478234,
                            920.7372627258301
                        ],
                        [
                            25530464437,
                            950.0388298034668
                        ],
                        [
                            25530470754,
                            935.3908576965332
                        ],
                        [
                            26238824376,
                            835.7015342712402
                        ],
                        [
                            26401250884,
                            892.8560829162598
                        ],
                        [
                            26472357879,
                            932.308765411377
                        ],
                        [
                            26472365600,
                            917.0670433044434
                        ],
                        [
                            26759515872,
                            1044.095859527588
                        ],
                        [
                            26826938739,
                            1068.3068809509277
                        ],
                        [
                            27513862775,
                            958.9937553405762
                        ],
                        [
                            27732671332,
                            1040.0546379089355
                        ],
                        [
                            27882502777,
                            1096.126865386963
                        ],
                        [
                            28380681778,
                            973.0628623962402
                        ],
                        [
                            28594779361,
                            1063.1475105285645
                        ],
                        [
                            28901687375,
                            975.232967376709
                        ],
                        [
                            28901692338,
                            958.7728157043457
                        ],
                        [
                            29250055233,
                            769.6978492736816
                        ],
                        [
                            29597097844,
                            915.9259147644043
                        ],
                        [
                            29951349401,
                            1061.4960289001465
                        ],
                        [
                            30510576147,
                            838.9529762268066
                        ],
                        [
                            30533393463,
                            856.6793403625488
                        ],
                        [
                            31045681506,
                            1089.7882957458496
                        ],
                        [
                            31261468477,
                            818.5976829528809
                        ],
                        [
                            31600968471,
                            1021.4310874938965
                        ],
                        [
                            32147275165,
                            1052.531192779541
                        ],
                        [
                            32297114287,
                            1124.8112525939941
                        ],
                        [
                            32297121604,
                            1090.0852088928223
                        ],
                        [
                            32369434354,
                            1126.855281829834
                        ],
                        [
                            32521141615,
                            1226.3874778747559
                        ],
                        [
                            32971721672,
                            1386.0803031921387
                        ],
                        [
                            33318229104,
                            1098.9502906799316
                        ],
                        [
                            33392823836,
                            1132.0255165100098
                        ],
                        [
                            33542165334,
                            1198.6444664001465
                        ],
                        [
                            33616754389,
                            1196.6065788269043
                        ],
                        [
                            33847745361,
                            1296.5341148376465
                        ],
                        [
                            33922658248,
                            1365.1907539367676
                        ],
                        [
                            33922664732,
                            1329.843563079834
                        ],
                        [
                            34000468547,
                            1398.500072479248
                        ],
                        [
                            34000475522,
                            1363.1529350280762
                        ],
                        [
                            34539558991,
                            652.9353523254395
                        ],
                        [
                            34849705212,
                            795.0140495300293
                        ],
                        [
                            35167468964,
                            938.470401763916
                        ],
                        [
                            35252962750,
                            972.7018013000488
                        ],
                        [
                            35658616830,
                            1187.9229545593262
                        ],
                        [
                            35735564012,
                            1208.3266563415527
                        ],
                        [
                            36216006589,
                            1419.2927589416504
                        ],
                        [
                            36377371042,
                            1489.6146430969238
                        ],
                        [
                            36677722451,
                            664.5256767272949
                        ],
                        [
                            36842081776,
                            623.3329124450684
                        ],
                        [
                            36920547675,
                            696.0284004211426
                        ],
                        [
                            37083454099,
                            768.2410621643066
                        ],
                        [
                            37250166742,
                            803.8642539978027
                        ],
                        [
                            37339143191,
                            876.5599021911621
                        ],
                        [
                            37339149353,
                            839.9706764221191
                        ],
                        [
                            37506927746,
                            948.7727165222168
                        ],
                        [
                            37590009933,
                            984.8791313171387
                        ],
                        [
                            37590014745,
                            948.2899055480957
                        ],
                        [
                            37943942038,
                            1106.7475700378418
                        ],
                        [
                            38022809883,
                            1117.651569366455
                        ],
                        [
                            38186965942,
                            1184.504810333252
                        ],
                        [
                            38353001613,
                            1273.8809394836426
                        ],
                        [
                            38432589019,
                            1284.7846565246582
                        ],
                        [
                            39079912465,
                            604.6298637390137
                        ],
                        [
                            39079918874,
                            581.3726692199707
                        ],
                        [
                            39264000708,
                            643.9727668762207
                        ],
                        [
                            39347784157,
                            681.0635643005371
                        ],
                        [
                            39516144978,
                            794.0102195739746
                        ],
                        [
                            39599624086,
                            831.5697441101074
                        ],
                        [
                            39938660363,
                            983.682445526123
                        ],
                        [
                            40471917201,
                            1235.1543083190918
                        ],
                        [
                            40539848904,
                            1270.4091453552246
                        ],
                        [
                            40674673957,
                            1340.9189414978027
                        ],
                        [
                            40807702396,
                            1411.4287071228027
                        ],
                        [
                            41576730404,
                            1308.1318626403809
                        ],
                        [
                            41836703639,
                            1388.4357795715332
                        ],
                        [
                            41924251210,
                            1468.119686126709
                        ],
                        [
                            42098973055,
                            1548.1139106750488
                        ],
                        [
                            42593500108,
                            1177.9439888000488
                        ],
                        [
                            42775316913,
                            1289.3284873962402
                        ],
                        [
                            42920848748,
                            1371.2282781600952
                        ],
                        [
                            43042552781,
                            1412.3196067810059
                        ],
                        [
                            43228760489,
                            1494.3136558532715
                        ],
                        [
                            75651029121,
                            1294.4834251403809
                        ],
                        [
                            76010189926,
                            1432.948398590088
                        ],
                        [
                            76099980972,
                            1473.945384979248
                        ],
                        [
                            76559728507,
                            1704.4530754089355
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 21.454978514752504,
                    "n_core_utilization": 0.44991699606450825,
                    "n_cpu_percent_c": 15.174509455888032,
                    "n_cpu_percent_python": 2.0891114204433796,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 873.6982421875,
                    "n_malloc_mb": 5231.53835105896,
                    "n_mallocs": 0,
                    "n_peak_mb": 873.6982421875,
                    "n_python_fraction": 0.00017811082750608355,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.032690531557213694,
                    "start_outermost_loop": 96,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 97,
                    "end_region_line": 104,
                    "line": "            att = self.attn_dropout(att)\n",
                    "lineno": 97,
                    "memory_samples": [
                        [
                            12447669391,
                            628.1095895767212
                        ],
                        [
                            13764123281,
                            577.1866044998169
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4753885549249173,
                    "n_cpu_percent_c": 0.14064397499633483,
                    "n_cpu_percent_python": 0.03517022593339072,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 97,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 98,
                    "end_region_line": 104,
                    "line": "            y = att @ v # (B, nh, T, T) x (B, nh, T, hs) -\\u003e (B, nh, T, hs)\n",
                    "lineno": 98,
                    "memory_samples": [
                        [
                            5767625243,
                            306.9071378707886
                        ],
                        [
                            6143615321,
                            320.14173126220703
                        ],
                        [
                            6352593835,
                            324.7780122756958
                        ],
                        [
                            7194026465,
                            396.55652046203613
                        ],
                        [
                            7605014547,
                            349.5681095123291
                        ],
                        [
                            7776906823,
                            405.83747482299805
                        ],
                        [
                            8225719547,
                            447.06649684906006
                        ],
                        [
                            8254615789,
                            456.0929174423218
                        ],
                        [
                            18614413212,
                            672.2229347229004
                        ],
                        [
                            18676116893,
                            694.8674659729004
                        ],
                        [
                            18735238205,
                            712.5893669128418
                        ],
                        [
                            18786203836,
                            735.2337455749512
                        ],
                        [
                            18838220745,
                            755.4167289733887
                        ],
                        [
                            18892322648,
                            775.5997734069824
                        ],
                        [
                            19035762754,
                            836.1490287780762
                        ],
                        [
                            19093067269,
                            856.3324012756348
                        ],
                        [
                            19143662547,
                            876.5153617858887
                        ],
                        [
                            19193462932,
                            896.6983451843262
                        ],
                        [
                            19408860781,
                            702.8750419616699
                        ],
                        [
                            19475292379,
                            721.2731285095215
                        ],
                        [
                            19530353085,
                            744.7104225158691
                        ],
                        [
                            19584916962,
                            763.1081581115723
                        ],
                        [
                            19638084479,
                            786.5455131530762
                        ],
                        [
                            19692606956,
                            804.9432792663574
                        ],
                        [
                            19746148110,
                            828.3805732727051
                        ],
                        [
                            19799409250,
                            846.7783088684082
                        ],
                        [
                            19854203985,
                            870.2157249450684
                        ],
                        [
                            19912474748,
                            888.6136207580566
                        ],
                        [
                            19966067538,
                            912.0509147644043
                        ],
                        [
                            20188219237,
                            711.0519065856934
                        ],
                        [
                            20257515220,
                            730.1339836120605
                        ],
                        [
                            20364421729,
                            773.4540748596191
                        ],
                        [
                            20476092760,
                            816.7743644714355
                        ],
                        [
                            20534403454,
                            841.0130348205566
                        ],
                        [
                            20589330222,
                            860.094799041748
                        ],
                        [
                            20645292601,
                            884.3334083557129
                        ],
                        [
                            20700329560,
                            903.415096282959
                        ],
                        [
                            20753670505,
                            927.6535835266113
                        ],
                        [
                            20984591952,
                            719.4248313903809
                        ],
                        [
                            21048647444,
                            739.2060279846191
                        ],
                        [
                            21107133712,
                            764.2608680725098
                        ],
                        [
                            21166926550,
                            784.0418281555176
                        ],
                        [
                            21225303852,
                            809.0966682434082
                        ],
                        [
                            21283216015,
                            828.8775672912598
                        ],
                        [
                            21341957079,
                            853.9324073791504
                        ],
                        [
                            21401981945,
                            873.713306427002
                        ],
                        [
                            21459721328,
                            898.7690925598145
                        ],
                        [
                            21520739037,
                            918.5500373840332
                        ],
                        [
                            21579873700,
                            943.6048545837402
                        ],
                        [
                            21758693549,
                            702.0839424133301
                        ],
                        [
                            21827756016,
                            727.9635429382324
                        ],
                        [
                            21888543955,
                            748.4516334533691
                        ],
                        [
                            22004436181,
                            794.818675994873
                        ],
                        [
                            22124636015,
                            841.185977935791
                        ],
                        [
                            22242235209,
                            887.5532188415527
                        ],
                        [
                            22361470781,
                            933.9206428527832
                        ],
                        [
                            22603716517,
                            707.211986541748
                        ],
                        [
                            22674965334,
                            733.9316139221191
                        ],
                        [
                            22735965819,
                            755.1425132751465
                        ],
                        [
                            22877809060,
                            803.0724754333496
                        ],
                        [
                            22948439230,
                            829.7917747497559
                        ],
                        [
                            23009084880,
                            851.0024681091309
                        ],
                        [
                            23073694362,
                            877.721607208252
                        ],
                        [
                            23135571903,
                            898.9322929382324
                        ],
                        [
                            23198071675,
                            925.6514015197754
                        ],
                        [
                            23258826107,
                            946.8620262145996
                        ],
                        [
                            23553327748,
                            835.6574897766113
                        ],
                        [
                            23610206797,
                            863.2243843078613
                        ],
                        [
                            23721315527,
                            912.7325630187988
                        ],
                        [
                            23777533134,
                            937.4866371154785
                        ],
                        [
                            23826821642,
                            962.2407722473145
                        ],
                        [
                            24271499223,
                            821.590259552002
                        ],
                        [
                            24398727562,
                            877.0408210754395
                        ],
                        [
                            24532032421,
                            928.1583518981934
                        ],
                        [
                            24660157248,
                            979.2756996154785
                        ],
                        [
                            24792712533,
                            1030.39351272583
                        ],
                        [
                            24927264637,
                            1081.5111122131348
                        ],
                        [
                            25196832754,
                            829.9042320251465
                        ],
                        [
                            25328137958,
                            882.6472282409668
                        ],
                        [
                            25596472366,
                            961.7638740539551
                        ],
                        [
                            25727139806,
                            1014.5065879821777
                        ],
                        [
                            25860467660,
                            1067.2494850158691
                        ],
                        [
                            25991542175,
                            1122.922306060791
                        ],
                        [
                            26319031377,
                            865.6566429138184
                        ],
                        [
                            26544244740,
                            950.2441673278809
                        ],
                        [
                            26687997605,
                            1001.6550407409668
                        ],
                        [
                            26895103673,
                            1086.2422523498535
                        ],
                        [
                            27032284265,
                            1140.6413841247559
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 972.241042137146,
                    "n_malloc_mb": 972.241042137146,
                    "n_mallocs": 0,
                    "n_peak_mb": 972.241042137146,
                    "n_python_fraction": 0.00025652814807719694,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.006075283088151159,
                    "start_outermost_loop": 98,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 104,
                    "line": "        \n",
                    "lineno": 99,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 99,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 100,
                    "end_region_line": 104,
                    "line": "        y = y.transpose(1, 2).contiguous().view(B, curr_T, C) # re-assemble all head outputs side by side\n",
                    "lineno": 100,
                    "memory_samples": [
                        [
                            13645661673,
                            531.3578500747681
                        ],
                        [
                            18614420234,
                            659.4260597229004
                        ],
                        [
                            18676123613,
                            682.0705909729004
                        ],
                        [
                            18735248868,
                            699.7924919128418
                        ],
                        [
                            18786211039,
                            722.4368705749512
                        ],
                        [
                            18838227624,
                            742.6198539733887
                        ],
                        [
                            18892329832,
                            762.8028984069824
                        ],
                        [
                            19035770808,
                            823.3521537780762
                        ],
                        [
                            19093074326,
                            843.5355262756348
                        ],
                        [
                            19143669633,
                            863.7184867858887
                        ],
                        [
                            19193469759,
                            883.9014701843262
                        ],
                        [
                            19408867840,
                            689.5195732116699
                        ],
                        [
                            19475299322,
                            707.9176597595215
                        ],
                        [
                            19530360642,
                            731.3549537658691
                        ],
                        [
                            19584924314,
                            749.7526893615723
                        ],
                        [
                            19638091585,
                            773.1900444030762
                        ],
                        [
                            19692614262,
                            791.5878105163574
                        ],
                        [
                            19746155764,
                            815.0251045227051
                        ],
                        [
                            19799416232,
                            833.4228401184082
                        ],
                        [
                            19854210955,
                            856.8602561950684
                        ],
                        [
                            19912480289,
                            875.2581520080566
                        ],
                        [
                            19966072558,
                            898.6954460144043
                        ],
                        [
                            20188226414,
                            697.1300315856934
                        ],
                        [
                            20257522641,
                            716.2121086120605
                        ],
                        [
                            20364428823,
                            759.5321998596191
                        ],
                        [
                            20476098344,
                            802.8524894714355
                        ],
                        [
                            20534408691,
                            827.0911598205566
                        ],
                        [
                            20589337096,
                            846.172924041748
                        ],
                        [
                            20645300062,
                            870.4115333557129
                        ],
                        [
                            20700336491,
                            889.493221282959
                        ],
                        [
                            20753677850,
                            913.7317085266113
                        ],
                        [
                            20984599236,
                            704.9209251403809
                        ],
                        [
                            21048654828,
                            724.7021217346191
                        ],
                        [
                            21107142497,
                            749.7569618225098
                        ],
                        [
                            21166933809,
                            769.5379219055176
                        ],
                        [
                            21225309153,
                            794.5927619934082
                        ],
                        [
                            21283223630,
                            814.3736610412598
                        ],
                        [
                            21341964841,
                            839.4285011291504
                        ],
                        [
                            21401990798,
                            859.209400177002
                        ],
                        [
                            21459728623,
                            884.2651863098145
                        ],
                        [
                            21520746134,
                            904.0461311340332
                        ],
                        [
                            21579878991,
                            929.1009483337402
                        ],
                        [
                            21758705762,
                            686.9901924133301
                        ],
                        [
                            21827763809,
                            712.8697929382324
                        ],
                        [
                            21888549668,
                            733.3578834533691
                        ],
                        [
                            22004444931,
                            779.724925994873
                        ],
                        [
                            22124643493,
                            826.092227935791
                        ],
                        [
                            22242240547,
                            872.4594688415527
                        ],
                        [
                            22361477749,
                            918.8268928527832
                        ],
                        [
                            22603723844,
                            694.2664451599121
                        ],
                        [
                            22674972505,
                            720.9860725402832
                        ],
                        [
                            22735973456,
                            742.1969718933105
                        ],
                        [
                            22877816592,
                            790.1269340515137
                        ],
                        [
                            22948444583,
                            816.8462333679199
                        ],
                        [
                            23009092500,
                            838.0569267272949
                        ],
                        [
                            23073700030,
                            864.776065826416
                        ],
                        [
                            23135579981,
                            885.9867515563965
                        ],
                        [
                            23198081169,
                            912.7058601379395
                        ],
                        [
                            23553334847,
                            822.1572608947754
                        ],
                        [
                            23610214357,
                            849.7241554260254
                        ],
                        [
                            23674916496,
                            871.6658134460449
                        ],
                        [
                            23721322416,
                            899.2323341369629
                        ],
                        [
                            23777540231,
                            923.9864082336426
                        ],
                        [
                            23826828823,
                            948.7405433654785
                        ],
                        [
                            23879150094,
                            970.6821327209473
                        ],
                        [
                            24271506439,
                            807.519718170166
                        ],
                        [
                            24398734697,
                            862.9702796936035
                        ],
                        [
                            24532040457,
                            914.0878105163574
                        ],
                        [
                            24660167469,
                            965.2051582336426
                        ],
                        [
                            24792719884,
                            1016.3229713439941
                        ],
                        [
                            24927275987,
                            1067.4405708312988
                        ],
                        [
                            25196839978,
                            815.2555656433105
                        ],
                        [
                            25328145588,
                            867.9985618591309
                        ],
                        [
                            25596479329,
                            947.1152076721191
                        ],
                        [
                            25727147230,
                            999.8579216003418
                        ],
                        [
                            25860475250,
                            1052.6008186340332
                        ],
                        [
                            25991549450,
                            1108.273639678955
                        ],
                        [
                            26319044656,
                            850.4142265319824
                        ],
                        [
                            26544252008,
                            935.0017509460449
                        ],
                        [
                            26688005308,
                            986.4126243591309
                        ],
                        [
                            26895109151,
                            1070.9998359680176
                        ],
                        [
                            27032292061,
                            1125.39896774292
                        ],
                        [
                            31377704336,
                            857.343563079834
                        ],
                        [
                            31490706021,
                            924.9545631408691
                        ],
                        [
                            31606705196,
                            991.2447242736816
                        ],
                        [
                            31846854738,
                            1113.9822120666504
                        ],
                        [
                            55523801037,
                            591.2331733703613
                        ],
                        [
                            55715971010,
                            501.33411026000977
                        ],
                        [
                            55757408955,
                            519.0946311950684
                        ],
                        [
                            55921201472,
                            577.548282623291
                        ],
                        [
                            55960150051,
                            595.3946189880371
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.09071038741342233,
                    "n_core_utilization": 0.4390448034027232,
                    "n_cpu_percent_c": 0.6543969190431649,
                    "n_cpu_percent_python": 0.16881708448027552,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 100,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 101,
                    "end_region_line": 104,
                    "line": "\n",
                    "lineno": 101,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 101,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 104,
                    "end_region_line": 104,
                    "line": "        # output projection\n",
                    "lineno": 102,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 61,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 103,
                    "end_region_line": 104,
                    "line": "        y = self.resid_dropout(self.c_proj(y))\n",
                    "lineno": 103,
                    "memory_samples": [
                        [
                            31788043612,
                            1089.0407600402832
                        ],
                        [
                            34433604377,
                            1063.2671241760254
                        ],
                        [
                            71994609901,
                            1380.190486907959
                        ],
                        [
                            72711258268,
                            986.7258644104004
                        ],
                        [
                            73106839193,
                            1008.3092155456543
                        ],
                        [
                            74574636334,
                            918.3591575622559
                        ],
                        [
                            76565274422,
                            1679.2174644470215
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.401122996249544,
                    "n_cpu_percent_c": 0.1687657359504002,
                    "n_cpu_percent_python": 0.04923831630674699,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 63.93184852600098,
                    "n_malloc_mb": 63.93184852600098,
                    "n_mallocs": 0,
                    "n_peak_mb": 63.93184852600098,
                    "n_python_fraction": 0.0006088510797151715,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0003994936042717135,
                    "start_outermost_loop": 103,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 104,
                    "end_region_line": 104,
                    "line": "        return y, att, new_kvcache\n",
                    "lineno": 104,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 104,
                    "start_region_line": 61
                },
                {
                    "end_outermost_loop": 105,
                    "end_region_line": 105,
                    "line": "\n",
                    "lineno": 105,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 105,
                    "start_region_line": 105
                },
                {
                    "end_outermost_loop": 119,
                    "end_region_line": 119,
                    "line": "class MLP(nn.Module):\n",
                    "lineno": 106,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 106,
                    "start_region_line": 106
                },
                {
                    "end_outermost_loop": 107,
                    "end_region_line": 119,
                    "line": "\n",
                    "lineno": 107,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 107,
                    "start_region_line": 106
                },
                {
                    "end_outermost_loop": 112,
                    "end_region_line": 112,
                    "line": "    def __init__(self, config):\n",
                    "lineno": 108,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 108,
                    "start_region_line": 108
                },
                {
                    "end_outermost_loop": 109,
                    "end_region_line": 112,
                    "line": "        super().__init__()\n",
                    "lineno": 109,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 109,
                    "start_region_line": 108
                },
                {
                    "end_outermost_loop": 110,
                    "end_region_line": 112,
                    "line": "        self.c_fc    = nn.Linear(config.n_embd, 4 * config.n_embd, bias=config.bias)\n",
                    "lineno": 110,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 110,
                    "start_region_line": 108
                },
                {
                    "end_outermost_loop": 111,
                    "end_region_line": 112,
                    "line": "        self.c_proj  = nn.Linear(4 * config.n_embd, config.n_embd, bias=config.bias)\n",
                    "lineno": 111,
                    "memory_samples": [
                        [
                            4751692161,
                            151.7818832397461
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.461025511871033,
                    "n_cpu_percent_c": 0.056194635294112394,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.053732872009277,
                    "n_malloc_mb": 10.053732872009277,
                    "n_mallocs": 0,
                    "n_peak_mb": 10.053732872009277,
                    "n_python_fraction": 0.742699,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 6.282317927645293e-05,
                    "start_outermost_loop": 111,
                    "start_region_line": 108
                },
                {
                    "end_outermost_loop": 112,
                    "end_region_line": 112,
                    "line": "        self.dropout = nn.Dropout(config.dropout)\n",
                    "lineno": 112,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 112,
                    "start_region_line": 108
                },
                {
                    "end_outermost_loop": 113,
                    "end_region_line": 119,
                    "line": "\n",
                    "lineno": 113,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 113,
                    "start_region_line": 106
                },
                {
                    "end_outermost_loop": 119,
                    "end_region_line": 119,
                    "line": "    def forward(self, x):\n",
                    "lineno": 114,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 114,
                    "start_region_line": 114
                },
                {
                    "end_outermost_loop": 115,
                    "end_region_line": 119,
                    "line": "        x = self.c_fc(x)\n",
                    "lineno": 115,
                    "memory_samples": [
                        [
                            6679806210,
                            376.76651096343994
                        ],
                        [
                            6905387144,
                            378.92621421813965
                        ],
                        [
                            7299733260,
                            348.2486505508423
                        ],
                        [
                            14398935906,
                            614.4431610107422
                        ],
                        [
                            14573411956,
                            680.0807571411133
                        ],
                        [
                            19148594604,
                            876.0214881896973
                        ],
                        [
                            19534867406,
                            743.9509239196777
                        ],
                        [
                            19803936860,
                            846.0188102722168
                        ],
                        [
                            19859416482,
                            869.456226348877
                        ],
                        [
                            20594448897,
                            859.0618629455566
                        ],
                        [
                            20926610514,
                            694.3679084777832
                        ],
                        [
                            21347362370,
                            852.610408782959
                        ],
                        [
                            21406402719,
                            872.3913078308105
                        ],
                        [
                            22365808671,
                            932.3017692565918
                        ],
                        [
                            22883299016,
                            803.8947792053223
                        ],
                        [
                            23781819210,
                            938.0472221374512
                        ],
                        [
                            23980280741,
                            1034.2509880065918
                        ],
                        [
                            24536403236,
                            929.902530670166
                        ],
                        [
                            24799319746,
                            1032.1376914978027
                        ],
                        [
                            25536524248,
                            939.5468254089355
                        ],
                        [
                            25864887694,
                            1068.4741325378418
                        ],
                        [
                            28041661846,
                            1103.5285835266113
                        ],
                        [
                            28675460821,
                            1084.273593902588
                        ],
                        [
                            28980272945,
                            989.5971794128418
                        ],
                        [
                            30616157237,
                            899.2740440368652
                        ],
                        [
                            31053410529,
                            1095.5920372009277
                        ],
                        [
                            31852174865,
                            1134.988338470459
                        ],
                        [
                            32602705781,
                            1229.4306449890137
                        ],
                        [
                            32829824241,
                            1326.6403541564941
                        ],
                        [
                            34008835234,
                            1367.9644203186035
                        ],
                        [
                            34348101742,
                            1044.005702972412
                        ],
                        [
                            34548522477,
                            632.8804130554199
                        ],
                        [
                            34780440973,
                            740.7275276184082
                        ],
                        [
                            35506304845,
                            1090.1701774597168
                        ],
                        [
                            36771862311,
                            587.3974647521973
                        ],
                        [
                            36850389342,
                            622.9725914001465
                        ],
                        [
                            36929574195,
                            665.1804161071777
                        ],
                        [
                            37598978311,
                            954.0311470031738
                        ],
                        [
                            38524732973,
                            1324.7573585510254
                        ],
                        [
                            38778312323,
                            1425.037540435791
                        ],
                        [
                            39358213796,
                            679.9532432556152
                        ],
                        [
                            39778976741,
                            868.6883277893066
                        ],
                        [
                            41020372326,
                            1523.9503746032715
                        ],
                        [
                            41935375793,
                            1426.5256080627441
                        ],
                        [
                            43055500405,
                            1369.690372467041
                        ],
                        [
                            45619403844,
                            1692.8216514587402
                        ],
                        [
                            46338049860,
                            1704.601978302002
                        ],
                        [
                            46569140637,
                            1194.5543479919434
                        ],
                        [
                            46801667004,
                            491.70468521118164
                        ],
                        [
                            47218781850,
                            566.7033424377441
                        ],
                        [
                            47360567735,
                            523.0219535827637
                        ],
                        [
                            47450541317,
                            565.2184181213379
                        ],
                        [
                            47470216871,
                            573.6578254699707
                        ],
                        [
                            48266084924,
                            496.9717445373535
                        ],
                        [
                            50363628367,
                            540.6532096862793
                        ],
                        [
                            54937043552,
                            597.6421928405762
                        ],
                        [
                            58412682390,
                            730.876880645752
                        ],
                        [
                            58807468427,
                            840.8873329162598
                        ],
                        [
                            58859811836,
                            857.414478302002
                        ],
                        [
                            59018959548,
                            854.9531898498535
                        ],
                        [
                            59141721952,
                            621.0142021179199
                        ],
                        [
                            59190237748,
                            636.7160301208496
                        ],
                        [
                            59610641237,
                            854.7017784118652
                        ],
                        [
                            60032722268,
                            878.5615119934082
                        ],
                        [
                            60090702789,
                            898.6626014709473
                        ],
                        [
                            60241539568,
                            955.2378120422363
                        ],
                        [
                            60600338207,
                            1096.817569732666
                        ],
                        [
                            60837147707,
                            906.034854888916
                        ],
                        [
                            61041318653,
                            988.0776786804199
                        ],
                        [
                            61196138190,
                            1052.539951324463
                        ],
                        [
                            61712189591,
                            962.1787605285645
                        ],
                        [
                            62327842542,
                            909.0175819396973
                        ],
                        [
                            62734199421,
                            719.3743324279785
                        ],
                        [
                            62836300478,
                            763.2552299499512
                        ],
                        [
                            63500808502,
                            1067.0431480407715
                        ],
                        [
                            64309953028,
                            873.497013092041
                        ],
                        [
                            64435511618,
                            875.6411018371582
                        ],
                        [
                            64505795037,
                            828.7300453186035
                        ],
                        [
                            65187134757,
                            1062.1850242614746
                        ],
                        [
                            66202800700,
                            884.2879600524902
                        ],
                        [
                            66391360745,
                            976.0211601257324
                        ],
                        [
                            66881851529,
                            1185.1372871398926
                        ],
                        [
                            68268415666,
                            1051.6936683654785
                        ],
                        [
                            68537410090,
                            1154.3858528137207
                        ],
                        [
                            69323792276,
                            1087.826328277588
                        ],
                        [
                            69772017844,
                            1284.7239799499512
                        ],
                        [
                            71270842050,
                            1113.1556816101074
                        ],
                        [
                            71923537528,
                            1384.9202690124512
                        ],
                        [
                            72003677117,
                            1353.3729209899902
                        ],
                        [
                            72811364830,
                            911.2402839660645
                        ],
                        [
                            73596945898,
                            1156.418888092041
                        ],
                        [
                            73658135915,
                            1187.9220924377441
                        ],
                        [
                            73773803238,
                            1250.928623199463
                        ],
                        [
                            73954356370,
                            1345.4384422302246
                        ],
                        [
                            74011474821,
                            1376.941608428955
                        ],
                        [
                            74439524951,
                            874.4117393493652
                        ],
                        [
                            74585243108,
                            893.0428504943848
                        ],
                        [
                            75011778600,
                            998.4078407287598
                        ],
                        [
                            75227563439,
                            1095.5427131652832
                        ],
                        [
                            76111275438,
                            1480.9131889343262
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.42993656039460615,
                    "n_cpu_percent_c": 1.764574291918244,
                    "n_cpu_percent_python": 0.4361108015740452,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 12161.787386894226,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 0.0003629616893537136,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.07599586731174639,
                    "start_outermost_loop": 115,
                    "start_region_line": 114
                },
                {
                    "end_outermost_loop": 116,
                    "end_region_line": 119,
                    "line": "        x = new_gelu(x)\n",
                    "lineno": 116,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4170259349036269,
                    "n_cpu_percent_c": 2.380503332789292,
                    "n_cpu_percent_python": 0.5562363419571558,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.015681916998120073,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 116,
                    "start_region_line": 114
                },
                {
                    "end_outermost_loop": 117,
                    "end_region_line": 119,
                    "line": "        x = self.c_proj(x)\n",
                    "lineno": 117,
                    "memory_samples": [
                        [
                            6684835854,
                            377.70386600494385
                        ],
                        [
                            7442801414,
                            388.79785919189453
                        ],
                        [
                            7634295684,
                            360.1156406402588
                        ],
                        [
                            7809519614,
                            416.3849906921387
                        ],
                        [
                            9291198521,
                            464.772198677063
                        ],
                        [
                            10181849248,
                            498.1605863571167
                        ],
                        [
                            17208660278,
                            572.9814567565918
                        ],
                        [
                            17940009193,
                            667.5734443664551
                        ],
                        [
                            18643643869,
                            674.682689666748
                        ],
                        [
                            18757564940,
                            714.5568504333496
                        ],
                        [
                            19163259131,
                            878.4828453063965
                        ],
                        [
                            23097979621,
                            881.2984886169434
                        ],
                        [
                            23221858772,
                            929.2282066345215
                        ],
                        [
                            23535013319,
                            814.2766990661621
                        ],
                        [
                            25562391296,
                            942.4771842956543
                        ],
                        [
                            25694126353,
                            993.9935646057129
                        ],
                        [
                            25958738466,
                            1099.4793434143066
                        ],
                        [
                            27411944950,
                            908.406192779541
                        ],
                        [
                            28272413139,
                            900.6832695007324
                        ],
                        [
                            28629014204,
                            1055.3864479064941
                        ],
                        [
                            29699633861,
                            951.3753547668457
                        ],
                        [
                            29843910805,
                            1010.8691444396973
                        ],
                        [
                            30068087900,
                            858.6025428771973
                        ],
                        [
                            30266291875,
                            962.2177543640137
                        ],
                        [
                            30710942005,
                            934.091869354248
                        ],
                        [
                            31408576658,
                            881.6315574645996
                        ],
                        [
                            32556864317,
                            1200.36812210083
                        ],
                        [
                            32781735083,
                            1297.5777473449707
                        ],
                        [
                            32933292991,
                            1362.383975982666
                        ],
                        [
                            33278430985,
                            1035.5742988586426
                        ],
                        [
                            33652266202,
                            1204.817096710205
                        ],
                        [
                            34113056025,
                            1404.6727714538574
                        ],
                        [
                            34728350179,
                            707.3211555480957
                        ],
                        [
                            36096895590,
                            1358.8219718933105
                        ],
                        [
                            36875860051,
                            632.7119483947754
                        ],
                        [
                            37378383287,
                            849.3494834899902
                        ],
                        [
                            37462343641,
                            885.4559211730957
                        ],
                        [
                            37545309087,
                            921.5622978210449
                        ],
                        [
                            38305087982,
                            1228.232135772705
                        ],
                        [
                            38804918131,
                            1428.7927207946777
                        ],
                        [
                            39214482121,
                            616.6907997131348
                        ],
                        [
                            40509642700,
                            1245.91206741333
                        ],
                        [
                            40711704203,
                            1351.676700592041
                        ],
                        [
                            41705519102,
                            1310.664394378662
                        ],
                        [
                            42144507695,
                            1510.6577949523926
                        ],
                        [
                            42231584080,
                            1550.6547355651855
                        ],
                        [
                            42318619887,
                            1590.6517601013184
                        ],
                        [
                            42729942211,
                            1209.9569664001465
                        ],
                        [
                            45990171087,
                            1730.25777053833
                        ],
                        [
                            47677035282,
                            529.0259742736816
                        ],
                        [
                            48023695796,
                            527.5156364440918
                        ],
                        [
                            48099433893,
                            557.9920082092285
                        ],
                        [
                            48147433452,
                            576.2774620056152
                        ],
                        [
                            48494139777,
                            572.9259071350098
                        ],
                        [
                            48831289725,
                            562.2280387878418
                        ],
                        [
                            48911938874,
                            595.048038482666
                        ],
                        [
                            50496733094,
                            610.0408515930176
                        ],
                        [
                            59626353008,
                            857.5151100158691
                        ],
                        [
                            63127634988,
                            908.3186683654785
                        ],
                        [
                            63401631892,
                            1021.6941184997559
                        ],
                        [
                            63517870585,
                            1070.1495246887207
                        ],
                        [
                            63574537638,
                            1089.718677520752
                        ],
                        [
                            63763911449,
                            1082.065586090088
                        ],
                        [
                            64649937750,
                            878.728443145752
                        ],
                        [
                            65088441170,
                            1017.0583992004395
                        ],
                        [
                            65525670338,
                            1183.0604972839355
                        ],
                        [
                            65793493329,
                            638.1630516052246
                        ],
                        [
                            65839446711,
                            659.8219871520996
                        ],
                        [
                            66049701790,
                            784.525089263916
                        ],
                        [
                            66477069332,
                            1008.424243927002
                        ],
                        [
                            66536821952,
                            1034.146541595459
                        ],
                        [
                            66843436527,
                            1162.75590133667
                        ],
                        [
                            67440275172,
                            1109.670825958252
                        ],
                        [
                            67632958163,
                            1194.6499061584473
                        ],
                        [
                            67699942660,
                            1215.71529006958
                        ],
                        [
                            68022896647,
                            1348.2709007263184
                        ],
                        [
                            68696131772,
                            1212.4753303527832
                        ],
                        [
                            69347743207,
                            1091.3428001403809
                        ],
                        [
                            69733012763,
                            1260.1121635437012
                        ],
                        [
                            69994992438,
                            1372.6252174377441
                        ],
                        [
                            70601078036,
                            782.8763542175293
                        ],
                        [
                            71070864045,
                            989.1459541320801
                        ],
                        [
                            71519271783,
                            1209.7999153137207
                        ],
                        [
                            71806769798,
                            1328.9692878723145
                        ],
                        [
                            72108342622,
                            1349.557949066162
                        ],
                        [
                            72531071592,
                            933.8062705993652
                        ],
                        [
                            72757390911,
                            876.9050025939941
                        ],
                        [
                            72841529457,
                            914.9325370788574
                        ],
                        [
                            72914640317,
                            957.0265312194824
                        ],
                        [
                            73066793801,
                            1018.3143348693848
                        ],
                        [
                            73142974823,
                            1030.4587440490723
                        ],
                        [
                            73217246939,
                            1076.2448463439941
                        ],
                        [
                            73928453673,
                            1317.685878753662
                        ],
                        [
                            74533008573,
                            910.5995674133301
                        ],
                        [
                            74869129786,
                            937.4607887268066
                        ],
                        [
                            74969311832,
                            969.839054107666
                        ],
                        [
                            75112815361,
                            1034.595890045166
                        ],
                        [
                            75606094598,
                            1239.9520683288574
                        ],
                        [
                            75694554255,
                            1280.1831855773926
                        ],
                        [
                            75964860394,
                            1403.1739540100098
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4258490781657643,
                    "n_cpu_percent_c": 1.9478772890559204,
                    "n_cpu_percent_python": 0.5099682760341657,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.1171875,
                    "n_malloc_mb": 10.1171875,
                    "n_mallocs": 0,
                    "n_peak_mb": 10.1171875,
                    "n_python_fraction": 0.0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 6.32196908528924e-05,
                    "start_outermost_loop": 117,
                    "start_region_line": 114
                },
                {
                    "end_outermost_loop": 118,
                    "end_region_line": 119,
                    "line": "        x = self.dropout(x)\n",
                    "lineno": 118,
                    "memory_samples": [
                        [
                            15081430124,
                            473.7902183532715
                        ],
                        [
                            16213321464,
                            758.1373481750488
                        ],
                        [
                            16798305755,
                            731.6868858337402
                        ],
                        [
                            17621474253,
                            761.3174476623535
                        ],
                        [
                            22768094218,
                            747.7036552429199
                        ],
                        [
                            23536020590,
                            801.3314933776855
                        ],
                        [
                            24831343130,
                            1022.0643424987793
                        ],
                        [
                            26436258252,
                            886.5782356262207
                        ],
                        [
                            26860555624,
                            1046.7873725891113
                        ],
                        [
                            26998532734,
                            1101.1865196228027
                        ],
                        [
                            27280773402,
                            837.5682334899902
                        ],
                        [
                            27411947580,
                            896.2187156677246
                        ],
                        [
                            27628721973,
                            977.2793464660645
                        ],
                        [
                            27698200805,
                            1008.3623924255371
                        ],
                        [
                            27995443889,
                            1117.4595832824707
                        ],
                        [
                            28344388434,
                            920.2545356750488
                        ],
                        [
                            28786181114,
                            886.4108924865723
                        ],
                        [
                            30068090776,
                            842.1416282653809
                        ],
                        [
                            30266294351,
                            945.1318397521973
                        ],
                        [
                            30782331713,
                            955.046314239502
                        ],
                        [
                            31296996710,
                            791.6920967102051
                        ],
                        [
                            31700718738,
                            1029.3112678527832
                        ],
                        [
                            32183209614,
                            1008.7856407165527
                        ],
                        [
                            32259369536,
                            1044.2950172424316
                        ],
                        [
                            32408872167,
                            1117.8354530334473
                        ],
                        [
                            32631275332,
                            1215.0447959899902
                        ],
                        [
                            32933295343,
                            1344.6574592590332
                        ],
                        [
                            33278433548,
                            1017.8477592468262
                        ],
                        [
                            34038663582,
                            1353.6369895935059
                        ],
                        [
                            34808706414,
                            727.724536895752
                        ],
                        [
                            35044323835,
                            839.582332611084
                        ],
                        [
                            35855915400,
                            1232.940731048584
                        ],
                        [
                            36096898399,
                            1338.4235572814941
                        ],
                        [
                            36256552655,
                            1408.7456321716309
                        ],
                        [
                            36799077666,
                            576.6756782531738
                        ],
                        [
                            37040389091,
                            684.525707244873
                        ],
                        [
                            37977633982,
                            1072.7207374572754
                        ],
                        [
                            38057431107,
                            1106.1476097106934
                        ],
                        [
                            38223517496,
                            1173.000675201416
                        ],
                        [
                            38387466283,
                            1239.8539848327637
                        ],
                        [
                            38639311335,
                            1340.134204864502
                        ],
                        [
                            38721886006,
                            1373.5609397888184
                        ],
                        [
                            39554916857,
                            744.1865653991699
                        ],
                        [
                            39807832470,
                            857.8023414611816
                        ],
                        [
                            39977370103,
                            933.8587303161621
                        ],
                        [
                            40062672580,
                            998.8400611877441
                        ],
                        [
                            40376453830,
                            1152.144359588623
                        ],
                        [
                            40509645509,
                            1222.6542778015137
                        ],
                        [
                            40711714130,
                            1328.4189109802246
                        ],
                        [
                            40777847042,
                            1363.6737632751465
                        ],
                        [
                            40844983246,
                            1398.9285774230957
                        ],
                        [
                            41532516571,
                            1215.4361000061035
                        ],
                        [
                            41791616444,
                            1335.4269828796387
                        ],
                        [
                            41878832248,
                            1375.4240074157715
                        ],
                        [
                            41967108285,
                            1415.4210319519043
                        ],
                        [
                            42055002019,
                            1455.4181098937988
                        ],
                        [
                            42144511002,
                            1495.4234428405762
                        ],
                        [
                            42231586679,
                            1535.4203834533691
                        ],
                        [
                            42640535212,
                            1149.623607635498
                        ],
                        [
                            42993846734,
                            1317.479335784912
                        ],
                        [
                            43183901685,
                            1399.473445892334
                        ],
                        [
                            43637248980,
                            1604.4587364196777
                        ],
                        [
                            47063726844,
                            504.6970329284668
                        ],
                        [
                            47227013212,
                            562.6601448059082
                        ],
                        [
                            48050257972,
                            532.0887794494629
                        ],
                        [
                            64902161539,
                            912.5607109069824
                        ],
                        [
                            65088444232,
                            1004.167797088623
                        ],
                        [
                            65212740553,
                            1052.5179252624512
                        ],
                        [
                            65752266793,
                            596.8159446716309
                        ],
                        [
                            66968927204,
                            1195.8246879577637
                        ],
                        [
                            67440277985,
                            1096.0770988464355
                        ],
                        [
                            67699945397,
                            1202.1215019226074
                        ],
                        [
                            67894123554,
                            1281.6552772521973
                        ],
                        [
                            69348559354,
                            1077.280361175537
                        ],
                        [
                            69475758613,
                            1133.5370597839355
                        ],
                        [
                            69733015170,
                            1246.0496864318848
                        ],
                        [
                            69931509152,
                            1330.434513092041
                        ],
                        [
                            70368262160,
                            1089.2072105407715
                        ],
                        [
                            70434677043,
                            1118.163631439209
                        ],
                        [
                            70526504115,
                            732.4732551574707
                        ],
                        [
                            71299463915,
                            1094.984577178955
                        ],
                        [
                            71445394915,
                            1158.2029609680176
                        ],
                        [
                            71591606587,
                            1217.7876014709473
                        ],
                        [
                            71664104031,
                            1247.579891204834
                        ],
                        [
                            71880661954,
                            1336.9568519592285
                        ],
                        [
                            72457300897,
                            888.3967781066895
                        ],
                        [
                            72531074182,
                            919.0406684875488
                        ],
                        [
                            72841533706,
                            900.166934967041
                        ],
                        [
                            73142978378,
                            1015.6931419372559
                        ],
                        [
                            73986007390,
                            1334.1893119812012
                        ],
                        [
                            74044688943,
                            1365.6924781799316
                        ],
                        [
                            74465166079,
                            862.9868278503418
                        ],
                        [
                            74697444066,
                            886.0388679504395
                        ],
                        [
                            74969323501,
                            954.6047019958496
                        ],
                        [
                            75041477847,
                            986.9828681945801
                        ],
                        [
                            75256353343,
                            1084.1178550720215
                        ],
                        [
                            75694562556,
                            1255.4253959655762
                        ],
                        [
                            75784016242,
                            1296.4224433898926
                        ],
                        [
                            75964863503,
                            1378.4161643981934
                        ],
                        [
                            76325624237,
                            1542.4040031433105
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4264887976251439,
                    "n_cpu_percent_c": 2.1018701233052743,
                    "n_cpu_percent_python": 0.6014108634609817,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 118,
                    "start_region_line": 114
                },
                {
                    "end_outermost_loop": 119,
                    "end_region_line": 119,
                    "line": "        return x\n",
                    "lineno": 119,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 119,
                    "start_region_line": 114
                },
                {
                    "end_outermost_loop": 120,
                    "end_region_line": 120,
                    "line": "\n",
                    "lineno": 120,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 120,
                    "start_region_line": 120
                },
                {
                    "end_outermost_loop": 134,
                    "end_region_line": 134,
                    "line": "class Block(nn.Module):\n",
                    "lineno": 121,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 121,
                    "start_region_line": 121
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 134,
                    "line": "\n",
                    "lineno": 122,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 122,
                    "start_region_line": 121
                },
                {
                    "end_outermost_loop": 128,
                    "end_region_line": 128,
                    "line": "    def __init__(self, config):\n",
                    "lineno": 123,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 123,
                    "start_region_line": 123
                },
                {
                    "end_outermost_loop": 124,
                    "end_region_line": 128,
                    "line": "        super().__init__()\n",
                    "lineno": 124,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 124,
                    "start_region_line": 123
                },
                {
                    "end_outermost_loop": 125,
                    "end_region_line": 128,
                    "line": "        self.ln_1 = LayerNorm(config.n_embd, bias=config.bias)\n",
                    "lineno": 125,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 125,
                    "start_region_line": 123
                },
                {
                    "end_outermost_loop": 126,
                    "end_region_line": 128,
                    "line": "        self.attn = CausalSelfAttention(config)\n",
                    "lineno": 126,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 126,
                    "start_region_line": 123
                },
                {
                    "end_outermost_loop": 127,
                    "end_region_line": 128,
                    "line": "        self.ln_2 = LayerNorm(config.n_embd, bias=config.bias)\n",
                    "lineno": 127,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 127,
                    "start_region_line": 123
                },
                {
                    "end_outermost_loop": 128,
                    "end_region_line": 128,
                    "line": "        self.mlp = MLP(config)\n",
                    "lineno": 128,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 128,
                    "start_region_line": 123
                },
                {
                    "end_outermost_loop": 129,
                    "end_region_line": 134,
                    "line": "\n",
                    "lineno": 129,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 121
                },
                {
                    "end_outermost_loop": 134,
                    "end_region_line": 134,
                    "line": "    def forward(self, x, attn_mask, kvcache=None):\n",
                    "lineno": 130,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.35666744611976325,
                    "n_cpu_percent_c": 0.02386792212743563,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 130,
                    "start_region_line": 130
                },
                {
                    "end_outermost_loop": 131,
                    "end_region_line": 134,
                    "line": "        y, att, cache_ele = self.attn(self.ln_1(x), attn_mask, kvcache) \n",
                    "lineno": 131,
                    "memory_samples": [
                        [
                            12746237345,
                            579.2608680725098
                        ],
                        [
                            12771589469,
                            594.2639398574829
                        ],
                        [
                            17347953484,
                            641.7654075622559
                        ],
                        [
                            18991911999,
                            800.7047386169434
                        ],
                        [
                            19352228718,
                            663.558895111084
                        ],
                        [
                            20923162453,
                            677.2255592346191
                        ],
                        [
                            21950538608,
                            756.5382652282715
                        ],
                        [
                            22187337325,
                            849.2727928161621
                        ],
                        [
                            22425191222,
                            942.0074729919434
                        ],
                        [
                            23976945600,
                            1020.1874809265137
                        ],
                        [
                            24073889722,
                            1069.6954460144043
                        ],
                        [
                            24472922680,
                            885.6553916931152
                        ],
                        [
                            25799564464,
                            1029.156894683838
                        ],
                        [
                            28452976192,
                            978.6606941223145
                        ],
                        [
                            28528030221,
                            1007.5482215881348
                        ],
                        [
                            28671043185,
                            1065.3236198425293
                        ],
                        [
                            29326518567,
                            775.405216217041
                        ],
                        [
                            29530793762,
                            872.2553749084473
                        ],
                        [
                            29742465382,
                            961.4960899353027
                        ],
                        [
                            29955975292,
                            1047.572452545166
                        ],
                        [
                            30537421632,
                            842.1743812561035
                        ],
                        [
                            30612523058,
                            879.5896949768066
                        ],
                        [
                            31433826759,
                            896.728588104248
                        ],
                        [
                            31548718005,
                            959.7380638122559
                        ],
                        [
                            31666226810,
                            1022.7471122741699
                        ],
                        [
                            33471751550,
                            1110.2746391296387
                        ],
                        [
                            34004854975,
                            1346.838665008545
                        ],
                        [
                            34543713879,
                            615.5945014953613
                        ],
                        [
                            34619015438,
                            652.3459281921387
                        ],
                        [
                            35257673329,
                            935.3607978820801
                        ],
                        [
                            35740567487,
                            1190.7468299865723
                        ],
                        [
                            35820384302,
                            1225.9078330993652
                        ],
                        [
                            35901300907,
                            1261.0686683654785
                        ],
                        [
                            35981195657,
                            1296.2297554016113
                        ],
                        [
                            36061379323,
                            1331.390682220459
                        ],
                        [
                            36766931247,
                            569.5256156921387
                        ],
                        [
                            36925480812,
                            641.2070045471191
                        ],
                        [
                            37947783799,
                            1065.3325462341309
                        ],
                        [
                            38027490346,
                            1098.7592430114746
                        ],
                        [
                            38192206773,
                            1165.6124839782715
                        ],
                        [
                            39522340321,
                            736.6146049499512
                        ],
                        [
                            39605782093,
                            774.174129486084
                        ],
                        [
                            39860249002,
                            888.2586402893066
                        ],
                        [
                            40343937732,
                            1144.3927116394043
                        ],
                        [
                            40613784565,
                            1285.4124565124512
                        ],
                        [
                            40746338759,
                            1355.9220924377441
                        ],
                        [
                            42016817175,
                            1447.4789085388184
                        ],
                        [
                            42779683399,
                            1227.3625602722168
                        ],
                        [
                            43144324831,
                            1391.3507041931152
                        ],
                        [
                            43322122862,
                            1473.3448066711426
                        ],
                        [
                            43409070407,
                            1514.341968536377
                        ],
                        [
                            58362665781,
                            699.7059898376465
                        ],
                        [
                            58553798194,
                            770.8736991882324
                        ],
                        [
                            58602059964,
                            785.9701042175293
                        ],
                        [
                            58856448670,
                            840.9880027770996
                        ],
                        [
                            59574305603,
                            815.9831581115723
                        ],
                        [
                            60832324704,
                            888.5536308288574
                        ],
                        [
                            60933069849,
                            929.5750923156738
                        ],
                        [
                            60984915789,
                            953.0157127380371
                        ],
                        [
                            61090414815,
                            994.0377616882324
                        ],
                        [
                            61296055560,
                            1076.0804405212402
                        ],
                        [
                            61815732560,
                            986.7896156311035
                        ],
                        [
                            62323750248,
                            887.1379203796387
                        ],
                        [
                            62438787900,
                            931.0588645935059
                        ],
                        [
                            62577047218,
                            632.2822685241699
                        ],
                        [
                            62630135261,
                            654.2625389099121
                        ],
                        [
                            62729933197,
                            701.1899833679199
                        ],
                        [
                            63270269658,
                            954.3857307434082
                        ],
                        [
                            63325870967,
                            973.955005645752
                        ],
                        [
                            63382369369,
                            999.7357978820801
                        ],
                        [
                            64073423468,
                            760.9407539367676
                        ],
                        [
                            64187938205,
                            807.775074005127
                        ],
                        [
                            64306040805,
                            854.6095390319824
                        ],
                        [
                            66386569528,
                            951.0243110656738
                        ],
                        [
                            66630402349,
                            1057.2917366027832
                        ],
                        [
                            66690762726,
                            1083.013729095459
                        ],
                        [
                            66814552306,
                            1134.4575538635254
                        ],
                        [
                            67066592734,
                            1237.3451805114746
                        ],
                        [
                            67347104709,
                            1059.4667167663574
                        ],
                        [
                            67862170865,
                            1271.5561180114746
                        ],
                        [
                            67927965108,
                            1298.067096710205
                        ],
                        [
                            68401227075,
                            1079.1096458435059
                        ],
                        [
                            68532344522,
                            1133.740566253662
                        ],
                        [
                            68667144461,
                            1188.3721046447754
                        ],
                        [
                            68934179157,
                            1297.63529586792
                        ],
                        [
                            69001032993,
                            1328.4085121154785
                        ],
                        [
                            69318451149,
                            1066.8295402526855
                        ],
                        [
                            70838717532,
                            877.3527641296387
                        ],
                        [
                            70906966642,
                            906.3099479675293
                        ],
                        [
                            70975236318,
                            935.266300201416
                        ],
                        [
                            71338606012,
                            1117.6081275939941
                        ],
                        [
                            71411323967,
                            1147.4005546569824
                        ],
                        [
                            71773746099,
                            1296.3621635437012
                        ],
                        [
                            72348461062,
                            843.0434455871582
                        ],
                        [
                            73474849014,
                            1071.009334564209
                        ],
                        [
                            73651347730,
                            1165.5189933776855
                        ],
                        [
                            74065978258,
                            1386.0417366027832
                        ],
                        [
                            74352874008,
                            815.4303321838379
                        ],
                        [
                            75150066325,
                            1040.4097938537598
                        ],
                        [
                            75923214473,
                            1370.293544769287
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.39744211431831766,
                    "n_cpu_percent_c": 0.28198221025259174,
                    "n_cpu_percent_python": 0.07385747446012052,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 131,
                    "start_region_line": 130
                },
                {
                    "end_outermost_loop": 132,
                    "end_region_line": 134,
                    "line": "        x = x + y\n",
                    "lineno": 132,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 132,
                    "start_region_line": 130
                },
                {
                    "end_outermost_loop": 133,
                    "end_region_line": 134,
                    "line": "        x = x + self.mlp(self.ln_2(x))\n",
                    "lineno": 133,
                    "memory_samples": [
                        [
                            5491471770,
                            268.4931411743164
                        ],
                        [
                            5549103827,
                            286.08445167541504
                        ],
                        [
                            5568912263,
                            291.9480037689209
                        ],
                        [
                            5632664426,
                            270.5251359939575
                        ],
                        [
                            5679054377,
                            283.6899538040161
                        ],
                        [
                            6009863430,
                            261.59152030944824
                        ],
                        [
                            7282163769,
                            336.3425226211548
                        ],
                        [
                            8241090525,
                            445.30660915374756
                        ],
                        [
                            8267296712,
                            454.3324270248413
                        ],
                        [
                            8348736852,
                            485.2781410217285
                        ],
                        [
                            8457644409,
                            526.5388898849487
                        ],
                        [
                            9148578901,
                            544.0267419815063
                        ],
                        [
                            9169208547,
                            555.2799091339111
                        ],
                        [
                            10113618765,
                            467.27499866485596
                        ],
                        [
                            10389445249,
                            567.7870683670044
                        ],
                        [
                            10423051013,
                            580.4465379714966
                        ],
                        [
                            10491078507,
                            605.7647199630737
                        ],
                        [
                            10669977307,
                            496.7540874481201
                        ],
                        [
                            10776471693,
                            536.1376533508301
                        ],
                        [
                            10974658985,
                            614.9039096832275
                        ],
                        [
                            11122124285,
                            490.09331798553467
                        ],
                        [
                            11294670433,
                            557.8426752090454
                        ],
                        [
                            11760443377,
                            552.3776340484619
                        ],
                        [
                            12468455915,
                            629.9241809844971
                        ],
                        [
                            12762854969,
                            583.0114936828613
                        ],
                        [
                            13302493761,
                            604.7603845596313
                        ],
                        [
                            13590615187,
                            502.6382074356079
                        ],
                        [
                            15427516389,
                            609.2463445663452
                        ],
                        [
                            16749397040,
                            713.4021263122559
                        ],
                        [
                            17758608710,
                            836.3297157287598
                        ],
                        [
                            18484758781,
                            874.2319068908691
                        ],
                        [
                            22150370899,
                            831.4817161560059
                        ],
                        [
                            24099168070,
                            1075.3217277526855
                        ],
                        [
                            24500902498,
                            891.3986854553223
                        ],
                        [
                            24564632551,
                            919.8288612365723
                        ],
                        [
                            25024268597,
                            1095.868953704834
                        ],
                        [
                            25630423794,
                            952.9733695983887
                        ],
                        [
                            29421566770,
                            812.1217308044434
                        ],
                        [
                            29700649762,
                            934.9140968322754
                        ],
                        [
                            31009416927,
                            1047.8843879699707
                        ],
                        [
                            32557871351,
                            1182.6412391662598
                        ],
                        [
                            34488813319,
                            579.077808380127
                        ],
                        [
                            35537439283,
                            1073.2882652282715
                        ],
                        [
                            40577967282,
                            1257.9087715148926
                        ],
                        [
                            43447929926,
                            1522.4646949768066
                        ],
                        [
                            44172757782,
                            1643.9905586242676
                        ],
                        [
                            44189390074,
                            1647.1576118469238
                        ],
                        [
                            44245346934,
                            1655.6779899597168
                        ],
                        [
                            44293591126,
                            1664.477108001709
                        ],
                        [
                            44384952646,
                            1652.0783805847168
                        ],
                        [
                            44576658001,
                            1687.3705253601074
                        ],
                        [
                            45015873401,
                            1666.2711753845215
                        ],
                        [
                            45103959412,
                            1687.3913536071777
                        ],
                        [
                            45229293800,
                            1719.0508842468262
                        ],
                        [
                            45591944814,
                            1681.6383171081543
                        ],
                        [
                            45689556153,
                            1705.6950340270996
                        ],
                        [
                            46189285459,
                            1719.0499000549316
                        ],
                        [
                            46411018566,
                            1720.6019325256348
                        ],
                        [
                            47041915513,
                            496.6092720031738
                        ],
                        [
                            47460604902,
                            560.9995307922363
                        ],
                        [
                            48173322941,
                            579.325626373291
                        ],
                        [
                            48469723470,
                            558.6856651306152
                        ],
                        [
                            48807892935,
                            547.4605674743652
                        ],
                        [
                            48938513669,
                            598.3307991027832
                        ],
                        [
                            49545755060,
                            531.7988395690918
                        ],
                        [
                            50011659060,
                            549.8680076599121
                        ],
                        [
                            50396863372,
                            546.2804832458496
                        ],
                        [
                            50582883606,
                            643.7979469299316
                        ],
                        [
                            50728666799,
                            542.1561546325684
                        ],
                        [
                            50953211206,
                            623.3821830749512
                        ],
                        [
                            51235619792,
                            561.3841209411621
                        ],
                        [
                            51721678605,
                            569.1598701477051
                        ],
                        [
                            52058897781,
                            679.9206275939941
                        ],
                        [
                            52532290359,
                            678.3510780334473
                        ],
                        [
                            52695972431,
                            559.1489448547363
                        ],
                        [
                            53389876175,
                            606.7678565979004
                        ],
                        [
                            53874057476,
                            574.3655433654785
                        ],
                        [
                            55040145287,
                            619.5099067687988
                        ],
                        [
                            55312128234,
                            722.1185340881348
                        ],
                        [
                            55940088143,
                            582.1904258728027
                        ],
                        [
                            57489329560,
                            682.9460029602051
                        ],
                        [
                            59208300338,
                            628.454647064209
                        ],
                        [
                            60158379730,
                            906.993953704834
                        ],
                        [
                            60310659080,
                            969.3118553161621
                        ],
                        [
                            61783356008,
                            971.4474906921387
                        ],
                        [
                            61838677820,
                            995.6582374572754
                        ],
                        [
                            63575207920,
                            1073.8745765686035
                        ],
                        [
                            65027561442,
                            976.769603729248
                        ],
                        [
                            66050773137,
                            771.3997688293457
                        ],
                        [
                            66183100896,
                            849.5037422180176
                        ],
                        [
                            66659255575,
                            1067.2149543762207
                        ],
                        [
                            68023519373,
                            1334.676830291748
                        ],
                        [
                            68430680652,
                            1089.3841667175293
                        ],
                        [
                            68697191746,
                            1198.646884918213
                        ],
                        [
                            70298224517,
                            1056.675624847412
                        ],
                        [
                            70601758106,
                            768.579158782959
                        ],
                        [
                            71736516579,
                            1277.3721885681152
                        ],
                        [
                            72035183922,
                            1290.6935539245605
                        ],
                        [
                            73747767335,
                            1208.1762962341309
                        ],
                        [
                            76612720784,
                            1577.1843299865723
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.42561923612759,
                    "n_cpu_percent_c": 1.5403528471205048,
                    "n_cpu_percent_python": 0.42555973379402795,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 133,
                    "start_region_line": 130
                },
                {
                    "end_outermost_loop": 134,
                    "end_region_line": 134,
                    "line": "        return x, att, cache_ele\n",
                    "lineno": 134,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 134,
                    "start_region_line": 130
                },
                {
                    "end_outermost_loop": 135,
                    "end_region_line": 135,
                    "line": "\n",
                    "lineno": 135,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 135,
                    "start_region_line": 135
                },
                {
                    "end_outermost_loop": 156,
                    "end_region_line": 156,
                    "line": "class AgeEncoding(nn.Module):\n",
                    "lineno": 136,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 136,
                    "start_region_line": 136
                },
                {
                    "end_outermost_loop": 137,
                    "end_region_line": 156,
                    "line": "\n",
                    "lineno": 137,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 137,
                    "start_region_line": 136
                },
                {
                    "end_outermost_loop": 143,
                    "end_region_line": 143,
                    "line": "    def __init__(self, config, max_dim: int = 1024):\n",
                    "lineno": 138,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 138,
                    "start_region_line": 138
                },
                {
                    "end_outermost_loop": 139,
                    "end_region_line": 143,
                    "line": "        super().__init__()\n",
                    "lineno": 139,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 139,
                    "start_region_line": 138
                },
                {
                    "end_outermost_loop": 140,
                    "end_region_line": 143,
                    "line": "        div_term = torch.exp(torch.arange(0, config.n_embd, 2) * (-math.log(10000.0) / config.n_embd))\n",
                    "lineno": 140,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 140,
                    "start_region_line": 138
                },
                {
                    "end_outermost_loop": 141,
                    "end_region_line": 143,
                    "line": "        self.register_buffer('div_term', div_term)\n",
                    "lineno": 141,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 141,
                    "start_region_line": 138
                },
                {
                    "end_outermost_loop": 142,
                    "end_region_line": 143,
                    "line": "        self.n_embd = config.n_embd\n",
                    "lineno": 142,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 142,
                    "start_region_line": 138
                },
                {
                    "end_outermost_loop": 143,
                    "end_region_line": 143,
                    "line": "        self.linear = torch.nn.Linear(config.n_embd, config.n_embd, bias=False)\n",
                    "lineno": 143,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 143,
                    "start_region_line": 138
                },
                {
                    "end_outermost_loop": 144,
                    "end_region_line": 156,
                    "line": "\n",
                    "lineno": 144,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 144,
                    "start_region_line": 136
                },
                {
                    "end_outermost_loop": 156,
                    "end_region_line": 156,
                    "line": "    def forward(self, x):\n",
                    "lineno": 145,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4196515892325809,
                    "n_cpu_percent_c": 0.014081806761469664,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 145,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 146,
                    "end_region_line": 156,
                    "line": "        \"\"\"\n",
                    "lineno": 146,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 146,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 147,
                    "end_region_line": 156,
                    "line": "        Arguments:\n",
                    "lineno": 147,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 147,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 148,
                    "end_region_line": 156,
                    "line": "            x: Tensor, shape ``[seq_len, batch_size, embedding_dim]``\n",
                    "lineno": 148,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 148,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 149,
                    "end_region_line": 156,
                    "line": "        \"\"\"\n",
                    "lineno": 149,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 149,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 150,
                    "end_region_line": 156,
                    "line": "        y = torch.zeros(x.shape[0], x.shape[1], self.n_embd, device=x.device)\n",
                    "lineno": 150,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3410845103672127,
                    "n_cpu_percent_c": 0.03283597803819215,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 150,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 151,
                    "end_region_line": 156,
                    "line": "        y[..., 0::2] = torch.sin(x / 365.25 * self.div_term) #* (1-self.div_term)\n",
                    "lineno": 151,
                    "memory_samples": [
                        [
                            23462198942,
                            766.0431251525879
                        ],
                        [
                            28184602790,
                            840.9785499572754
                        ],
                        [
                            29196553372,
                            699.7103157043457
                        ],
                        [
                            30176961735,
                            896.7685966491699
                        ],
                        [
                            31221412444,
                            743.4188499450684
                        ],
                        [
                            35430493504,
                            1017.0758399963379
                        ],
                        [
                            36596914480,
                            1009.5810356140137
                        ],
                        [
                            37794289519,
                            990.5630378723145
                        ],
                        [
                            38996694783,
                            965.9665031433105
                        ],
                        [
                            40200063921,
                            1065.7336235046387
                        ],
                        [
                            41254950274,
                            1083.079288482666
                        ],
                        [
                            42528474608,
                            1092.380947113037
                        ],
                        [
                            57371751295,
                            700.3146781921387
                        ],
                        [
                            58083972219,
                            589.5450477600098
                        ],
                        [
                            58760891979,
                            803.5853996276855
                        ],
                        [
                            59478261634,
                            758.1010780334473
                        ],
                        [
                            59987748879,
                            838.5167503356934
                        ],
                        [
                            60736184994,
                            846.8890571594238
                        ],
                        [
                            61495502350,
                            855.5147972106934
                        ],
                        [
                            62286624473,
                            864.2820014953613
                        ],
                        [
                            63057887422,
                            859.7420921325684
                        ],
                        [
                            63903239839,
                            689.6166572570801
                        ],
                        [
                            64750287685,
                            933.9715843200684
                        ],
                        [
                            65677413381,
                            693.0754661560059
                        ],
                        [
                            66338536051,
                            921.2505149841309
                        ],
                        [
                            67239012305,
                            983.2594337463379
                        ],
                        [
                            68217161262,
                            996.2081489562988
                        ],
                        [
                            69197566776,
                            1006.1018867492676
                        ],
                        [
                            70204090304,
                            1012.7103385925293
                        ],
                        [
                            71214139087,
                            1050.0080070495605
                        ],
                        [
                            72295075178,
                            807.8815422058105
                        ],
                        [
                            73371313587,
                            1097.5646476745605
                        ],
                        [
                            74303713291,
                            778.4212226867676
                        ],
                        [
                            75485620308,
                            1160.8195610046387
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.35173719423503247,
                    "n_cpu_percent_c": 0.05553589696238249,
                    "n_cpu_percent_python": 0.007034045186678143,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 383.9967212677002,
                    "n_malloc_mb": 383.9967212677002,
                    "n_mallocs": 0,
                    "n_peak_mb": 383.9967212677002,
                    "n_python_fraction": 0.0008915706609187829,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0023994963034013454,
                    "start_outermost_loop": 151,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 152,
                    "end_region_line": 156,
                    "line": "        y[..., 1::2] = torch.cos(x /365.25 * self.div_term) #* (1-self.div_term)\n",
                    "lineno": 152,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.34597070624349946,
                    "n_cpu_percent_c": 0.2366235215685778,
                    "n_cpu_percent_python": 0.01758511296669536,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 152,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 153,
                    "end_region_line": 156,
                    "line": "        y = self.linear(y)\n",
                    "lineno": 153,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3277040217487893,
                    "n_cpu_percent_c": 0.10596226350115692,
                    "n_cpu_percent_python": 0.010551067780017215,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 154,
                    "end_region_line": 156,
                    "line": "        \n",
                    "lineno": 154,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 154,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 156,
                    "end_region_line": 156,
                    "line": "        #x = self.wae[:x.size(0)]\n",
                    "lineno": 155,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 145,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 156,
                    "end_region_line": 156,
                    "line": "        return y #self.dropout(x)\n",
                    "lineno": 156,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 156,
                    "start_region_line": 145
                },
                {
                    "end_outermost_loop": 157,
                    "end_region_line": 157,
                    "line": "    \n",
                    "lineno": 157,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 157,
                    "start_region_line": 157
                },
                {
                    "end_outermost_loop": 158,
                    "end_region_line": 158,
                    "line": "@dataclass\n",
                    "lineno": 158,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 158,
                    "start_region_line": 158
                },
                {
                    "end_outermost_loop": 171,
                    "end_region_line": 171,
                    "line": "class DelphiConfig:\n",
                    "lineno": 159,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 159,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 160,
                    "end_region_line": 171,
                    "line": "    block_size: int = 1024\n",
                    "lineno": 160,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 161,
                    "end_region_line": 171,
                    "line": "    vocab_size: int = 50304 # GPT-2 vocab_size of 50257, padded up to nearest multiple of 64 for efficiency\n",
                    "lineno": 161,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 161,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 162,
                    "end_region_line": 171,
                    "line": "    n_layer: int = 12\n",
                    "lineno": 162,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 162,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 163,
                    "end_region_line": 171,
                    "line": "    n_head: int = 16#12\n",
                    "lineno": 163,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 163,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 164,
                    "end_region_line": 171,
                    "line": "    n_embd: int = 1024#768\n",
                    "lineno": 164,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 164,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 165,
                    "end_region_line": 171,
                    "line": "    dropout: float = 0.0\n",
                    "lineno": 165,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 165,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 166,
                    "end_region_line": 171,
                    "line": "    token_dropout: float = 0.0\n",
                    "lineno": 166,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 166,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 167,
                    "end_region_line": 171,
                    "line": "    t_min: float = 1.0\n",
                    "lineno": 167,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 167,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 171,
                    "line": "    bias: bool = True # True: bias in Linears and LayerNorms, like GPT-2. False: a bit better and faster\n",
                    "lineno": 168,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 168,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 169,
                    "end_region_line": 171,
                    "line": "    mask_ties: bool = False\n",
                    "lineno": 169,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 169,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 170,
                    "end_region_line": 171,
                    "line": "    ignore_tokens: list = field(default_factory=lambda: [0])\n",
                    "lineno": 170,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 170,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 171,
                    "end_region_line": 171,
                    "line": "    use_kvcache: bool = True\n",
                    "lineno": 171,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 171,
                    "start_region_line": 159
                },
                {
                    "end_outermost_loop": 172,
                    "end_region_line": 172,
                    "line": "\n",
                    "lineno": 172,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 172,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 464,
                    "end_region_line": 464,
                    "line": "class Delphi(nn.Module):\n",
                    "lineno": 173,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 173,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 174,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 174,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 174,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "    def __init__(self, config):\n",
                    "lineno": 175,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 176,
                    "end_region_line": 207,
                    "line": "        super().__init__()\n",
                    "lineno": 176,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 176,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 177,
                    "end_region_line": 207,
                    "line": "        assert config.vocab_size is not None\n",
                    "lineno": 177,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 177,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 178,
                    "end_region_line": 207,
                    "line": "        assert config.block_size is not None\n",
                    "lineno": 178,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 178,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 179,
                    "end_region_line": 207,
                    "line": "        self.config = config\n",
                    "lineno": 179,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 179,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 180,
                    "end_region_line": 207,
                    "line": "\n",
                    "lineno": 180,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 180,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 181,
                    "end_region_line": 207,
                    "line": "        self.transformer = nn.ModuleDict(dict(\n",
                    "lineno": 181,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 181,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 182,
                    "end_region_line": 207,
                    "line": "            wte = nn.Embedding(config.vocab_size, config.n_embd),\n",
                    "lineno": 182,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 182,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 183,
                    "end_region_line": 207,
                    "line": "            #wpe = nn.Embedding(config.block_size, config.n_embd),\n",
                    "lineno": 183,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 183,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 184,
                    "end_region_line": 207,
                    "line": "            #wae = nn.Linear(1, config.n_embd, bias=True), ##nn.Embedding(config.block_size, config.n_embd),\n",
                    "lineno": 184,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 184,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 185,
                    "end_region_line": 207,
                    "line": "            wae = AgeEncoding(config),\n",
                    "lineno": 185,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 185,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 186,
                    "end_region_line": 207,
                    "line": "            #mlp = MLP(config),\n",
                    "lineno": 186,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 186,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 187,
                    "end_region_line": 207,
                    "line": "            token_drop = nn.Dropout(config.token_dropout),\n",
                    "lineno": 187,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 187,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 188,
                    "end_region_line": 207,
                    "line": "            drop = nn.Dropout(config.dropout),\n",
                    "lineno": 188,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 188,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 189,
                    "end_region_line": 207,
                    "line": "            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),\n",
                    "lineno": 189,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 189,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 190,
                    "end_region_line": 207,
                    "line": "            ln_f = LayerNorm(config.n_embd, bias=config.bias),\n",
                    "lineno": 190,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 190,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 191,
                    "end_region_line": 207,
                    "line": "        ))\n",
                    "lineno": 191,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 191,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 192,
                    "end_region_line": 207,
                    "line": "        self.lm_head = nn.Linear(config.n_embd, config.vocab_size, bias=False)\n",
                    "lineno": 192,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 192,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        # with weight tying when using torch.compile() some warnings get generated:\n",
                    "lineno": 193,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        # \"UserWarning: functional_call was passed multiple values for tied weights.\n",
                    "lineno": 194,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        # This behavior is deprecated and will be an error in future versions\"\n",
                    "lineno": 195,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        # not 100% sure what this is, so far seems to be harmless. TODO investigate\n",
                    "lineno": 196,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 197,
                    "end_region_line": 207,
                    "line": "        self.transformer.wte.weight = self.lm_head.weight # https://paperswithcode.com/method/weight-tying\n",
                    "lineno": 197,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 197,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 198,
                    "end_region_line": 207,
                    "line": "\n",
                    "lineno": 198,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 198,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        # init all weights\n",
                    "lineno": 199,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 200,
                    "end_region_line": 207,
                    "line": "        self.apply(self._init_weights)\n",
                    "lineno": 200,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 200,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        # apply special scaled init to the residual projections, per GPT-2 paper\n",
                    "lineno": 201,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 204,
                    "end_region_line": 204,
                    "line": "        for pn, p in self.named_parameters():\n",
                    "lineno": 202,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 202,
                    "start_region_line": 202
                },
                {
                    "end_outermost_loop": 204,
                    "end_region_line": 204,
                    "line": "            if pn.endswith('c_proj.weight'):\n",
                    "lineno": 203,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 202,
                    "start_region_line": 202
                },
                {
                    "end_outermost_loop": 204,
                    "end_region_line": 204,
                    "line": "                torch.nn.init.normal_(p, mean=0.0, std=0.02/math.sqrt(2 * config.n_layer))\n",
                    "lineno": 204,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.45556410915759327,
                    "n_cpu_percent_c": 0.048044638838567806,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 202,
                    "start_region_line": 202
                },
                {
                    "end_outermost_loop": 205,
                    "end_region_line": 207,
                    "line": "\n",
                    "lineno": 205,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 205,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        # report number of parameters\n",
                    "lineno": 206,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 207,
                    "end_region_line": 207,
                    "line": "        print(\"number of parameters: %.2fM\" % (self.get_num_params()/1e6,))\n",
                    "lineno": 207,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 207,
                    "start_region_line": 175
                },
                {
                    "end_outermost_loop": 208,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 208,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 208,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 219,
                    "end_region_line": 219,
                    "line": "    def get_num_params(self, non_embedding=True):\n",
                    "lineno": 209,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 209,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 210,
                    "end_region_line": 219,
                    "line": "        \"\"\"\n",
                    "lineno": 210,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 210,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 211,
                    "end_region_line": 219,
                    "line": "        Return the number of parameters in the model.\n",
                    "lineno": 211,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 211,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 212,
                    "end_region_line": 219,
                    "line": "        For non-embedding count (default), the position embeddings get subtracted.\n",
                    "lineno": 212,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 212,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 213,
                    "end_region_line": 219,
                    "line": "        The token embeddings would too, except due to the parameter sharing these\n",
                    "lineno": 213,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 213,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 214,
                    "end_region_line": 219,
                    "line": "        params are actually used as weights in the final layer, so we include them.\n",
                    "lineno": 214,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 214,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 215,
                    "end_region_line": 219,
                    "line": "        \"\"\"\n",
                    "lineno": 215,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 215,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 216,
                    "end_region_line": 219,
                    "line": "        n_params = sum(p.numel() for p in self.parameters())\n",
                    "lineno": 216,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 216,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 219,
                    "end_region_line": 219,
                    "line": "        #if non_embedding:\n",
                    "lineno": 217,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 209,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 219,
                    "end_region_line": 219,
                    "line": "        #    n_params -= self.transformer.wpe.weight.numel()\n",
                    "lineno": 218,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 209,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 219,
                    "end_region_line": 219,
                    "line": "        return n_params\n",
                    "lineno": 219,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 219,
                    "start_region_line": 209
                },
                {
                    "end_outermost_loop": 220,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 220,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 220,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 227,
                    "end_region_line": 227,
                    "line": "    def _init_weights(self, module):\n",
                    "lineno": 221,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 221,
                    "start_region_line": 221
                },
                {
                    "end_outermost_loop": 227,
                    "end_region_line": 227,
                    "line": "        if isinstance(module, nn.Linear):\n",
                    "lineno": 222,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 222,
                    "start_region_line": 221
                },
                {
                    "end_outermost_loop": 223,
                    "end_region_line": 227,
                    "line": "            torch.nn.init.normal_(module.weight, mean=0.0, std=0.02)\n",
                    "lineno": 223,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.44390860557164213,
                    "n_cpu_percent_c": 0.013538075068539974,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 223,
                    "start_region_line": 221
                },
                {
                    "end_outermost_loop": 225,
                    "end_region_line": 227,
                    "line": "            if module.bias is not None:\n",
                    "lineno": 224,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 224,
                    "start_region_line": 221
                },
                {
                    "end_outermost_loop": 225,
                    "end_region_line": 227,
                    "line": "                torch.nn.init.zeros_(module.bias)\n",
                    "lineno": 225,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 225,
                    "start_region_line": 221
                },
                {
                    "end_outermost_loop": 227,
                    "end_region_line": 227,
                    "line": "        elif isinstance(module, nn.Embedding):\n",
                    "lineno": 226,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 226,
                    "start_region_line": 221
                },
                {
                    "end_outermost_loop": 227,
                    "end_region_line": 227,
                    "line": "            torch.nn.init.normal_(module.weight, mean=0.0, std=0.02)\n",
                    "lineno": 227,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 227,
                    "start_region_line": 221
                },
                {
                    "end_outermost_loop": 228,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 228,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 228,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 304,
                    "end_region_line": 304,
                    "line": "    def forward(self, idx, age, targets=None, targets_age=None, kvcache=None):\n",
                    "lineno": 229,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 229,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 230,
                    "end_region_line": 304,
                    "line": "        device = idx.device\n",
                    "lineno": 230,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 230,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 231,
                    "end_region_line": 304,
                    "line": "        b, t = idx.size()\n",
                    "lineno": 231,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 231,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 304,
                    "end_region_line": 304,
                    "line": "        #assert t \\u003c= self.config.block_size, f\"Cannot forward sequence of length {t}, block size is only {self.config.block_size}\"\n",
                    "lineno": 232,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 229,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 304,
                    "end_region_line": 304,
                    "line": "        # pos = torch.arange(0, t, dtype=torch.long, device=device).unsqueeze(0) # shape (1, t)\n",
                    "lineno": 233,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 229,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 304,
                    "end_region_line": 304,
                    "line": "        # forward the GPT model itself\n",
                    "lineno": 234,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 229,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 235,
                    "end_region_line": 304,
                    "line": "        tok_emb = self.transformer.wte(idx) # token embeddings of shape (b, t, n_embd)\n",
                    "lineno": 235,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 3.923029766318483,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 235,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 304,
                    "end_region_line": 304,
                    "line": "        #pos_emb = self.transformer.wpe(pos) # position embeddings of shape (1, t, n_embd)\n",
                    "lineno": 236,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 229,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 237,
                    "end_region_line": 304,
                    "line": "        age_emb = self.transformer.wae(age.unsqueeze(-1)) # age embeddings of shape (b, t, n_embd)\n",
                    "lineno": 237,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.34433050359599093,
                    "n_cpu_percent_c": 0.38771235026260686,
                    "n_cpu_percent_python": 0.03517022593339072,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 237,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 304,
                    "end_region_line": 304,
                    "line": "        #age_emb = self.transformer.mlp(age_emb)\n",
                    "lineno": 238,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 229,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 239,
                    "end_region_line": 304,
                    "line": "        x = self.transformer.token_drop(tok_emb) * (1-self.config.token_dropout) \n",
                    "lineno": 239,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.33397818438352345,
                    "n_cpu_percent_c": 0.024599111124591504,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 239,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 240,
                    "end_region_line": 304,
                    "line": "        x = x + age_emb\n",
                    "lineno": 240,
                    "memory_samples": [
                        [
                            21716793848,
                            662.7124977111816
                        ],
                        [
                            22564491199,
                            669.3716926574707
                        ],
                        [
                            24228567101,
                            779.0236015319824
                        ],
                        [
                            25154679922,
                            786.1108894348145
                        ],
                        [
                            26190816960,
                            793.3382606506348
                        ],
                        [
                            27199958755,
                            800.7053260803223
                        ],
                        [
                            32105037560,
                            965.9727592468262
                        ],
                        [
                            33197856914,
                            974.1872673034668
                        ],
                        [
                            34288786849,
                            982.5421028137207
                        ],
                        [
                            56091773599,
                            665.3353080749512
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 115.8289213180542,
                    "n_malloc_mb": 115.8289213180542,
                    "n_mallocs": 0,
                    "n_peak_mb": 115.8289213180542,
                    "n_python_fraction": 0.0007916946157375084,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0007237850042367392,
                    "start_outermost_loop": 240,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 241,
                    "end_region_line": 304,
                    "line": "        x = self.transformer.drop(x)\n",
                    "lineno": 241,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3464825851341303,
                    "n_cpu_percent_c": 0.3631617740498139,
                    "n_cpu_percent_python": 0.03517022593339072,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 241,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 242,
                    "end_region_line": 304,
                    "line": "        \n",
                    "lineno": 242,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 242,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 243,
                    "end_region_line": 304,
                    "line": "        attn_mask = (idx\\u003e0).view(idx.size(0), 1, 1, idx.size(1)) * (idx\\u003e0).view(idx.size(0),1,idx.size(1),1)  # Do not attend to padded positions\n",
                    "lineno": 243,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3411865126137284,
                    "n_cpu_percent_c": 0.04345984818588801,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 243,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 244,
                    "end_region_line": 304,
                    "line": "        attn_mask *= torch.tril(torch.ones(idx.size(1),idx.size(1), device=device))[None,None,:,:] \\u003e 0 #self.transformer.h[0].attn.bias[:,:,:idx.size(1),:idx.size(1)] \\u003e 0\n",
                    "lineno": 244,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.388822359291965,
                    "n_cpu_percent_c": 0.07588152096258126,
                    "n_cpu_percent_python": 0.007034045186678143,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 244,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 247,
                    "end_region_line": 304,
                    "line": "        if targets is not None and self.config.mask_ties:\n",
                    "lineno": 245,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3687750039432818,
                    "n_cpu_percent_c": 0.014284738965112766,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 245,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 246,
                    "end_region_line": 304,
                    "line": "            attn_mask *= ((age.view(idx.size(0),1,1,idx.size(1)) != targets_age.view(idx.size(0),1,idx.size(1),1))) # Mask co-occuring tokens\n",
                    "lineno": 246,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 246,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 247,
                    "end_region_line": 304,
                    "line": "            attn_mask += (attn_mask.sum(-1, keepdim=True)==0) * torch.diag(torch.ones(idx.size(1), device=device)) \\u003e 0\n",
                    "lineno": 247,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 247,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 248,
                    "end_region_line": 304,
                    "line": "        attn_mask = attn_mask + (idx==0).view(idx.size(0), 1, 1, idx.size(1)) * torch.diag(torch.ones(idx.size(1), device=device)) \\u003e 0 # Except for padding\n",
                    "lineno": 248,
                    "memory_samples": [
                        [
                            17326011775,
                            621.1274223327637
                        ],
                        [
                            17887466852,
                            632.5701942443848
                        ],
                        [
                            18584454641,
                            638.5707664489746
                        ],
                        [
                            19315953814,
                            644.7150077819824
                        ],
                        [
                            20097199435,
                            650.9934425354004
                        ],
                        [
                            20885163995,
                            656.4444999694824
                        ],
                        [
                            36610245270,
                            952.8665657043457
                        ],
                        [
                            39008119683,
                            908.7303047180176
                        ],
                        [
                            39008138822,
                            884.3302192687988
                        ],
                        [
                            56716894011,
                            737.6960716247559
                        ],
                        [
                            70211334203,
                            1023.7909126281738
                        ],
                        [
                            70211341026,
                            1013.4194221496582
                        ],
                        [
                            71221814164,
                            1061.4393882751465
                        ],
                        [
                            71221819778,
                            1051.2791938781738
                        ],
                        [
                            72302306337,
                            819.1954765319824
                        ],
                        [
                            72302310905,
                            808.6482048034668
                        ],
                        [
                            73390273244,
                            1011.5991096496582
                        ],
                        [
                            73390278347,
                            1001.0248527526855
                        ],
                        [
                            74311561345,
                            790.0823631286621
                        ],
                        [
                            74311565596,
                            779.8049812316895
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 100.0472640991211,
                    "n_malloc_mb": 151.8020782470703,
                    "n_mallocs": 0,
                    "n_peak_mb": 100.0472640991211,
                    "n_python_fraction": 0.0006290818019971048,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0009485719680105136,
                    "start_outermost_loop": 248,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 249,
                    "end_region_line": 304,
                    "line": "        attn_mask *= torch.tril(torch.ones(idx.size(1),idx.size(1), device=device))[None,None,:,:] \\u003e 0 #self.transformer.h[0].attn.bias[:,:,:idx.size(1),:idx.size(1)] \\u003e 0\n",
                    "lineno": 249,
                    "memory_samples": [
                        [
                            36610262510,
                            928.665340423584
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.35322587815252926,
                    "n_cpu_percent_c": 0.5548001147337283,
                    "n_cpu_percent_python": 0.08089151964679867,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 249,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 250,
                    "end_region_line": 304,
                    "line": "\n",
                    "lineno": 250,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 250,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 251,
                    "end_region_line": 304,
                    "line": "        \n",
                    "lineno": 251,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 251,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 255,
                    "end_region_line": 304,
                    "line": "        if not kvcache:\n",
                    "lineno": 252,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 252,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 253,
                    "end_region_line": 304,
                    "line": "            kvcache = [None] * self.config.n_layer\n",
                    "lineno": 253,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 253,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 255,
                    "end_region_line": 304,
                    "line": "        else: \n",
                    "lineno": 254,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 252,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 255,
                    "end_region_line": 304,
                    "line": "            x = x[:, -1:, :]  # only take the last token for the forward pass\n",
                    "lineno": 255,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 255,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 256,
                    "end_region_line": 304,
                    "line": "\n",
                    "lineno": 256,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 256,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 257,
                    "end_region_line": 304,
                    "line": "        new_kvcache = []  # List to store the updated kvcache for each layer\n",
                    "lineno": 257,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 257,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 258,
                    "end_region_line": 304,
                    "line": "        att = []  # List to store the attention weights for each layer\n",
                    "lineno": 258,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 258,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 264,
                    "end_region_line": 264,
                    "line": "        for block, kvcache_block in zip(self.transformer.h, kvcache):\n",
                    "lineno": 259,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3536832257003434,
                    "n_cpu_percent_c": 0.011206289089156043,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 259,
                    "start_region_line": 259
                },
                {
                    "end_outermost_loop": 264,
                    "end_region_line": 264,
                    "line": "            if not kvcache[0] == None:\n",
                    "lineno": 260,
                    "memory_samples": [
                        [
                            25362882805,
                            862.136531829834
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4355170915616101,
                    "n_cpu_percent_c": 0.011071938826092328,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 259,
                    "start_region_line": 259
                },
                {
                    "end_outermost_loop": 264,
                    "end_region_line": 264,
                    "line": "                x = x[:, -1:, :]  # only take the last token for the forward pass in all layers\n",
                    "lineno": 261,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 259,
                    "start_region_line": 259
                },
                {
                    "end_outermost_loop": 264,
                    "end_region_line": 264,
                    "line": "            x, a, cache_ele = block(x, attn_mask, kvcache=kvcache_block)  # Forward pass through the block\n",
                    "lineno": 262,
                    "memory_samples": [
                        [
                            5790124319,
                            307.9861993789673
                        ],
                        [
                            6892808117,
                            367.2661876678467
                        ],
                        [
                            15125857017,
                            482.4633665084839
                        ],
                        [
                            15211644923,
                            516.2196035385132
                        ],
                        [
                            19988040492,
                            893.6530265808105
                        ],
                        [
                            21855074752,
                            707.476146697998
                        ],
                        [
                            22211286579,
                            846.5777931213379
                        ],
                        [
                            22330567150,
                            892.9451560974121
                        ],
                        [
                            22448311074,
                            939.3124732971191
                        ],
                        [
                            22703036462,
                            715.4753913879395
                        ],
                        [
                            22842338113,
                            763.4055976867676
                        ],
                        [
                            23760111798,
                            893.6050453186035
                        ],
                        [
                            23857199540,
                            943.1124610900879
                        ],
                        [
                            24960644507,
                            1061.6954383850098
                        ],
                        [
                            25564044724,
                            917.8112144470215
                        ],
                        [
                            25695851863,
                            970.5545539855957
                        ],
                        [
                            26439656409,
                            874.6234931945801
                        ],
                        [
                            29075407506,
                            999.6168785095215
                        ],
                        [
                            29562471870,
                            865.9273109436035
                        ],
                        [
                            29631072081,
                            895.6737327575684
                        ],
                        [
                            30268148451,
                            932.2395973205566
                        ],
                        [
                            30783510869,
                            942.1540718078613
                        ],
                        [
                            31467837791,
                            890.1661643981934
                        ],
                        [
                            31823069217,
                            1079.1938514709473
                        ],
                        [
                            31941327981,
                            1142.2029991149902
                        ],
                        [
                            32260139528,
                            1034.274356842041
                        ],
                        [
                            32783216331,
                            1269.8309135437012
                        ],
                        [
                            33009114921,
                            1367.0395011901855
                        ],
                        [
                            34113555968,
                            1376.7497901916504
                        ],
                        [
                            35045045829,
                            829.2101097106934
                        ],
                        [
                            35210669610,
                            897.6729621887207
                        ],
                        [
                            35621381812,
                            1104.2379035949707
                        ],
                        [
                            35776116151,
                            1187.232006072998
                        ],
                        [
                            36177611319,
                            1363.0369453430176
                        ],
                        [
                            36800004389,
                            565.8893928527832
                        ],
                        [
                            36958561777,
                            637.633129119873
                        ],
                        [
                            37630408744,
                            926.4840126037598
                        ],
                        [
                            38139533558,
                            1128.5534782409668
                        ],
                        [
                            38224375069,
                            1161.9800148010254
                        ],
                        [
                            38306823093,
                            1195.4071769714355
                        ],
                        [
                            38388167441,
                            1228.833324432373
                        ],
                        [
                            39303733027,
                            620.713794708252
                        ],
                        [
                            39723800950,
                            808.5117073059082
                        ],
                        [
                            40443540501,
                            1175.8982887268066
                        ],
                        [
                            40578860922,
                            1246.4083518981934
                        ],
                        [
                            40778990623,
                            1352.1726341247559
                        ],
                        [
                            41048591002,
                            1493.192714691162
                        ],
                        [
                            41618567883,
                            1243.6857948303223
                        ],
                        [
                            41968162984,
                            1403.6738090515137
                        ],
                        [
                            42145285642,
                            1483.6762199401855
                        ],
                        [
                            42642144506,
                            1137.6341972351074
                        ],
                        [
                            47582429569,
                            485.0712547302246
                        ],
                        [
                            47727210870,
                            537.817554473877
                        ],
                        [
                            47775447372,
                            556.8656959533691
                        ],
                        [
                            48337325569,
                            506.46699142456055
                        ],
                        [
                            48780908227,
                            532.6916694641113
                        ],
                        [
                            48965255828,
                            603.2535514831543
                        ],
                        [
                            56192293300,
                            697.3185539245605
                        ],
                        [
                            56277796223,
                            729.073558807373
                        ],
                        [
                            56624915854,
                            856.0937309265137
                        ],
                        [
                            57720902450,
                            771.6464576721191
                        ],
                        [
                            58574766031,
                            768.0793800354004
                        ],
                        [
                            58923923306,
                            859.3454322814941
                        ],
                        [
                            59161245126,
                            601.7347679138184
                        ],
                        [
                            59257108245,
                            638.6468162536621
                        ],
                        [
                            59628206521,
                            835.0124244689941
                        ],
                        [
                            59690240717,
                            873.2684364318848
                        ],
                        [
                            59755321733,
                            911.5242347717285
                        ],
                        [
                            59885342345,
                            988.0359382629395
                        ],
                        [
                            60110051663,
                            878.5630760192871
                        ],
                        [
                            60312334718,
                            957.8251152038574
                        ],
                        [
                            60414544001,
                            997.455867767334
                        ],
                        [
                            60517033074,
                            1037.0870246887207
                        ],
                        [
                            60906465359,
                            908.9656181335449
                        ],
                        [
                            61321197295,
                            1073.0522270202637
                        ],
                        [
                            62165623607,
                            1111.0327949523926
                        ],
                        [
                            65882603190,
                            661.791446685791
                        ],
                        [
                            66969429030,
                            1185.804027557373
                        ],
                        [
                            67504445239,
                            1112.3915061950684
                        ],
                        [
                            68561354853,
                            1133.6430931091309
                        ],
                        [
                            68831374650,
                            1242.9060020446777
                        ],
                        [
                            69476129815,
                            1122.989055633545
                        ],
                        [
                            69668972214,
                            1207.3738288879395
                        ],
                        [
                            70369310855,
                            1078.4834251403809
                        ],
                        [
                            70435181019,
                            1107.4398460388184
                        ],
                        [
                            70736742379,
                            819.3429222106934
                        ],
                        [
                            70802795426,
                            848.2992515563965
                        ],
                        [
                            71005536165,
                            935.1693534851074
                        ],
                        [
                            72531931698,
                            907.9653205871582
                        ],
                        [
                            72918163485,
                            923.4274253845215
                        ],
                        [
                            73454172585,
                            1035.6587944030762
                        ],
                        [
                            73631455257,
                            1133.9186668395996
                        ],
                        [
                            73807493187,
                            1228.4284019470215
                        ],
                        [
                            73869933849,
                            1259.9316062927246
                        ],
                        [
                            74396842666,
                            815.3722724914551
                        ],
                        [
                            74698732561,
                            874.6119575500488
                        ],
                        [
                            74969920792,
                            943.177791595459
                        ],
                        [
                            75042400203,
                            975.5559577941895
                        ],
                        [
                            76056070623,
                            1407.423740386963
                        ],
                        [
                            76512248390,
                            1612.4087562561035
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4177786669255163,
                    "n_cpu_percent_c": 0.8887716563655416,
                    "n_cpu_percent_python": 0.24970860412707424,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 259,
                    "start_region_line": 259
                },
                {
                    "end_outermost_loop": 264,
                    "end_region_line": 264,
                    "line": "            att.append(a)  # Append the attention weights to the list\n",
                    "lineno": 263,
                    "memory_samples": [
                        [
                            18000359212,
                            667.5751152038574
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.4189989905001438,
                    "n_cpu_percent_c": 0.32190217519830777,
                    "n_cpu_percent_python": 0.08792556483347681,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 259,
                    "start_region_line": 259
                },
                {
                    "end_outermost_loop": 264,
                    "end_region_line": 264,
                    "line": "            new_kvcache.append(cache_ele)  # Append the updated kvcache to the list\n",
                    "lineno": 264,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 259,
                    "start_region_line": 259
                },
                {
                    "end_outermost_loop": 265,
                    "end_region_line": 304,
                    "line": "        x = self.transformer.ln_f(x)  # Apply layer normalization\n",
                    "lineno": 265,
                    "memory_samples": [
                        [
                            25025657972,
                            1084.3830451965332
                        ],
                        [
                            45998710105,
                            1719.3408012390137
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.43865918859964376,
                    "n_cpu_percent_c": 0.012267726507827325,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 265,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 266,
                    "end_region_line": 304,
                    "line": "        att = torch.stack(att)  # Stack the attention weights along a new dimension\n",
                    "lineno": 266,
                    "memory_samples": [
                        [
                            6326411475,
                            380.7020845413208
                        ],
                        [
                            6715758613,
                            399.64419651031494
                        ],
                        [
                            6972743602,
                            409.3173780441284
                        ],
                        [
                            7231226249,
                            420.3907251358032
                        ],
                        [
                            7541155636,
                            432.67798614501953
                        ],
                        [
                            7850065733,
                            442.16686630249023
                        ],
                        [
                            8199430120,
                            413.78117275238037
                        ],
                        [
                            8548493282,
                            587.6474609375
                        ],
                        [
                            8915950135,
                            602.4209184646606
                        ],
                        [
                            9218492119,
                            614.0654697418213
                        ],
                        [
                            9612332093,
                            624.5287656784058
                        ],
                        [
                            10031397030,
                            636.6802015304565
                        ],
                        [
                            10512057573,
                            650.6926221847534
                        ],
                        [
                            11490160495,
                            678.1598072052002
                        ],
                        [
                            11997557397,
                            693.0186061859131
                        ],
                        [
                            12527342989,
                            708.3953952789307
                        ],
                        [
                            12921320099,
                            722.5246992111206
                        ],
                        [
                            13482297088,
                            735.4825143814087
                        ],
                        [
                            14053408012,
                            752.1165208816528
                        ],
                        [
                            14666786621,
                            768.265495300293
                        ],
                        [
                            15283829023,
                            624.2226781845093
                        ],
                        [
                            15920578566,
                            870.2983665466309
                        ],
                        [
                            16580530105,
                            977.6969795227051
                        ],
                        [
                            17293608274,
                            679.9279670715332
                        ],
                        [
                            17829086337,
                            958.2060585021973
                        ],
                        [
                            18521978900,
                            982.8160591125488
                        ],
                        [
                            19252847089,
                            1003.0074729919434
                        ],
                        [
                            20027261884,
                            1023.6608390808105
                        ],
                        [
                            20819605246,
                            1044.697338104248
                        ],
                        [
                            21647908655,
                            1066.2076530456543
                        ],
                        [
                            22494455642,
                            1088.0937232971191
                        ],
                        [
                            23423623423,
                            854.5232353210449
                        ],
                        [
                            24151708463,
                            1228.8828010559082
                        ],
                        [
                            25075379343,
                            1256.075740814209
                        ],
                        [
                            26098419165,
                            1278.1930046081543
                        ],
                        [
                            27120302183,
                            1302.3024940490723
                        ],
                        [
                            28141141364,
                            974.5037727355957
                        ],
                        [
                            29130292188,
                            1197.1246910095215
                        ],
                        [
                            30128998935,
                            1044.0081596374512
                        ],
                        [
                            31144322885,
                            1281.5326042175293
                        ],
                        [
                            32021356073,
                            1362.7029991149902
                        ],
                        [
                            33100585599,
                            1592.1447868347168
                        ],
                        [
                            34186997464,
                            1609.8819541931152
                        ],
                        [
                            35376842256,
                            1173.204433441162
                        ],
                        [
                            36499583865,
                            1718.1285667419434
                        ],
                        [
                            37722128250,
                            1184.5419578552246
                        ],
                        [
                            38883962135,
                            1662.6148414611816
                        ],
                        [
                            40142824573,
                            1274.218448638916
                        ],
                        [
                            41148843467,
                            1777.4417839050293
                        ],
                        [
                            42406234130,
                            1856.9313850402832
                        ],
                        [
                            43731611034,
                            1894.882740020752
                        ],
                        [
                            44984727500,
                            1729.9690589904785
                        ],
                        [
                            45307665499,
                            1760.1251411437988
                        ],
                        [
                            45525579454,
                            1736.814250946045
                        ],
                        [
                            45745011521,
                            1734.3303031921387
                        ],
                        [
                            45998716730,
                            1744.7237586975098
                        ],
                        [
                            46255583437,
                            1756.4040336608887
                        ],
                        [
                            46604480619,
                            834.5440635681152
                        ],
                        [
                            46913420835,
                            547.654842376709
                        ],
                        [
                            47240333169,
                            594.462459564209
                        ],
                        [
                            47495825650,
                            604.3114585876465
                        ],
                        [
                            47846533529,
                            616.9271965026855
                        ],
                        [
                            48213787187,
                            629.9041175842285
                        ],
                        [
                            48598389948,
                            643.1728553771973
                        ],
                        [
                            48983628769,
                            656.7366600036621
                        ],
                        [
                            49405246093,
                            668.897029876709
                        ],
                        [
                            49839508140,
                            682.9874000549316
                        ],
                        [
                            50282566110,
                            697.3745994567871
                        ],
                        [
                            50606405610,
                            712.0463218688965
                        ],
                        [
                            51078420664,
                            727.0266532897949
                        ],
                        [
                            52088540002,
                            757.8479118347168
                        ],
                        [
                            52596823575,
                            773.6945610046387
                        ],
                        [
                            53165092991,
                            789.8420219421387
                        ],
                        [
                            53767720882,
                            806.2824821472168
                        ],
                        [
                            54380185065,
                            823.0124015808105
                        ],
                        [
                            54843731125,
                            842.3764762878418
                        ],
                        [
                            55433801693,
                            860.0189628601074
                        ],
                        [
                            56058484613,
                            731.8180656433105
                        ],
                        [
                            57341278341,
                            777.925594329834
                        ],
                        [
                            58015741956,
                            999.7459602355957
                        ],
                        [
                            58719980395,
                            952.4447898864746
                        ],
                        [
                            59444598555,
                            849.3355751037598
                        ],
                        [
                            59932415691,
                            1150.0361213684082
                        ],
                        [
                            60670408378,
                            1245.5384712219238
                        ],
                        [
                            61427472207,
                            1269.3438682556152
                        ],
                        [
                            62217263442,
                            1293.9156074523926
                        ],
                        [
                            63015692109,
                            975.9310111999512
                        ],
                        [
                            63823967857,
                            1254.4112129211426
                        ],
                        [
                            64710594038,
                            1061.609287261963
                        ],
                        [
                            66294338206,
                            1081.8168601989746
                        ],
                        [
                            67161598540,
                            1462.3519859313965
                        ],
                        [
                            68106900507,
                            1557.611904144287
                        ],
                        [
                            69102734990,
                            1569.610553741455
                        ],
                        [
                            70098685753,
                            1597.6229133605957
                        ],
                        [
                            71157787987,
                            1222.1826515197754
                        ],
                        [
                            72187107826,
                            1587.133716583252
                        ],
                        [
                            73311725371,
                            1321.715145111084
                        ],
                        [
                            74186908686,
                            1670.193286895752
                        ],
                        [
                            75421644791,
                            1384.9143028259277
                        ],
                        [
                            76700836028,
                            1879.597583770752
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.20871976042288715,
                    "n_cpu_percent_c": 5.7792985266094625,
                    "n_cpu_percent_python": 0.37268548616976727,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 1931.9470481872559,
                    "n_malloc_mb": 13179.141860961914,
                    "n_mallocs": 0,
                    "n_peak_mb": 1931.9470481872559,
                    "n_python_fraction": 5.1905813963398316e-05,
                    "n_sys_percent": 0.0019628469507093813,
                    "n_usage_fraction": 0.08235305258071231,
                    "start_outermost_loop": 266,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 267,
                    "end_region_line": 304,
                    "line": "\n",
                    "lineno": 267,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 267,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "        if targets is not None:\n",
                    "lineno": 268,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.37875955800974537,
                    "n_cpu_percent_c": 0.011395153202413825,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            # if we are given some desired targets also calculate the loss\n",
                    "lineno": 269,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 270,
                    "end_region_line": 304,
                    "line": "            targets = targets.reshape(-1)\n",
                    "lineno": 270,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 270,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 271,
                    "end_region_line": 304,
                    "line": "            pass_tokens = targets != -1 \n",
                    "lineno": 271,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 271,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 272,
                    "end_region_line": 273,
                    "line": "            for k in self.config.ignore_tokens: # and gender\n",
                    "lineno": 272,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 272,
                    "start_region_line": 272
                },
                {
                    "end_outermost_loop": 273,
                    "end_region_line": 273,
                    "line": "                pass_tokens *= targets != k\n",
                    "lineno": 273,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 273,
                    "start_region_line": 272
                },
                {
                    "end_outermost_loop": 274,
                    "end_region_line": 304,
                    "line": "\n",
                    "lineno": 274,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 274,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            # next token cross entropy loss, padding masked\n",
                    "lineno": 275,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 276,
                    "end_region_line": 304,
                    "line": "            logits = self.lm_head(x)\n",
                    "lineno": 276,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 276,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 277,
                    "end_region_line": 304,
                    "line": "            \n",
                    "lineno": 277,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 277,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            #age_min = age.gather(1,(((idx \\u003e=4) * (idx \\u003c=12)) + 0).argmax(1)[:,None])\n",
                    "lineno": 278,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            #logits[...,-1][age \\u003c= age_min] = -100. #-float('Inf') ## Death can only occur after age_min\n",
                    "lineno": 279,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 280,
                    "end_region_line": 304,
                    "line": "            \n",
                    "lineno": 280,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 280,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 281,
                    "end_region_line": 304,
                    "line": "            loss_ce = F.cross_entropy(logits.reshape(-1, logits.size(-1))[pass_tokens], targets[pass_tokens], ignore_index=-1)\n",
                    "lineno": 281,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 281,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 282,
                    "end_region_line": 304,
                    "line": "            \n",
                    "lineno": 282,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 282,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            # time to next event loss, padding masked\n",
                    "lineno": 283,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 284,
                    "end_region_line": 304,
                    "line": "            lse = torch.logsumexp(logits,-1) ## More forgiving than using torch.max() for the most likely next event\n",
                    "lineno": 284,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 284,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 285,
                    "end_region_line": 304,
                    "line": "            lse = - torch.log(torch.exp(-lse) + self.config.t_min)\n",
                    "lineno": 285,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 285,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 286,
                    "end_region_line": 304,
                    "line": "            dt = torch.clamp(targets_age - age, min=1.0)\n",
                    "lineno": 286,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 286,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 289,
                    "end_region_line": 304,
                    "line": "            if self.config.mask_ties:\n",
                    "lineno": 287,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 287,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 288,
                    "end_region_line": 304,
                    "line": "                dt = torch.gather(dt, -1, (attn_mask * torch.arange(0, idx.size(1), device=device, dtype=torch.float16)\n",
                    "lineno": 288,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 288,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 289,
                    "end_region_line": 304,
                    "line": "                                           .view(1, 1, 1, -1)).max(-1).indices.squeeze((1, 2)))  # Use time from last untied token\n",
                    "lineno": 289,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 289,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 290,
                    "end_region_line": 304,
                    "line": "            ldt = - torch.log(dt + self.config.t_min).view(-1)\n",
                    "lineno": 290,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 290,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 291,
                    "end_region_line": 304,
                    "line": "            \n",
                    "lineno": 291,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 291,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 292,
                    "end_region_line": 304,
                    "line": "            loss_dt = -(lse.reshape(-1) - torch.exp(lse.reshape(-1) - ldt.reshape(-1))) ## Exponential log-likelihood (real statistics, TM)\n",
                    "lineno": 292,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 292,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 293,
                    "end_region_line": 304,
                    "line": "            loss_dt = torch.mean(loss_dt[pass_tokens]) \n",
                    "lineno": 293,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 293,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 294,
                    "end_region_line": 304,
                    "line": "            \n",
                    "lineno": 294,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 294,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            # Both losses combined\n",
                    "lineno": 295,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 296,
                    "end_region_line": 304,
                    "line": "            loss = loss_ce + loss_dt\n",
                    "lineno": 296,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 296,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 297,
                    "end_region_line": 304,
                    "line": "            \n",
                    "lineno": 297,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 297,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            #loss += 5.0 * F.mse_loss(lse.view(-1)*(ldt != 0), ldt) ## Adds MSE for log time difference to next observed event\n",
                    "lineno": 298,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "        else:\n",
                    "lineno": 299,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            # inference-time mini-optimization: only forward the lm_head on the very last position\n",
                    "lineno": 300,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 268,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 301,
                    "end_region_line": 304,
                    "line": "            logits = self.lm_head(x[:, :, :]) # note: using list [-1] to preserve the time dim\n",
                    "lineno": 301,
                    "memory_samples": [
                        [
                            5584324430,
                            305.73605251312256
                        ],
                        [
                            6552571865,
                            399.7508373260498
                        ],
                        [
                            8556316101,
                            601.2946166992188
                        ],
                        [
                            11013212138,
                            679.1890573501587
                        ],
                        [
                            11013219579,
                            652.9373788833618
                        ],
                        [
                            12007757865,
                            711.6267585754395
                        ],
                        [
                            12544492784,
                            653.1473789215088
                        ],
                        [
                            13511689212,
                            694.0720071792603
                        ],
                        [
                            15949363713,
                            858.5572395324707
                        ],
                        [
                            16605912897,
                            963.4119758605957
                        ],
                        [
                            17314743297,
                            665.267894744873
                        ],
                        [
                            17852007936,
                            943.1670341491699
                        ],
                        [
                            17852015698,
                            905.665599822998
                        ],
                        [
                            20054708365,
                            1036.97456741333
                        ],
                        [
                            20054710717,
                            1026.138271331787
                        ],
                        [
                            20054733363,
                            950.2841987609863
                        ],
                        [
                            20845170054,
                            944.6208305358887
                        ],
                        [
                            21673628423,
                            1008.4060173034668
                        ],
                        [
                            22520499008,
                            1113.9276542663574
                        ],
                        [
                            22520517545,
                            1064.3322257995605
                        ],
                        [
                            23454209586,
                            844.8366279602051
                        ],
                        [
                            23454237671,
                            818.9452857971191
                        ],
                        [
                            24182699379,
                            1215.3365287780762
                        ],
                        [
                            25108441558,
                            1142.8862190246582
                        ],
                        [
                            25108444589,
                            1128.8155479431152
                        ],
                        [
                            26132796605,
                            1159.7846870422363
                        ],
                        [
                            27151944718,
                            1330.9450187683105
                        ],
                        [
                            27151952569,
                            1300.4596824645996
                        ],
                        [
                            27151963030,
                            1239.4894981384277
                        ],
                        [
                            27151965439,
                            1224.2469520568848
                        ],
                        [
                            28178907444,
                            876.9515495300293
                        ],
                        [
                            29167035207,
                            1226.8881721496582
                        ],
                        [
                            29167049968,
                            1177.5040397644043
                        ],
                        [
                            29167056426,
                            1144.5814476013184
                        ],
                        [
                            30168972025,
                            971.8159675598145
                        ],
                        [
                            30168986757,
                            903.4707832336426
                        ],
                        [
                            32065727455,
                            1320.6484413146973
                        ],
                        [
                            32065742879,
                            1247.1470069885254
                        ],
                        [
                            33146917662,
                            1471.8387031555176
                        ],
                        [
                            35425115592,
                            1189.397403717041
                        ],
                        [
                            35425122366,
                            1168.998607635498
                        ],
                        [
                            35425126930,
                            1148.599811553955
                        ],
                        [
                            35425140263,
                            1067.0046272277832
                        ],
                        [
                            36544256677,
                            1692.0553703308105
                        ],
                        [
                            37787649088,
                            1000.7469673156738
                        ],
                        [
                            38936227159,
                            1520.8758811950684
                        ],
                        [
                            38936256500,
                            1475.8282890319824
                        ],
                        [
                            40190981336,
                            1263.0825309753418
                        ],
                        [
                            40190985347,
                            1239.8243598937988
                        ],
                        [
                            42462039361,
                            1798.209674835205
                        ],
                        [
                            42462053746,
                            1699.1769905090332
                        ],
                        [
                            43785889421,
                            1651.1850471496582
                        ],
                        [
                            46608470816,
                            762.758487701416
                        ],
                        [
                            49848340070,
                            701.5955009460449
                        ],
                        [
                            53184541270,
                            760.7563667297363
                        ],
                        [
                            53184545289,
                            743.4118995666504
                        ],
                        [
                            54402178872,
                            828.9204292297363
                        ],
                        [
                            54867862602,
                            827.3369026184082
                        ],
                        [
                            56082391905,
                            757.8677024841309
                        ],
                        [
                            56082418934,
                            654.5044975280762
                        ],
                        [
                            56690703768,
                            1010.251880645752
                        ],
                        [
                            56690711992,
                            988.579044342041
                        ],
                        [
                            56690727076,
                            923.5612678527832
                        ],
                        [
                            56690729412,
                            912.7249717712402
                        ],
                        [
                            57366134384,
                            802.6345252990723
                        ],
                        [
                            58049004279,
                            965.679370880127
                        ],
                        [
                            58746493465,
                            965.8796806335449
                        ],
                        [
                            58746501506,
                            928.683292388916
                        ],
                        [
                            58746512236,
                            879.0881080627441
                        ],
                        [
                            59964982412,
                            1136.4895973205566
                        ],
                        [
                            59964995267,
                            1068.9878044128418
                        ],
                        [
                            61458588984,
                            1253.4772148132324
                        ],
                        [
                            61458600090,
                            1180.2332344055176
                        ],
                        [
                            62248998426,
                            1185.3749732971191
                        ],
                        [
                            62249000909,
                            1170.1324272155762
                        ],
                        [
                            63052803865,
                            925.9113426208496
                        ],
                        [
                            64744498565,
                            1074.8486824035645
                        ],
                        [
                            64744524329,
                            955.2446098327637
                        ],
                        [
                            65625052373,
                            1262.2680702209473
                        ],
                        [
                            66332698373,
                            1094.8882865905762
                        ],
                        [
                            66332715056,
                            1021.3868522644043
                        ],
                        [
                            67203445064,
                            1475.3218040466309
                        ],
                        [
                            67203447526,
                            1456.282382965088
                        ],
                        [
                            69144731297,
                            1521.1498832702637
                        ],
                        [
                            69144744210,
                            1419.1559028625488
                        ],
                        [
                            70143344400,
                            1610.2216835021973
                        ],
                        [
                            70143381705,
                            1399.2805976867676
                        ],
                        [
                            72233806318,
                            1509.332706451416
                        ],
                        [
                            73356795073,
                            1240.804759979248
                        ],
                        [
                            73356807077,
                            1171.0302467346191
                        ],
                        [
                            73356810851,
                            1147.7720756530762
                        ],
                        [
                            74240632060,
                            1634.131275177002
                        ],
                        [
                            75475212742,
                            1421.4154472351074
                        ],
                        [
                            75475218515,
                            1396.6570320129395
                        ],
                        [
                            75475226286,
                            1347.1406898498535
                        ],
                        [
                            75475232675,
                            1297.6243476867676
                        ],
                        [
                            75475239354,
                            1223.3498344421387
                        ],
                        [
                            76760969161,
                            1920.529941558838
                        ],
                        [
                            76760982719,
                            1818.4344520568848
                        ],
                        [
                            76760994419,
                            1690.81547164917
                        ]
                    ],
                    "n_avg_mb": 343.495078086853,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.27112371793635265,
                    "n_cpu_percent_c": 1.1002920774719027,
                    "n_cpu_percent_python": 0.23212349116037886,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 343.495078086853,
                    "n_malloc_mb": 2449.068470954895,
                    "n_mallocs": 1,
                    "n_peak_mb": 343.495078086853,
                    "n_python_fraction": 0.00024487506769014605,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.01530359614382301,
                    "start_outermost_loop": 301,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 302,
                    "end_region_line": 304,
                    "line": "            loss = None\n",
                    "lineno": 302,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 302,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 303,
                    "end_region_line": 304,
                    "line": "\n",
                    "lineno": 303,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 303,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 304,
                    "end_region_line": 304,
                    "line": "        return logits, loss, att, new_kvcache\n",
                    "lineno": 304,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 304,
                    "start_region_line": 229
                },
                {
                    "end_outermost_loop": 305,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 305,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 305,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 314,
                    "end_region_line": 314,
                    "line": "    def crop_block_size(self, block_size):\n",
                    "lineno": 306,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 306,
                    "start_region_line": 306
                },
                {
                    "end_outermost_loop": 314,
                    "end_region_line": 314,
                    "line": "        # model surgery to decrease the block size if necessary\n",
                    "lineno": 307,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 306,
                    "start_region_line": 306
                },
                {
                    "end_outermost_loop": 314,
                    "end_region_line": 314,
                    "line": "        # e.g. we may load the GPT2 pretrained model checkpoint (block size 1024)\n",
                    "lineno": 308,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 306,
                    "start_region_line": 306
                },
                {
                    "end_outermost_loop": 314,
                    "end_region_line": 314,
                    "line": "        # but want to use a smaller block size for some smaller, simpler model\n",
                    "lineno": 309,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 306,
                    "start_region_line": 306
                },
                {
                    "end_outermost_loop": 310,
                    "end_region_line": 314,
                    "line": "        assert block_size \\u003c= self.config.block_size\n",
                    "lineno": 310,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 310,
                    "start_region_line": 306
                },
                {
                    "end_outermost_loop": 311,
                    "end_region_line": 314,
                    "line": "        self.config.block_size = block_size\n",
                    "lineno": 311,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 311,
                    "start_region_line": 306
                },
                {
                    "end_outermost_loop": 312,
                    "end_region_line": 314,
                    "line": "        self.transformer.wpe.weight = nn.Parameter(self.transformer.wpe.weight[:block_size])\n",
                    "lineno": 312,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 312,
                    "start_region_line": 306
                },
                {
                    "end_outermost_loop": 314,
                    "end_region_line": 314,
                    "line": "        for block in self.transformer.h:\n",
                    "lineno": 313,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 313,
                    "start_region_line": 313
                },
                {
                    "end_outermost_loop": 314,
                    "end_region_line": 314,
                    "line": "            block.attn.bias = block.attn.bias[:,:,:block_size,:block_size]\n",
                    "lineno": 314,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 313,
                    "start_region_line": 313
                },
                {
                    "end_outermost_loop": 315,
                    "end_region_line": 464,
                    "line": "            \n",
                    "lineno": 315,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 315,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 318,
                    "end_region_line": 318,
                    "line": "    def adjust_block_size(self, block_size):\n",
                    "lineno": 316,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 316,
                    "start_region_line": 316
                },
                {
                    "end_outermost_loop": 318,
                    "end_region_line": 318,
                    "line": "        for block in self.transformer.h:\n",
                    "lineno": 317,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 317,
                    "start_region_line": 317
                },
                {
                    "end_outermost_loop": 318,
                    "end_region_line": 318,
                    "line": "            block.attn.bias = torch.tril(torch.ones(block_size, block_size)).view(1, 1, block_size, block_size)\n",
                    "lineno": 318,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 317,
                    "start_region_line": 317
                },
                {
                    "end_outermost_loop": 319,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 319,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 319,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "    def configure_optimizers(self, weight_decay, learning_rate, betas, device_type):\n",
                    "lineno": 320,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 321,
                    "end_region_line": 376,
                    "line": "        \"\"\"\n",
                    "lineno": 321,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 321,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 322,
                    "end_region_line": 376,
                    "line": "        This long function is unfortunately doing something very simple and is being very defensive:\n",
                    "lineno": 322,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 322,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 323,
                    "end_region_line": 376,
                    "line": "        We are separating out all parameters of the model into two buckets: those that will experience\n",
                    "lineno": 323,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 323,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 324,
                    "end_region_line": 376,
                    "line": "        weight decay for regularization and those that won't (biases, and layernorm/embedding weights).\n",
                    "lineno": 324,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 324,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 325,
                    "end_region_line": 376,
                    "line": "        We are then returning the PyTorch optimizer object.\n",
                    "lineno": 325,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 325,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 326,
                    "end_region_line": 376,
                    "line": "        \"\"\"\n",
                    "lineno": 326,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 326,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 327,
                    "end_region_line": 376,
                    "line": "\n",
                    "lineno": 327,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 327,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # separate out all parameters to those that will and won't experience regularizing weight decay\n",
                    "lineno": 328,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 329,
                    "end_region_line": 376,
                    "line": "        decay = set()\n",
                    "lineno": 329,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 329,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 330,
                    "end_region_line": 376,
                    "line": "        no_decay = set()\n",
                    "lineno": 330,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 330,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 331,
                    "end_region_line": 376,
                    "line": "        whitelist_weight_modules = (torch.nn.Linear, )\n",
                    "lineno": 331,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 331,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 332,
                    "end_region_line": 376,
                    "line": "        blacklist_weight_modules = (torch.nn.LayerNorm, LayerNorm, torch.nn.Embedding)\n",
                    "lineno": 332,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 332,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "        for mn, m in self.named_modules():\n",
                    "lineno": 333,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 333
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "            for pn, p in m.named_parameters():\n",
                    "lineno": 334,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                fpn = '%s.%s' % (mn, pn) if mn else pn # full param name\n",
                    "lineno": 335,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                # random note: because named_modules and named_parameters are recursive\n",
                    "lineno": 336,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                # we will see the same tensors p many many times. but doing it this way\n",
                    "lineno": 337,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                # allows us to know which parent module any tensor p belongs to...\n",
                    "lineno": 338,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                if pn.endswith('bias'):\n",
                    "lineno": 339,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                    # all biases will not be decayed\n",
                    "lineno": 340,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                    no_decay.add(fpn)\n",
                    "lineno": 341,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                elif pn.endswith('weight') and isinstance(m, whitelist_weight_modules):\n",
                    "lineno": 342,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                    # weights of whitelist modules will be weight decayed\n",
                    "lineno": 343,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                    decay.add(fpn)\n",
                    "lineno": 344,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                elif pn.endswith('weight') and isinstance(m, blacklist_weight_modules):\n",
                    "lineno": 345,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                    # weights of blacklist modules will NOT be weight decayed\n",
                    "lineno": 346,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 347,
                    "end_region_line": 347,
                    "line": "                    no_decay.add(fpn)\n",
                    "lineno": 347,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 333,
                    "start_region_line": 334
                },
                {
                    "end_outermost_loop": 348,
                    "end_region_line": 376,
                    "line": "\n",
                    "lineno": 348,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 348,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # subtle: 'transformer.wte.weight' and 'lm_head.weight' are tied, so they\n",
                    "lineno": 349,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # will appear in the no_decay and decay sets respectively after the above.\n",
                    "lineno": 350,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # In addition, because named_parameters() doesn't return duplicates, it\n",
                    "lineno": 351,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # will only return the first occurence, key'd by 'transformer.wte.weight', below.\n",
                    "lineno": 352,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # so let's manually remove 'lm_head.weight' from decay set. This will include\n",
                    "lineno": 353,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # this tensor into optimization via transformer.wte.weight only, and not decayed.\n",
                    "lineno": 354,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 355,
                    "end_region_line": 376,
                    "line": "        decay.remove('lm_head.weight')\n",
                    "lineno": 355,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 355,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 356,
                    "end_region_line": 376,
                    "line": "\n",
                    "lineno": 356,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 356,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # validate that we considered every parameter\n",
                    "lineno": 357,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 358,
                    "end_region_line": 376,
                    "line": "        param_dict = {pn: p for pn, p in self.named_parameters()}\n",
                    "lineno": 358,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 358,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 359,
                    "end_region_line": 376,
                    "line": "        inter_params = decay \\u0026 no_decay\n",
                    "lineno": 359,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 359,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 360,
                    "end_region_line": 376,
                    "line": "        union_params = decay | no_decay\n",
                    "lineno": 360,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 360,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 361,
                    "end_region_line": 376,
                    "line": "        assert len(inter_params) == 0, \"parameters %s made it into both decay/no_decay sets!\" % (str(inter_params), )\n",
                    "lineno": 361,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 361,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 362,
                    "end_region_line": 376,
                    "line": "        assert len(param_dict.keys() - union_params) == 0, \"parameters %s were not separated into either decay/no_decay set!\" \\\n",
                    "lineno": 362,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 362,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "                                                    % (str(param_dict.keys() - union_params), )\n",
                    "lineno": 363,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 364,
                    "end_region_line": 376,
                    "line": "\n",
                    "lineno": 364,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 364,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # create the pytorch optimizer object\n",
                    "lineno": 365,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 366,
                    "end_region_line": 376,
                    "line": "        optim_groups = [\n",
                    "lineno": 366,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 366,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 367,
                    "end_region_line": 376,
                    "line": "            {\"params\": [param_dict[pn] for pn in sorted(list(decay))], \"weight_decay\": weight_decay},\n",
                    "lineno": 367,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 367,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 368,
                    "end_region_line": 376,
                    "line": "            {\"params\": [param_dict[pn] for pn in sorted(list(no_decay))], \"weight_decay\": 0.0},\n",
                    "lineno": 368,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 368,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 369,
                    "end_region_line": 376,
                    "line": "        ]\n",
                    "lineno": 369,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 369,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        # new PyTorch nightly has a new 'fused' option for AdamW that is much faster\n",
                    "lineno": 370,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 320,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 371,
                    "end_region_line": 376,
                    "line": "        use_fused = (device_type == 'cuda') and ('fused' in inspect.signature(torch.optim.AdamW).parameters)\n",
                    "lineno": 371,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 371,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 372,
                    "end_region_line": 376,
                    "line": "        print(f\"using fused AdamW: {use_fused}\")\n",
                    "lineno": 372,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 372,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 373,
                    "end_region_line": 376,
                    "line": "        extra_args = dict(fused=True) if use_fused else dict()\n",
                    "lineno": 373,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 373,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 374,
                    "end_region_line": 376,
                    "line": "        optimizer = torch.optim.AdamW(optim_groups, lr=learning_rate, betas=betas, **extra_args)\n",
                    "lineno": 374,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 374,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 375,
                    "end_region_line": 376,
                    "line": "\n",
                    "lineno": 375,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 375,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 376,
                    "end_region_line": 376,
                    "line": "        return optimizer\n",
                    "lineno": 376,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 376,
                    "start_region_line": 320
                },
                {
                    "end_outermost_loop": 377,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 377,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 377,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 392,
                    "end_region_line": 392,
                    "line": "    def estimate_mfu(self, fwdbwd_per_iter, dt):\n",
                    "lineno": 378,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 378,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 379,
                    "end_region_line": 392,
                    "line": "        \"\"\" estimate model flops utilization (MFU) in units of A100 bfloat16 peak FLOPS \"\"\"\n",
                    "lineno": 379,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 379,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 392,
                    "end_region_line": 392,
                    "line": "        # first estimate the number of flops we do per iteration.\n",
                    "lineno": 380,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 378,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 392,
                    "end_region_line": 392,
                    "line": "        # see PaLM paper Appendix B as ref: https://arxiv.org/abs/2204.02311\n",
                    "lineno": 381,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 378,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 382,
                    "end_region_line": 392,
                    "line": "        N = self.get_num_params()\n",
                    "lineno": 382,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 382,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 383,
                    "end_region_line": 392,
                    "line": "        cfg = self.config\n",
                    "lineno": 383,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 383,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 384,
                    "end_region_line": 392,
                    "line": "        L, H, Q, T = cfg.n_layer, cfg.n_head, cfg.n_embd//cfg.n_head, cfg.block_size\n",
                    "lineno": 384,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 384,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 385,
                    "end_region_line": 392,
                    "line": "        flops_per_token = 6*N + 12*L*H*Q*T\n",
                    "lineno": 385,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 385,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 386,
                    "end_region_line": 392,
                    "line": "        flops_per_fwdbwd = flops_per_token * T\n",
                    "lineno": 386,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 386,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 387,
                    "end_region_line": 392,
                    "line": "        flops_per_iter = flops_per_fwdbwd * fwdbwd_per_iter\n",
                    "lineno": 387,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 387,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 392,
                    "end_region_line": 392,
                    "line": "        # express our flops throughput as ratio of A100 bfloat16 peak flops\n",
                    "lineno": 388,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 378,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 389,
                    "end_region_line": 392,
                    "line": "        flops_achieved = flops_per_iter * (1.0/dt) # per second\n",
                    "lineno": 389,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 389,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 390,
                    "end_region_line": 392,
                    "line": "        flops_promised = 312e12 # A100 GPU bfloat16 peak flops is 312 TFLOPS\n",
                    "lineno": 390,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 390,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 391,
                    "end_region_line": 392,
                    "line": "        mfu = flops_achieved / flops_promised\n",
                    "lineno": 391,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 391,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 392,
                    "end_region_line": 392,
                    "line": "        return mfu\n",
                    "lineno": 392,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 392,
                    "start_region_line": 378
                },
                {
                    "end_outermost_loop": 393,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 393,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 393,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 464,
                    "end_region_line": 464,
                    "line": "    @torch.no_grad()\n",
                    "lineno": 394,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 173,
                    "start_region_line": 173
                },
                {
                    "end_outermost_loop": 464,
                    "end_region_line": 464,
                    "line": "    def generate(self, idx, age, max_new_tokens=100, max_age = 85*365.25, temperature=1.0, top_k=None, no_repeat=True, use_kvcache=False):\n",
                    "lineno": 395,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 395,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 396,
                    "end_region_line": 464,
                    "line": "        \"\"\"\n",
                    "lineno": 396,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 396,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 397,
                    "end_region_line": 464,
                    "line": "        Take a conditioning sequence of indices idx (LongTensor of shape (b,t)) and complete\n",
                    "lineno": 397,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 397,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 398,
                    "end_region_line": 464,
                    "line": "        the sequence max_new_tokens times, feeding the predictions back into the model each time.\n",
                    "lineno": 398,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 398,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 399,
                    "end_region_line": 464,
                    "line": "        Most likely you'll want to make sure to be in model.eval() mode of operation for this.\n",
                    "lineno": 399,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 399,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 400,
                    "end_region_line": 464,
                    "line": "        \"\"\"\n",
                    "lineno": 400,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 400,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 402,
                    "end_region_line": 464,
                    "line": "        if max_new_tokens == -1:\n",
                    "lineno": 401,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 401,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 402,
                    "end_region_line": 464,
                    "line": "            max_new_tokens = 10000\n",
                    "lineno": 402,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 402,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 403,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 403,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 403,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 404,
                    "end_region_line": 464,
                    "line": "        kvcache = None\n",
                    "lineno": 404,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 404,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 405,
                    "end_region_line": 464,
                    "line": "        times = []\n",
                    "lineno": 405,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 405,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "        for token_count in range(max_new_tokens):\n",
                    "lineno": 406,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            if token_count % 20 == 0:\n",
                    "lineno": 407,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                start_time = time.time()\n",
                    "lineno": 408,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # if the sequence context is growing too long we must crop it at block_size\n",
                    "lineno": 409,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            idx_cond = idx #if idx.size(1) \\u003c= self.config.block_size else idx[:, -self.config.block_size:]\n",
                    "lineno": 410,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            age_cond = age #if age.size(1) \\u003c= self.config.block_size else age[:, -self.config.block_size:]\n",
                    "lineno": 411,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "\n",
                    "lineno": 412,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # forward the model to get the logits for the index in the sequence\n",
                    "lineno": 413,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            logits, _, _ , kvcache = self(idx_cond, age_cond, kvcache=kvcache)\n",
                    "lineno": 414,
                    "memory_samples": [
                        [
                            6555558377,
                            388.89013481140137
                        ],
                        [
                            6980735186,
                            398.87914276123047
                        ],
                        [
                            7241465760,
                            410.11006259918213
                        ],
                        [
                            7861426756,
                            432.24990463256836
                        ],
                        [
                            8565422664,
                            587.0490570068359
                        ],
                        [
                            8565429996,
                            566.4226226806641
                        ],
                        [
                            8565459027,
                            507.5613555908203
                        ],
                        [
                            8931363348,
                            600.4464769363403
                        ],
                        [
                            8931375449,
                            557.3186082839966
                        ],
                        [
                            9628502898,
                            629.7003049850464
                        ],
                        [
                            9628510559,
                            606.2613706588745
                        ],
                        [
                            9628514005,
                            594.5419034957886
                        ],
                        [
                            10048683430,
                            593.3020582199097
                        ],
                        [
                            10048696798,
                            581.3482160568237
                        ],
                        [
                            10530189525,
                            616.7205381393433
                        ],
                        [
                            10530192771,
                            604.0635709762573
                        ],
                        [
                            11507904258,
                            682.4437808990479
                        ],
                        [
                            11507907262,
                            668.8493137359619
                        ],
                        [
                            11507909500,
                            655.254846572876
                        ],
                        [
                            11507911661,
                            641.66037940979
                        ],
                        [
                            11507924608,
                            614.7058200836182
                        ],
                        [
                            12014724766,
                            685.1425590515137
                        ],
                        [
                            12014731365,
                            657.0161247253418
                        ],
                        [
                            12952883727,
                            654.9425458908081
                        ],
                        [
                            14078166826,
                            757.1192674636841
                        ],
                        [
                            14078169979,
                            741.1810503005981
                        ],
                        [
                            14078172336,
                            725.2428331375122
                        ],
                        [
                            14078176540,
                            693.3663988113403
                        ],
                        [
                            14692659515,
                            773.4127731323242
                        ],
                        [
                            14692665991,
                            757.0058059692383
                        ],
                        [
                            14692678366,
                            691.6123123168945
                        ],
                        [
                            15951567549,
                            794.5143928527832
                        ],
                        [
                            16607662917,
                            899.0721778869629
                        ],
                        [
                            16607665517,
                            885.531681060791
                        ],
                        [
                            17854319324,
                            875.1944999694824
                        ],
                        [
                            17854323148,
                            860.9352531433105
                        ],
                        [
                            18548862248,
                            909.7573204040527
                        ],
                        [
                            18548864931,
                            890.0534782409668
                        ],
                        [
                            19279525184,
                            894.9554023742676
                        ],
                        [
                            20847573460,
                            925.3017158508301
                        ],
                        [
                            25111104835,
                            1105.8323707580566
                        ],
                        [
                            26135748378,
                            1121.3870887756348
                        ],
                        [
                            31216456876,
                            929.4975395202637
                        ],
                        [
                            32068697923,
                            1163.178379058838
                        ],
                        [
                            41202293266,
                            1541.875774383545
                        ],
                        [
                            42466448599,
                            1613.4747047424316
                        ],
                        [
                            42466451882,
                            1588.0950813293457
                        ],
                        [
                            44348511326,
                            1662.752758026123
                        ],
                        [
                            44645866005,
                            1690.8514671325684
                        ],
                        [
                            44994331463,
                            1709.532627105713
                        ],
                        [
                            45319886944,
                            1720.4177055358887
                        ],
                        [
                            45319888777,
                            1709.8664360046387
                        ],
                        [
                            45532012361,
                            1725.6763954162598
                        ],
                        [
                            46007375083,
                            1744.652156829834
                        ],
                        [
                            46007377267,
                            1734.0644264221191
                        ],
                        [
                            46928912742,
                            545.7658653259277
                        ],
                        [
                            46928924580,
                            514.8262138366699
                        ],
                        [
                            47254253306,
                            592.487621307373
                        ],
                        [
                            47254257265,
                            581.7056541442871
                        ],
                        [
                            47254260406,
                            570.9236869812012
                        ],
                        [
                            47254265885,
                            549.3597526550293
                        ],
                        [
                            47508909221,
                            585.3006477355957
                        ],
                        [
                            47508912900,
                            574.0499305725098
                        ],
                        [
                            47863025721,
                            620.6330680847168
                        ],
                        [
                            47863044711,
                            585.474666595459
                        ],
                        [
                            47863047552,
                            573.755199432373
                        ],
                        [
                            47863050278,
                            558.3711891174316
                        ],
                        [
                            48229181472,
                            597.1892509460449
                        ],
                        [
                            48229183320,
                            585.001033782959
                        ],
                        [
                            48229185557,
                            574.945629119873
                        ],
                        [
                            48614429386,
                            647.1716957092285
                        ],
                        [
                            48614433888,
                            634.5147285461426
                        ],
                        [
                            48614441271,
                            609.2007942199707
                        ],
                        [
                            48614458583,
                            585.9415473937988
                        ],
                        [
                            49000086844,
                            597.2162895202637
                        ],
                        [
                            49422059101,
                            647.6922874450684
                        ],
                        [
                            49856332458,
                            675.1113929748535
                        ],
                        [
                            49856344852,
                            632.9217414855957
                        ],
                        [
                            49856346874,
                            620.6163368225098
                        ],
                        [
                            50626046901,
                            718.6397590637207
                        ],
                        [
                            50626049789,
                            703.6390419006348
                        ],
                        [
                            50626051818,
                            688.6383247375488
                        ],
                        [
                            50626053503,
                            673.6376075744629
                        ],
                        [
                            51573829332,
                            701.4721794128418
                        ],
                        [
                            51573832423,
                            685.5339622497559
                        ],
                        [
                            52108910075,
                            765.0468864440918
                        ],
                        [
                            52108912911,
                            748.6399192810059
                        ],
                        [
                            52108916677,
                            715.825984954834
                        ],
                        [
                            52618133090,
                            764.2170372009277
                        ],
                        [
                            52618135921,
                            747.3413200378418
                        ],
                        [
                            52618144598,
                            697.557918548584
                        ],
                        [
                            53790668790,
                            814.0829582214355
                        ],
                        [
                            53790671201,
                            796.2697410583496
                        ],
                        [
                            53790676922,
                            742.8300895690918
                        ],
                        [
                            53790678757,
                            725.4621849060059
                        ],
                        [
                            54870486403,
                            745.105152130127
                        ],
                        [
                            55466436079,
                            774.6725196838379
                        ],
                        [
                            67206920853,
                            1255.2452278137207
                        ],
                        [
                            68170216106,
                            1347.5251121520996
                        ],
                        [
                            69150070608,
                            1367.9853172302246
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.32422720983973596,
                    "n_cpu_percent_c": 0.6047710268466556,
                    "n_cpu_percent_python": 0.10551067780017219,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            if not use_kvcache:\n",
                    "lineno": 415,
                    "memory_samples": [
                        [
                            44348517450,
                            1652.6906547546387
                        ],
                        [
                            44348520066,
                            1641.4577522277832
                        ],
                        [
                            44645870941,
                            1670.0973472595215
                        ],
                        [
                            44645873060,
                            1654.220531463623
                        ],
                        [
                            44994336009,
                            1688.4285469055176
                        ],
                        [
                            44994337937,
                            1677.8527336120605
                        ],
                        [
                            44994339881,
                            1664.160243988037
                        ],
                        [
                            45319891085,
                            1699.1975135803223
                        ],
                        [
                            45319893020,
                            1689.1388053894043
                        ],
                        [
                            45319895358,
                            1675.3358345031738
                        ],
                        [
                            58079377122,
                            759.5140953063965
                        ],
                        [
                            58079379381,
                            749.4345054626465
                        ],
                        [
                            58079381279,
                            739.3549156188965
                        ],
                        [
                            58079382997,
                            729.2753257751465
                        ],
                        [
                            58079384791,
                            719.1957359313965
                        ],
                        [
                            58079386793,
                            709.1161460876465
                        ],
                        [
                            58079388532,
                            579.043155670166
                        ],
                        [
                            63897340433,
                            919.9648933410645
                        ],
                        [
                            63897343520,
                            908.0103034973145
                        ],
                        [
                            63897346196,
                            896.0557136535645
                        ],
                        [
                            63897348768,
                            884.1011238098145
                        ],
                        [
                            63897351205,
                            872.1465339660645
                        ],
                        [
                            63897353767,
                            860.1919441223145
                        ],
                        [
                            63897356253,
                            677.185359954834
                        ],
                        [
                            65668880635,
                            1008.7368965148926
                        ],
                        [
                            65668884845,
                            996.3135566711426
                        ],
                        [
                            65668887818,
                            983.8902168273926
                        ],
                        [
                            65668890548,
                            971.4668769836426
                        ],
                        [
                            65668893546,
                            959.0435371398926
                        ],
                        [
                            65668896153,
                            946.6201972961426
                        ],
                        [
                            65668899067,
                            748.9876365661621
                        ],
                        [
                            65668902058,
                            716.1163902282715
                        ],
                        [
                            72290073458,
                            1123.9101905822754
                        ],
                        [
                            72290075704,
                            1113.3622245788574
                        ],
                        [
                            72290077580,
                            1102.8142433166504
                        ],
                        [
                            72290079333,
                            1092.2662773132324
                        ],
                        [
                            72290080955,
                            1081.7182960510254
                        ],
                        [
                            72290082824,
                            1071.1703300476074
                        ],
                        [
                            72290084593,
                            1060.6223487854004
                        ],
                        [
                            72290086230,
                            1050.0743827819824
                        ],
                        [
                            72290087864,
                            796.821216583252
                        ],
                        [
                            74297518546,
                            1151.5358085632324
                        ],
                        [
                            74297522024,
                            1140.6362800598145
                        ],
                        [
                            74297525160,
                            1129.7367362976074
                        ],
                        [
                            74297528155,
                            1118.8372077941895
                        ],
                        [
                            74297551335,
                            1107.9376640319824
                        ],
                        [
                            74297554429,
                            1097.0381355285645
                        ],
                        [
                            74297561647,
                            1086.1385917663574
                        ],
                        [
                            74297563599,
                            1075.2390632629395
                        ],
                        [
                            74297565428,
                            804.828670501709
                        ],
                        [
                            74297567283,
                            766.3753929138184
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.35000881332593414,
                    "n_cpu_percent_c": 0.30549948522745324,
                    "n_cpu_percent_python": 0.02813618074671257,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                kvcache = None\n",
                    "lineno": 416,
                    "memory_samples": [
                        [
                            5448888903,
                            255.78601837158203
                        ],
                        [
                            5589885200,
                            293.92458724975586
                        ],
                        [
                            5589887876,
                            282.1977882385254
                        ],
                        [
                            5932560994,
                            324.51422691345215
                        ],
                        [
                            6561566492,
                            377.44757652282715
                        ],
                        [
                            6561573087,
                            345.7924633026123
                        ],
                        [
                            6729518936,
                            376.4971399307251
                        ],
                        [
                            6987095074,
                            387.51454162597656
                        ],
                        [
                            6987099009,
                            375.5565872192383
                        ],
                        [
                            6987104338,
                            363.5986328125
                        ],
                        [
                            6987107788,
                            351.6406784057617
                        ],
                        [
                            7248030116,
                            370.6495065689087
                        ],
                        [
                            7869974336,
                            378.5608787536621
                        ],
                        [
                            8573173542,
                            465.6728935241699
                        ],
                        [
                            8942015712,
                            535.9497451782227
                        ],
                        [
                            8942023176,
                            503.5963363647461
                        ],
                        [
                            9246504408,
                            544.7277908325195
                        ],
                        [
                            9246510273,
                            522.2213516235352
                        ],
                        [
                            9246516097,
                            490.1023178100586
                        ],
                        [
                            9640975332,
                            524.4100141525269
                        ],
                        [
                            9640977424,
                            512.6880445480347
                        ],
                        [
                            10062743375,
                            556.9259214401245
                        ],
                        [
                            11029880315,
                            589.0817270278931
                        ],
                        [
                            11523131586,
                            560.2727756500244
                        ],
                        [
                            11523133795,
                            546.6758060455322
                        ],
                        [
                            12032274631,
                            586.8802757263184
                        ],
                        [
                            12032280653,
                            545.1518669128418
                        ],
                        [
                            12562392132,
                            596.9396839141846
                        ],
                        [
                            12562396529,
                            567.8707447052002
                        ],
                        [
                            13531599907,
                            649.6905069351196
                        ],
                        [
                            13531639687,
                            573.2681589126587
                        ],
                        [
                            14096250016,
                            583.1347169876099
                        ],
                        [
                            15964696883,
                            763.9891014099121
                        ],
                        [
                            15964720632,
                            729.2951622009277
                        ],
                        [
                            16630478062,
                            832.0834159851074
                        ],
                        [
                            16630481056,
                            814.2676963806152
                        ],
                        [
                            16630484069,
                            796.451976776123
                        ],
                        [
                            17876406996,
                            850.9351921081543
                        ],
                        [
                            17876414238,
                            794.6764259338379
                        ],
                        [
                            17876416180,
                            775.9232063293457
                        ],
                        [
                            17876418196,
                            757.1699867248535
                        ],
                        [
                            18573127464,
                            870.5265235900879
                        ],
                        [
                            19303822905,
                            816.1914176940918
                        ],
                        [
                            19303828027,
                            777.7396659851074
                        ],
                        [
                            20084804276,
                            899.9069633483887
                        ],
                        [
                            20084806580,
                            889.8272285461426
                        ],
                        [
                            20084836139,
                            809.1893501281738
                        ],
                        [
                            20871022128,
                            884.0441703796387
                        ],
                        [
                            20871028902,
                            842.7877311706543
                        ],
                        [
                            21704232450,
                            930.3561897277832
                        ],
                        [
                            21704238215,
                            898.7107353210449
                        ],
                        [
                            21704239863,
                            888.1622505187988
                        ],
                        [
                            21704243550,
                            867.0652809143066
                        ],
                        [
                            21704245118,
                            856.5167961120605
                        ],
                        [
                            21704248502,
                            835.4198265075684
                        ],
                        [
                            22552038039,
                            935.225025177002
                        ],
                        [
                            22552047118,
                            892.0935859680176
                        ],
                        [
                            22552055227,
                            848.9621467590332
                        ],
                        [
                            24215069868,
                            1073.2380332946777
                        ],
                        [
                            24215074105,
                            1050.7348136901855
                        ],
                        [
                            24215079206,
                            1028.2315940856934
                        ],
                        [
                            24215084444,
                            994.4767646789551
                        ],
                        [
                            24215086074,
                            983.225154876709
                        ],
                        [
                            24215089361,
                            959.0266227722168
                        ],
                        [
                            24215091066,
                            946.0797004699707
                        ],
                        [
                            25141872675,
                            1094.3452796936035
                        ],
                        [
                            25141884376,
                            1059.8873252868652
                        ],
                        [
                            25141886918,
                            1048.4013404846191
                        ],
                        [
                            25141896866,
                            1002.4574012756348
                        ],
                        [
                            25141899366,
                            989.5104789733887
                        ],
                        [
                            25141906584,
                            966.7728843688965
                        ],
                        [
                            26173620597,
                            1109.666103363037
                        ],
                        [
                            26173624299,
                            1097.945743560791
                        ],
                        [
                            26173648906,
                            1004.1828651428223
                        ],
                        [
                            27186931121,
                            1102.5811042785645
                        ],
                        [
                            27186945897,
                            1018.8979606628418
                        ],
                        [
                            27186947827,
                            1007.1776008605957
                        ],
                        [
                            32093223248,
                            1136.9240531921387
                        ],
                        [
                            32093228810,
                            1097.5442237854004
                        ],
                        [
                            32093230455,
                            1084.4176139831543
                        ],
                        [
                            32093232237,
                            1071.2910041809082
                        ],
                        [
                            32093238795,
                            1004.9798774719238
                        ],
                        [
                            33184962974,
                            1371.675952911377
                        ],
                        [
                            34274281112,
                            1340.7169761657715
                        ],
                        [
                            34274286630,
                            1299.9308967590332
                        ],
                        [
                            34274290116,
                            1272.740177154541
                        ],
                        [
                            36588439021,
                            1391.9667472839355
                        ],
                        [
                            38984849354,
                            1385.9361152648926
                        ],
                        [
                            38984854597,
                            1364.1360206604004
                        ],
                        [
                            38984857050,
                            1353.2359733581543
                        ],
                        [
                            38984879138,
                            1309.63578414917
                        ],
                        [
                            41244488106,
                            1482.8765754699707
                        ],
                        [
                            41244494504,
                            1460.3733558654785
                        ],
                        [
                            41244496323,
                            1449.1217460632324
                        ],
                        [
                            41244503136,
                            1404.115306854248
                        ],
                        [
                            41244504955,
                            1392.863697052002
                        ],
                        [
                            42514310507,
                            1527.1500358581543
                        ],
                        [
                            42514314105,
                            1496.678066253662
                        ],
                        [
                            42514317367,
                            1466.20609664917
                        ],
                        [
                            42514324055,
                            1409.0707511901855
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # pluck the logits at the final step and scale by desired temperature\n",
                    "lineno": 417,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            logits = logits[:, -1, :] / temperature\n",
                    "lineno": 418,
                    "memory_samples": [
                        [
                            6337542454,
                            324.27670764923096
                        ],
                        [
                            6561575142,
                            329.95707511901855
                        ],
                        [
                            6987111651,
                            338.67018127441406
                        ],
                        [
                            7248034409,
                            343.45933628082275
                        ],
                        [
                            7559059538,
                            348.5310363769531
                        ],
                        [
                            7869983826,
                            353.88403701782227
                        ],
                        [
                            8573180592,
                            432.252254486084
                        ],
                        [
                            8942030356,
                            469.32022857666016
                        ],
                        [
                            9246518488,
                            475.84046173095703
                        ],
                        [
                            9640981573,
                            482.5658903121948
                        ],
                        [
                            10062755650,
                            489.6105146408081
                        ],
                        [
                            10545178061,
                            496.9369993209839
                        ],
                        [
                            11029898378,
                            504.5873193740845
                        ],
                        [
                            11523138486,
                            512.4325580596924
                        ],
                        [
                            12032285933,
                            520.6032447814941
                        ],
                        [
                            12562401547,
                            529.1040592193604
                        ],
                        [
                            12970132785,
                            537.8388776779175
                        ],
                        [
                            13531642774,
                            546.860161781311
                        ],
                        [
                            14096252755,
                            556.1056261062622
                        ],
                        [
                            14711792800,
                            565.6837768554688
                        ],
                        [
                            15964733297,
                            655.8127098083496
                        ],
                        [
                            16630490890,
                            756.8079948425293
                        ],
                        [
                            17876420918,
                            724.0705833435059
                        ],
                        [
                            18573145356,
                            740.6961784362793
                        ],
                        [
                            19303831207,
                            752.3137474060059
                        ],
                        [
                            20084840108,
                            764.1469306945801
                        ],
                        [
                            20871039463,
                            776.2655296325684
                        ],
                        [
                            21704252405,
                            788.6703758239746
                        ],
                        [
                            22552059931,
                            801.3572273254395
                        ],
                        [
                            24215093355,
                            916.9350318908691
                        ],
                        [
                            25141909673,
                            937.0071220397949
                        ],
                        [
                            26173662027,
                            950.8240394592285
                        ],
                        [
                            27186952551,
                            964.918041229248
                        ],
                        [
                            32093242691,
                            953.1460990905762
                        ],
                        [
                            33184993266,
                            1181.7127952575684
                        ],
                        [
                            34274297342,
                            1197.7781791687012
                        ],
                        [
                            36588449596,
                            1259.7163734436035
                        ],
                        [
                            38984887566,
                            1250.0074272155762
                        ],
                        [
                            41244519777,
                            1342.5455436706543
                        ],
                        [
                            42514326236,
                            1369.383113861084
                        ],
                        [
                            44111734193,
                            1643.928150177002
                        ],
                        [
                            45537904454,
                            1711.740406036377
                        ],
                        [
                            45757178414,
                            1708.8599815368652
                        ],
                        [
                            46012594913,
                            1717.0386695861816
                        ],
                        [
                            46271194450,
                            1724.4087409973145
                        ],
                        [
                            46930226230,
                            456.1799736022949
                        ],
                        [
                            47262536401,
                            525.1299858093262
                        ],
                        [
                            47518801539,
                            533.8723106384277
                        ],
                        [
                            47876925687,
                            543.4479026794434
                        ],
                        [
                            48239889845,
                            553.3054313659668
                        ],
                        [
                            48627618433,
                            563.4445381164551
                        ],
                        [
                            49012977023,
                            573.8662757873535
                        ],
                        [
                            49436496715,
                            584.5691261291504
                        ],
                        [
                            49870396720,
                            595.5524559020996
                        ],
                        [
                            50315968464,
                            606.8172035217285
                        ],
                        [
                            50641467508,
                            618.3623313903809
                        ],
                        [
                            51115393520,
                            630.1928901672363
                        ],
                        [
                            51590753384,
                            642.3003578186035
                        ],
                        [
                            52126484346,
                            654.688892364502
                        ],
                        [
                            52635466619,
                            667.3592720031738
                        ],
                        [
                            53204336812,
                            680.3719291687012
                        ],
                        [
                            53809675368,
                            693.5477180480957
                        ],
                        [
                            54424332422,
                            707.1244010925293
                        ],
                        [
                            54891329608,
                            720.9204368591309
                        ],
                        [
                            55489783054,
                            735.0019950866699
                        ],
                        [
                            56707614611,
                            845.692813873291
                        ],
                        [
                            58754673278,
                            792.614185333252
                        ],
                        [
                            59981904122,
                            976.4981956481934
                        ],
                        [
                            60731675544,
                            1065.5284004211426
                        ],
                        [
                            61490975378,
                            1082.1502952575684
                        ],
                        [
                            62282092265,
                            1099.050205230713
                        ],
                        [
                            67232839818,
                            1219.8960914611816
                        ],
                        [
                            68211934114,
                            1291.8435859680176
                        ],
                        [
                            69192639211,
                            1310.9951972961426
                        ],
                        [
                            70198493037,
                            1330.42915725708
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            logits[:,self.config.ignore_tokens] = -float('Inf')\n",
                    "lineno": 419,
                    "memory_samples": [
                        [
                            5448891321,
                            245.68702697753906
                        ],
                        [
                            5589892478,
                            257.77135848999023
                        ],
                        [
                            5932564744,
                            299.88258171081543
                        ],
                        [
                            6561577425,
                            316.1542720794678
                        ],
                        [
                            6987115068,
                            320.64579010009766
                        ],
                        [
                            7248036712,
                            323.1133508682251
                        ],
                        [
                            9246520760,
                            438.61041259765625
                        ],
                        [
                            9640983695,
                            442.06556224823
                        ],
                        [
                            10062757775,
                            445.66487407684326
                        ],
                        [
                            10545181921,
                            449.40542125701904
                        ],
                        [
                            11029900551,
                            453.28917026519775
                        ],
                        [
                            11523140911,
                            457.30722999572754
                        ],
                        [
                            12562403999,
                            465.7781467437744
                        ],
                        [
                            13531645473,
                            474.8125009536743
                        ],
                        [
                            16630494252,
                            660.4923133850098
                        ],
                        [
                            18573148930,
                            628.1960868835449
                        ],
                        [
                            19303834347,
                            634.054615020752
                        ],
                        [
                            24215095340,
                            768.0836143493652
                        ],
                        [
                            26173675251,
                            781.9281883239746
                        ],
                        [
                            27186955316,
                            789.0607643127441
                        ],
                        [
                            29191644642,
                            689.1894111633301
                        ],
                        [
                            33184995514,
                            961.0869636535645
                        ],
                        [
                            34274299677,
                            969.2456092834473
                        ],
                        [
                            36588451674,
                            1023.0583152770996
                        ],
                        [
                            38984890352,
                            996.7546424865723
                        ],
                        [
                            45537911888,
                            1668.5273246765137
                        ],
                        [
                            45757181492,
                            1697.8989601135254
                        ],
                        [
                            46012598031,
                            1706.4881782531738
                        ],
                        [
                            46012600687,
                            1695.6720161437988
                        ],
                        [
                            46012602364,
                            1667.8460960388184
                        ],
                        [
                            46271199118,
                            1704.3631324768066
                        ],
                        [
                            46271200936,
                            1672.2693901062012
                        ],
                        [
                            47262548425,
                            504.49917221069336
                        ],
                        [
                            47262551928,
                            460.1519966125488
                        ],
                        [
                            47518806859,
                            523.0881767272949
                        ],
                        [
                            47518809958,
                            512.3039970397949
                        ],
                        [
                            47518813234,
                            501.5198173522949
                        ],
                        [
                            47518818742,
                            464.3240089416504
                        ],
                        [
                            47876934758,
                            469.188663482666
                        ],
                        [
                            48239893553,
                            543.048999786377
                        ],
                        [
                            48239895948,
                            532.792537689209
                        ],
                        [
                            48239898083,
                            522.536060333252
                        ],
                        [
                            48239900123,
                            474.19462966918945
                        ],
                        [
                            48627630321,
                            479.34154891967773
                        ],
                        [
                            49012987631,
                            551.7127571105957
                        ],
                        [
                            49012989809,
                            540.6359672546387
                        ],
                        [
                            49012992163,
                            484.6304740905762
                        ],
                        [
                            49436503926,
                            561.5952949523926
                        ],
                        [
                            49870402535,
                            575.1574821472168
                        ],
                        [
                            49870404362,
                            564.9599723815918
                        ],
                        [
                            50315971715,
                            596.2681770324707
                        ],
                        [
                            50315973672,
                            585.7191047668457
                        ],
                        [
                            50315981871,
                            501.3392143249512
                        ],
                        [
                            50641471438,
                            607.461742401123
                        ],
                        [
                            50641474841,
                            596.561107635498
                        ],
                        [
                            50641481860,
                            507.1890296936035
                        ],
                        [
                            51115411023,
                            596.4363441467285
                        ],
                        [
                            51115413057,
                            585.1841468811035
                        ],
                        [
                            51115415065,
                            513.183650970459
                        ],
                        [
                            51590760936,
                            619.0928840637207
                        ],
                        [
                            51590770682,
                            595.8853645324707
                        ],
                        [
                            51590773462,
                            519.3145561218262
                        ],
                        [
                            52126487659,
                            642.7336158752441
                        ],
                        [
                            52126490020,
                            630.7782936096191
                        ],
                        [
                            52126491798,
                            618.8229713439941
                        ],
                        [
                            52635471058,
                            657.103572845459
                        ],
                        [
                            52635474109,
                            646.847843170166
                        ],
                        [
                            52635489688,
                            636.592098236084
                        ],
                        [
                            52635499186,
                            531.9984703063965
                        ],
                        [
                            53204341779,
                            659.2745628356934
                        ],
                        [
                            53809678929,
                            682.7060813903809
                        ],
                        [
                            54424335662,
                            695.9897956848145
                        ],
                        [
                            54424337844,
                            684.8551597595215
                        ],
                        [
                            54891332903,
                            709.492862701416
                        ],
                        [
                            54891334991,
                            698.065258026123
                        ],
                        [
                            54891337259,
                            686.637638092041
                        ],
                        [
                            55489805767,
                            566.1834449768066
                        ],
                        [
                            59981907815,
                            827.6465644836426
                        ],
                        [
                            60731682796,
                            1043.0255165100098
                        ],
                        [
                            60731685026,
                            1031.7740516662598
                        ],
                        [
                            60731691080,
                            998.0196571350098
                        ],
                        [
                            61490979554,
                            1070.6645011901855
                        ],
                        [
                            61490984840,
                            1047.6928215026855
                        ],
                        [
                            61490987212,
                            1036.2069816589355
                        ],
                        [
                            61490992310,
                            1013.2353019714355
                        ],
                        [
                            62282095660,
                            1087.33003616333
                        ],
                        [
                            67232844511,
                            972.9617881774902
                        ],
                        [
                            68211942668,
                            1261.7817344665527
                        ],
                        [
                            68211946463,
                            1241.7404747009277
                        ],
                        [
                            68211957567,
                            1211.6785926818848
                        ],
                        [
                            69192642820,
                            1300.7988243103027
                        ],
                        [
                            69192644946,
                            1290.6024208068848
                        ],
                        [
                            69192652929,
                            1249.8167762756348
                        ],
                        [
                            69192654786,
                            1239.6203575134277
                        ],
                        [
                            69192656583,
                            1229.4239540100098
                        ],
                        [
                            70198505109,
                            1299.312831878662
                        ],
                        [
                            70198510835,
                            1278.568447113037
                        ],
                        [
                            70198517235,
                            1257.824062347412
                        ],
                        [
                            70198532627,
                            1247.4518775939941
                        ],
                        [
                            70198535471,
                            1002.5663871765137
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.355636924555449,
                    "n_cpu_percent_c": 2.5458186097285544,
                    "n_cpu_percent_python": 0.24267455894039608,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # optionally crop the logits to only the top k options\n",
                    "lineno": 420,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            if top_k is not None:\n",
                    "lineno": 421,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.36727085852671,
                    "n_cpu_percent_c": 0.01176127525438443,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                v, _ = torch.topk(logits, min(top_k, logits.size(-1)))\n",
                    "lineno": 422,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                logits[logits \\u003c v[:, [-1]]] = -float('Inf')\n",
                    "lineno": 423,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                \n",
                    "lineno": 424,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            if no_repeat:\n",
                    "lineno": 425,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                fill = idx + 0\n",
                    "lineno": 426,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                fill[fill == 1] = 0\n",
                    "lineno": 427,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                logits = logits.scatter_(1, fill, -float(\"Inf\"))\n",
                    "lineno": 428,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            \n",
                    "lineno": 429,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # apply softmax to convert logits to (normalized) probabilities\n",
                    "lineno": 430,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # probs = F.softmax(logits, dim=-1)\n",
                    "lineno": 431,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # sample from the distribution\n",
                    "lineno": 432,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # idx_next = torch.multinomial(probs, num_samples=1)\n",
                    "lineno": 433,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # lse = torch.logsumexp(logits, -1)[:,None]\n",
                    "lineno": 434,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            t_next = torch.clamp( -torch.exp(-logits) * torch.rand(logits.shape, device=idx.device).log(),\n",
                    "lineno": 435,
                    "memory_samples": [
                        [
                            5029862823,
                            235.49744606018066
                        ],
                        [
                            15304219142,
                            560.104323387146
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.8483631807743375,
                    "n_core_utilization": 0.38248518135615583,
                    "n_cpu_percent_c": 0.09948214937292364,
                    "n_cpu_percent_python": 0.021102135560034433,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.480225563049316,
                    "n_malloc_mb": 10.480225563049316,
                    "n_mallocs": 0,
                    "n_peak_mb": 10.480225563049316,
                    "n_python_fraction": 0.000975,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 6.548822191587909e-05,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                min=0, max=365*80.\n",
                    "lineno": 436,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            ).min(1)\n",
                    "lineno": 437,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.36885459136620813,
                    "n_cpu_percent_c": 0.04690230990025147,
                    "n_cpu_percent_python": 0.007034045186678143,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            #age_next = age[...,[-1]] + torch.clamp(-torch.exp(-lse) * torch.rand(lse.shape, device=idx.device).log(), min=self.config.t_min, max=365*80.) #torch.normal(torch.zeros((1,1), device=idx.device),1.)\n",
                    "lineno": 438,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            idx_next = t_next[1][:,None]\n",
                    "lineno": 439,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            age_next = age[...,[-1]] + t_next[0][:,None]\n",
                    "lineno": 440,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            \n",
                    "lineno": 441,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            # append sampled index to the running sequence and continue\n",
                    "lineno": 442,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            idx = torch.cat((idx, idx_next), dim=1)\n",
                    "lineno": 443,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            age = torch.cat((age, age_next), dim=1)\n",
                    "lineno": 444,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "\n",
                    "lineno": 445,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "            if token_count % 20 == 0:\n",
                    "lineno": 446,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                end_time = time.time()\n",
                    "lineno": 447,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                elapsed_time = end_time - start_time    \n",
                    "lineno": 448,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                times.append(elapsed_time)\n",
                    "lineno": 449,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 450,
                    "end_region_line": 450,
                    "line": "                print(f\"Generated {token_count} tokens in {elapsed_time:.2f} seconds with kvcache {use_kvcache}\")\n",
                    "lineno": 450,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 406,
                    "start_region_line": 406
                },
                {
                    "end_outermost_loop": 451,
                    "end_region_line": 464,
                    "line": "            \n",
                    "lineno": 451,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 451,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 464,
                    "end_region_line": 464,
                    "line": "            #if torch.all(idx_next == self.config.vocab_size -1) or torch.all(age_next \\u003e max_age):\n",
                    "lineno": 452,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 395,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 464,
                    "end_region_line": 464,
                    "line": "            #    break\n",
                    "lineno": 453,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 395,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 454,
                    "end_region_line": 464,
                    "line": "        \n",
                    "lineno": 454,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 454,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 455,
                    "end_region_line": 464,
                    "line": "        pad = (torch.cumsum(torch.cumsum(idx == self.config.vocab_size -1,1).int(),1) \\u003e 1) + (age \\u003e max_age)\n",
                    "lineno": 455,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 455,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 456,
                    "end_region_line": 464,
                    "line": "        logits, _, _, kvcache = self(idx, age)\n",
                    "lineno": 456,
                    "memory_samples": [
                        [
                            43790169619,
                            1639.5814933776855
                        ],
                        [
                            43790173918,
                            1613.4362449645996
                        ],
                        [
                            76831200923,
                            1342.0749549865723
                        ],
                        [
                            76831204283,
                            1330.6480827331543
                        ],
                        [
                            76831206759,
                            1319.2212104797363
                        ],
                        [
                            76831209303,
                            1307.7943229675293
                        ],
                        [
                            76831211731,
                            1296.3674507141113
                        ],
                        [
                            76831213706,
                            1284.9405632019043
                        ],
                        [
                            76831215857,
                            1273.5136909484863
                        ],
                        [
                            76831218028,
                            1262.0868034362793
                        ],
                        [
                            76831220042,
                            1250.6599311828613
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 456,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 457,
                    "end_region_line": 464,
                    "line": "        idx[pad] = 0\n",
                    "lineno": 457,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 457,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 458,
                    "end_region_line": 464,
                    "line": "        age[pad] = float('NaN')\n",
                    "lineno": 458,
                    "memory_samples": [
                        [
                            76831226431,
                            1239.4089469909668
                        ],
                        [
                            76831229278,
                            1228.1578559875488
                        ],
                        [
                            76831231483,
                            1216.9067497253418
                        ],
                        [
                            76831233471,
                            1205.6556587219238
                        ],
                        [
                            76831235489,
                            1194.4045524597168
                        ],
                        [
                            76831237574,
                            1183.1534614562988
                        ],
                        [
                            76831239583,
                            1171.9023551940918
                        ],
                        [
                            76831241671,
                            1160.6512641906738
                        ],
                        [
                            76831246145,
                            872.5211448669434
                        ],
                        [
                            76831248436,
                            832.8295860290527
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.3649804924274987,
                    "n_cpu_percent_c": 0.10040220248335079,
                    "n_cpu_percent_python": 0.0035170225933390713,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 458,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 462,
                    "end_region_line": 464,
                    "line": "        if no_repeat:\n",
                    "lineno": 459,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 459,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 460,
                    "end_region_line": 464,
                    "line": "            fill = idx + 0\n",
                    "lineno": 460,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 460,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 461,
                    "end_region_line": 464,
                    "line": "            fill[fill == 1] = 0\n",
                    "lineno": 461,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 461,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 462,
                    "end_region_line": 464,
                    "line": "            logits = torch.stack([logits[:,j].scatter_(1, fill[:,:j+1], float(\"NaN\")) for j in range(fill.shape[1])]).transpose(0,1)\n",
                    "lineno": 462,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 462,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 463,
                    "end_region_line": 464,
                    "line": "\n",
                    "lineno": 463,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 463,
                    "start_region_line": 395
                },
                {
                    "end_outermost_loop": 464,
                    "end_region_line": 464,
                    "line": "        return idx, age, logits, kvcache, times \n",
                    "lineno": 464,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 464,
                    "start_region_line": 395
                }
            ],
            "percent_cpu_time": 98.27048831312385
        }
    },
    "gpu": false,
    "gpu_device": "",
    "growth_rate": 0.3962961490308437,
    "max_footprint_fname": "/Users/elenaschramme/Documents/Bachelorarbeit/Delphi/model.py",
    "max_footprint_lineno": 301,
    "max_footprint_mb": 1931.9470481872559,
    "max_footprint_python_fraction": 0.000149,
    "memory": true,
    "program": "/Users/elenaschramme/Documents/Bachelorarbeit/Delphi/benchmarking.py",
    "samples": [
        [
            5463170344,
            266.6134042739868
        ],
        [
            9146197325,
            555.2774820327759
        ],
        [
            9172723838,
            566.6279745101929
        ],
        [
            12471834960,
            646.3702611923218
        ],
        [
            13141573790,
            556.4083414077759
        ],
        [
            13280933916,
            614.4291009902954
        ],
        [
            14484252812,
            637.0071487426758
        ],
        [
            14566975294,
            684.2772417068481
        ],
        [
            15949337067,
            841.2127723693848
        ],
        [
            16120213185,
            722.5058326721191
        ],
        [
            19017137148,
            825.9063882827759
        ],
        [
            19035741745,
            836.1490287780762
        ],
        [
            19169295088,
            886.4551706314087
        ],
        [
            19368236463,
            710.4289894104004
        ],
        [
            19769795885,
            820.0621070861816
        ],
        [
            19970461569,
            911.3856592178345
        ],
        [
            20700316596,
            889.5874643325806
        ],
        [
            21243203336,
            830.1890525817871
        ],
        [
            21846671597,
            747.9074897766113
        ],
        [
            23032909886,
            886.8021965026855
        ],
        [
            23846291950,
            1000.4973487854004
        ],
        [
            23911655682,
            987.5601081848145
        ],
        [
            25013974365,
            1131.4978294372559
        ],
        [
            25405262460,
            909.0178413391113
        ],
        [
            25999164924,
            1138.7952308654785
        ],
        [
            26629394038,
            1001.3476448059082
        ],
        [
            26895087028,
            1086.2422523498535
        ],
        [
            27151932081,
            1163.3710107803345
        ],
        [
            27186891947,
            1090.6263694763184
        ],
        [
            27186908030,
            1030.852695465088
        ],
        [
            28484819825,
            1000.7168083190918
        ],
        [
            28771543783,
            927.4147300720215
        ],
        [
            30420119161,
            842.7992286682129
        ],
        [
            30487236996,
            871.2290306091309
        ],
        [
            32093207734,
            1022.7080497741699
        ],
        [
            33100565548,
            1592.1447868347168
        ],
        [
            33184950875,
            1216.43949508667
        ],
        [
            34236472794,
            1395.099521636963
        ],
        [
            34394170837,
            1065.886010169983
        ],
        [
            34563075587,
            679.6310920715332
        ],
        [
            34704721249,
            736.7848014831543
        ],
        [
            35120198303,
            908.4816246032715
        ],
        [
            35537431211,
            1073.2882652282715
        ],
        [
            35866771218,
            1257.5537147521973
        ],
        [
            36171256804,
            1446.7174110412598
        ],
        [
            36588411930,
            1377.9026374816895
        ],
        [
            36608658202,
            941.8799905776978
        ],
        [
            36850376383,
            623.0668344497681
        ],
        [
            38984826294,
            1320.535831451416
        ],
        [
            39121671255,
            625.5210914611816
        ],
        [
            39302225270,
            646.742244720459
        ],
        [
            41417956898,
            1201.7777061462402
        ],
        [
            41537006845,
            1219.0185022354126
        ],
        [
            41974834806,
            1451.3820276260376
        ],
        [
            42307695223,
            1641.7496910095215
        ],
        [
            42873186705,
            1287.6963005065918
        ],
        [
            44608965632,
            1704.5323295593262
        ],
        [
            44802206618,
            1684.4515953063965
        ],
        [
            45242397223,
            1735.648003578186
        ],
        [
            45259723513,
            1739.119441986084
        ],
        [
            46077163097,
            1689.741397857666
        ],
        [
            46169806933,
            1731.9400444030762
        ],
        [
            46957649067,
            481.7791557312012
        ],
        [
            47690096682,
            531.6144828796387
        ],
        [
            51160716602,
            567.4511270523071
        ],
        [
            54424317648,
            707.1244010925293
        ],
        [
            56272093100,
            757.1431131362915
        ],
        [
            56573804432,
            886.843204498291
        ],
        [
            56939019882,
            571.6575736999512
        ],
        [
            57535093345,
            736.3091087341309
        ],
        [
            57809106695,
            847.0808601379395
        ],
        [
            59248499281,
            690.9731330871582
        ],
        [
            59346435200,
            716.8708305358887
        ],
        [
            59554228482,
            854.1414985656738
        ],
        [
            59611637050,
            866.0463342666626
        ],
        [
            59683434473,
            919.404224395752
        ],
        [
            60149955854,
            938.5759696960449
        ],
        [
            60839243306,
            929.4720039367676
        ],
        [
            61108167419,
            1037.887035369873
        ],
        [
            61458523749,
            1209.5308265686035
        ],
        [
            61559073168,
            922.7205238342285
        ],
        [
            62141747119,
            1114.1198081970215
        ],
        [
            62248948824,
            1185.3749732971191
        ],
        [
            62456072643,
            989.4632453918457
        ],
        [
            63857521755,
            1139.1285209655762
        ],
        [
            63958269895,
            750.079647064209
        ],
        [
            64073414088,
            760.9407539367676
        ],
        [
            65399524517,
            1121.819522857666
        ],
        [
            65956045032,
            783.8699607849121
        ],
        [
            67027960010,
            1255.0510339736938
        ],
        [
            68675229538,
            1236.6732902526855
        ],
        [
            68995151860,
            1346.1482582092285
        ],
        [
            70483902442,
            1091.6833992004395
        ],
        [
            72103269853,
            1382.2609825134277
        ],
        [
            72420735959,
            897.8775262832642
        ],
        [
            73715970214,
            1219.425479888916
        ],
        [
            73971570768,
            1383.696849822998
        ],
        [
            74049781766,
            1398.6602516174316
        ],
        [
            74303695883,
            778.4212226867676
        ],
        [
            75681424847,
            1342.4451789855957
        ]
    ],
    "stacks": []
}

    </script>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script>
        function clickToLoadFile() {
            // Trigger the file input when the SVG is clicked
            document.getElementById('fileinput').click();
        }

        function handleFileChange() {
            var fileInput = document.getElementById('fileinput');
            if (fileInput.files.length > 0) {
                // Here, you can add what you want to do with the file
                console.log('File selected:', fileInput.files[0].name);
            }
        }
    </script>
	
  </head>
  <body>
    <div class="header">
      <p class="text-center">
	<a href="https://github.com/plasma-umass/scalene">
	  <img src="https://github.com/plasma-umass/scalene/raw/master/scalene/scalene-gui/scalene-image.png" height="100">
	</a>
      </p>
    </div>
	<div class="d-flex justify-content-center">
	  <details id="ai-optimization-options">
	    <summary style="font-size:0.8rem; color: blue">AI optimization options</summary>
	  <!-- <label for='demoinput' style="padding: 5px 5px; border-radius: 5px; border: 1px ridge black; font-size: 0.8rem; height: auto;">demo</label>
	  <input style="height: 0; width: 0; opacity:0" type='button' id='demoinput' accept='.json' onclick="loadDemo();">
	  -->
        <label for="service-select" style="font-size: 0.8rem">AI service provider:</label>
        <select style="font-size: 0.8rem" id="service-select" class="persistent" onchange="toggleServiceFields()">
          <option value="openai">OpenAI</span></option>
<!--          <option value="amazon">Amazon Bedrock</option> -->
          <option value="azure-openai">Azure OpenAI</option>
          <option value="local">Local</option>
    </select>
    <hr />
        <!-- OpenAI API Key Field -->
        <div id="openai-fields">
          <label for='api-key' style="font-size: 0.8rem">OpenAI <a href="https://beta.openai.com/signup">API key</a>:</label>
          <input type="text" style="font-size: 0.8rem" size="22" placeholder="(OpenAI API key)" id="api-key" oninput="checkApiKey(event.target.value)"></input>
          <span id="valid-api-key"></span>
          <br />
          <label style="font-size: 0.8rem" for="language-model-openai">
            Language model:
          </label>
          <select style="font-size: 0.8rem" id="language-model-openai" class="persistent" name="language-model-openai-label">
            <option value="gpt-3.5-turbo">GPT 3.5</option>
            <option value="gpt-4" selected>GPT 4.0</option>
          </select>
	      </div>
        
        <!-- Azure OpenAI API Key Field -->
        <div id="azure-openai-fields" style = "display: none;">
          
          <label for='azure-api-key' style="font-size: 0.8rem">Azure OpenAI API key:</label>
          <input type="text" style="font-size: 0.8rem" size="22" placeholder="(Azure OpenAI API key)" id="azure-api-key"></input>
          <span id="valid-api-key"></span>
          <br />
          <label style="font-size: 0.8rem" for="azure-api-url">
            API URL Azure Open AI:
          </label>
          <input type="text" style="font-size: 0.8rem" size="22" placeholder="(Azure OpenAI API URL)" id="azure-api-url"></input>
          <br />
          <label style="font-size: 0.8rem" for="azure-api-model">
            Language model:
          </label>
          <input type="text" style="font-size: 0.8rem" size="22" placeholder="(Azure OpenAI API Model)" id="azure-api-model"></input>
          <br />
          <label style="font-size: 0.8rem" for="azure-api-model-version">
            API Version:
          </label>
          <input type="text" style="font-size: 0.8rem" size="22" placeholder="(Azure OpenAI API Version)" id="azure-api-model-version"></input>
	      </div>

        <!-- Amazon Bedrock Fields -->
        <div id="amazon-fields" style="display: none;">
          <label for='aws-access-key' style="font-size: 0.8rem">AWS Access Key ID:</label>
    <input type="text" style="font-size: 0.8rem" size="22" placeholder="AKIAxxxxxxxxxxxxxxxx" id="aws-access-key" class="persistent"></input>
    <br />
    <label for='aws-secret-key' style="font-size: 0.8rem">AWS Secret Access Key:</label>
    <input type="text" style="font-size: 0.8rem" size="22" placeholder="(Secret Access Key)" id="aws-secret-key" class="persistent"></input>
    <br />
          <label style="font-size: 0.8rem" for="language-model-amazon">
            Language model:
          </label>
          <select style="font-size: 0.8rem" id="language-model-amazon" name="language-model-amazon-label">
            <option value="claude-2.1" selected>Claude 2.1</option>
          </select>
        </div>

        <!-- Local Fields -->
    <div id="local-fields" style="display: none; font-size: 0.8rem">
    Use this option if you are running a local language model. We currently support <a href="https://ollama.ai/">Ollama</a>.
    <br />
          <label for='local-ip' style="font-size: 0.8rem">IP Address:</label>
          <input type="text" style="font-size: 0.8rem" size="22" placeholder="localhost" id="local-ip" class="persistent" value="localhost"></input>
          <label for='local-port' style="font-size: 0.8rem">Port:</label>
    <input type="number" style="font-size: 0.8rem" size="22" placeholder="11434" id="local-port" class="persistent" value="11434"></input>
    <br />
    <div id="install-models-message" style="display:none;">
      <span style="color: red">Server not found or no language models installed.</span><br />
      Install language models as in <span style="background-color:rgb(220 220 220);"><code>ollama pull codellama:34b-python</code></span>.
    </div>

    <br />
    <div id="local-models-list">
          <label style="font-size: 0.8rem" for="language-model-local">
            Language model:
          </label>
    <span style="font-size: 0.8rem">
    </span>
    <div id="language-local-models"></div>
    </div>
        </div>
	  <br />
	  <B style="font-size:0.8rem">Proposed optimizations</B><BR />
	  <div>
	    <input type="radio" name="optimize-radio" id="optimize-performance" value="performance" class="persistent" checked>
	    <label style="font-size: 0.8rem" for="optimize-performance">
	      Optimize runtime performance
	    </label>
	  </div>
	  <div>
	    <input type="radio" name="optimize-radio" id="optimize-memory" class="persistent" value="memory">
	    <label style="font-size: 0.8rem" for="optimize-memory">
	      Optimize memory efficiency
	    </label>
	  </div>
	  <input type="checkbox" id="use-gpu-checkbox" name="use-gpu-checkbox-label" class="persistent" >
	  <!-- onclick="try { window.localStorage.setItem('scalene-gpu-checkbox', document.getElementById('use-gpu-checkbox').checked); } catch {}" -->
	  <label style="font-size: 0.8rem" for="use-gpu-checkbox" class="persistent">
	    Include GPU optimizations
	  </label>
	  <br />
	  <font style="font-size: 0.8rem">
	    Click on an explosion (&#128165;) to see proposed optimizations for a region of code,<br />
	    or on a lightning bolt (&#9889;) to propose optimizations for a specific line.<br />
	    Click again to generate a different one.<br />
	    <em>Note that optimizations are AI-generated and may not be correct.</em>
	    <br />
	  </font>
	  <br />
	  </details>
	</div>
    <div id="profile">
    </div>
    <script type="text/javascript">
      /// <reference types="aws-sdk" />

function vsNavigate(filename, lineno) {
  // If we are in VS Code, clicking on a line number in Scalene's web UI will navigate to that line in the source code.
  try {
    const vscode = acquireVsCodeApi();
    vscode.postMessage({
      command: "jumpToLine",
      filePath: filename,
      lineNumber: lineno,
    });
  } catch {}
}

function generateScaleneOptimizedCodeRequest(
  context,
  sourceCode,
  line,
  recommendedLibraries = [],
  includeGpuOptimizations = false,
) {
  // Default high-performance libraries known for their efficiency
  const defaultLibraries = [
    "NumPy",
    "Scikit-learn",
    "Pandas",
    "TensorFlow",
    "PyTorch",
  ];
  const highPerformanceLibraries = [
    ...new Set([...defaultLibraries, ...recommendedLibraries]),
  ];

  let promptParts = [
    "Optimize the following Python code to make it more efficient WITHOUT CHANGING ITS RESULTS.\n\n",
    context.trim(),
    "\n# Start of code\n",
    sourceCode.trim(),
    "\n# End of code\n\n",
    "Rewrite the above Python code from 'Start of code' to 'End of code', aiming for clear and simple optimizations. ",
    "Your output should consist only of valid Python code, with brief explanatory comments prefaced with #. ",
    "Include a detailed explanatory comment before the code, starting with '# Proposed optimization:'. ",
    "Leverage high-performance native libraries, especially those utilizing GPU, for significant performance improvements. ",
    "Consider using the following other libraries, if appropriate:\n",
    highPerformanceLibraries.map((e) => "  import " + e).join("\n") + "\n",
    "Eliminate as many for loops, while loops, and list or dict comprehensions as possible, replacing them with vectorized equivalents. ",
    //    "Consider GPU utilization, memory consumption, and copy volume when using GPU-accelerated libraries. ",
    //    "Low GPU utilization and high copy volume indicate inefficient use of such libraries. ",
    "Quantify the expected speedup in terms of orders of magnitude if possible. ",
    "Fix any errors in the optimized code. ",
    //    "Consider the peak amount of memory used per line and CPU utilization for targeted optimization. ",
    //    "Note on CPU utilization: Low utilization in libraries known for multi-threading/multi-processing indicates inefficiency.\n\n",
  ];

  // Conditional inclusion of GPU optimizations
  if (includeGpuOptimizations) {
    promptParts.push(
      "Use GPU-accelerated libraries whenever it would substantially increase performance. ",
    );
  }

  // Performance Insights
  promptParts.push(
    "Consider the following insights gathered from the Scalene profiler for optimization:\n",
  );
  const total_cpu_percent =
    line.n_cpu_percent_python + line.n_cpu_percent_c + line.n_sys_percent;

  promptParts.push(
    `- CPU time: percent spent in the Python interpreter: ${((100 * line.n_cpu_percent_python) / total_cpu_percent).toFixed(2)}%\n`,
  );
  promptParts.push(
    `- CPU time: percent spent executing native code: ${((100 * line.n_cpu_percent_c) / total_cpu_percent).toFixed(2)}%\n`,
  );
  promptParts.push(
    `- CPU time: percent of system time: ${((100 * line.n_sys_percent) / total_cpu_percent).toFixed(2)}%\n`,
  );
  // `- CPU utilization: ${performanceMetrics.cpu_utilization}. Low utilization with high-core count might indicate inefficient use of multi-threaded/multi-process libraries.\n`,
  promptParts.push(
    `- Core utilization: ${((100 * line.n_core_utilization) / total_cpu_percent).toFixed(2)}%\n`,
  );
  //      `- Peak memory per line: Focus on lines with high memory usage, specifically ${performanceMetrics.peak_memory_per_line}.\n`,
  promptParts.push(
    `- Peak memory usage: ${line.n_peak_mb.toFixed(0)}MB (${(100 * line.n_python_fraction).toFixed(2)}% Python memory)\n`,
  );
  //      `- Copy volume: ${performanceMetrics.copy_volume} MB. High volume indicates inefficient data handling with GPU libraries.\n`,
  if (line.n_copy_mb_s > 1) {
    promptParts.push(
      `- Megabytes copied per second by memcpy/strcpy: ${line.n_copy_mb_s.toFixed(2)}\n`,
    );
  }
  if (includeGpuOptimizations) {
    // `  - GPU utilization: ${performanceMetrics.gpu_utilization}%. Low utilization indicates potential inefficiencies in GPU-accelerated library use.\n`
    promptParts.push(
      `- GPU percent utilization: ${(100 * line.n_gpu_percent).toFixed(2)}%\n`,
    );
    // `  - GPU memory usage: ${performanceMetrics.gpu_memory} MB. Optimize to reduce unnecessary GPU memory consumption.\n`
    // TODO GPU memory
  }
  promptParts.push(`Optimized code:`);
  return promptParts.join("");
}

const recommendedLibraries = ["Cython", "Dask"]; // Add any domain-specific libraries here

// const prompt = generateScaleneOptimizedCodeRequest(context, sourceCode, line, recommendedLibraries, true);

function extractPythonCodeBlock(markdown) {
  // Pattern to match code blocks optionally tagged with "python"
  // - ``` optionally followed by "python"
  // - Non-greedy match for any characters (including new lines) between the backticks
  // - Flags:
  //   - 'g' for global search to find all matches
  //   - 's' to allow '.' to match newline characters
  const pattern = /```python\s*([\s\S]*?)```|```([\s\S]*?)```/g;

  let match;
  let extractedCode = "";
  // Use a loop to find all matches
  while ((match = pattern.exec(markdown)) !== null) {
    // Check which group matched. Group 1 is for explicitly tagged Python code, group 2 for any code block
    const codeBlock = match[1] ? match[1] : match[2];
    // Concatenate the extracted code blocks, separated by new lines if there's more than one block
    if (extractedCode && codeBlock) extractedCode += "\n\n";
    extractedCode += codeBlock;
  }

  return extractedCode;
}

const RightTriangle = "&#9658"; // right-facing triangle symbol (collapsed view)
const DownTriangle = "&#9660"; // downward-facing triangle symbol (expanded view)
const Lightning = "&#9889;"; // lightning bolt (for optimizing a line)
const Explosion = "&#128165;"; // explosion (for optimizing a region)
const WhiteLightning = `<span style="opacity:0">${Lightning}</span>`; // invisible but same width as lightning bolt
const WhiteExplosion = `<span style="opacity:0">${Explosion}</span>`; // invisible but same width as lightning bolt
const maxLinesPerRegion = 50; // Only show regions that are no more than this many lines.

let showedExplosion = {}; // Used so we only show one explosion per region.

function unescapeUnicode(s) {
  return s.replace(/\\u([\dA-F]{4})/gi, function (match, p1) {
    return String.fromCharCode(parseInt(p1, 16));
  });
}

async function tryApi(apiKey) {
  const response = await fetch("https://api.openai.com/v1/completions", {
    method: "GET",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${apiKey}`,
    },
  });
  return response;
}

async function isValidApiKey(apiKey) {
  const response = await tryApi(apiKey);
  const data = await response.json();
  if (
    data.error &&
    data.error.code in
      {
        invalid_api_key: true,
        invalid_request_error: true,
        model_not_found: true,
        insufficient_quota: true,
      }
  ) {
    return false;
  } else {
    return true;
  }
}

function checkApiKey(apiKey) {
  (async () => {
    try {
      window.localStorage.setItem("scalene-api-key", apiKey);
    } catch {}
    // If the API key is empty, clear the status indicator.
    if (apiKey.length === 0) {
      document.getElementById("valid-api-key").innerHTML = "";
      return;
    }
    const isValid = await isValidApiKey(apiKey);
    if (!isValid) {
      document.getElementById("valid-api-key").innerHTML = "&#10005;";
    } else {
      document.getElementById("valid-api-key").innerHTML = "&check;";
    }
  })();
}

function extractCode(text) {
  /**
   * Extracts code block from the given completion text.
   *
   * @param {string} text - A string containing text and other data.
   * @returns {string} Extracted code block from the completion object.
   */
  if (!text) {
    return text;
  }
  const lines = text.split("\n");
  let i = 0;
  while (i < lines.length && lines[i].trim() === "") {
    i++;
  }
  const first_line = lines[i].trim();
  let code_block;
  if (first_line === "```") {
    code_block = text.slice(3);
  } else if (first_line.startsWith("```")) {
    const word = first_line.slice(3).trim();
    if (word.length > 0 && !word.includes(" ")) {
      code_block = text.slice(first_line.length);
    } else {
      code_block = text;
    }
  } else {
    code_block = text;
  }
  const end_index = code_block.indexOf("```");
  if (end_index !== -1) {
    code_block = code_block.slice(0, end_index);
  }
  return code_block;
}

async function sendPromptToOpenAI(prompt, len, apiKey) {
  const endpoint = "https://api.openai.com/v1/chat/completions";
  const model = document.getElementById("language-model-openai").value;

  const body = JSON.stringify({
    model: model,
    messages: [
      {
        role: "system",
        content:
          "You are a Python programming assistant who ONLY responds with blocks of commented, optimized code. You never respond with text. Just code, starting with ``` and ending with ```.",
      },
      {
        role: "user",
        content: prompt,
      },
    ],
    user: "scalene-user",
  });

  console.log(body);

  const response = await fetch(endpoint, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${apiKey}`,
    },
    body: body,
  });

  const data = await response.json();
  if (data.error) {
    if (
      data.error.code in
      {
        invalid_request_error: true,
        model_not_found: true,
        insufficient_quota: true,
      }
    ) {
      if (data.error.code === "model_not_found" && model === "gpt-4") {
        // Technically, model_not_found applies only for GPT-4.0
        // if an account has not been funded with at least $1.
        alert(
          "You either need to add funds to your OpenAI account to use this feature, or you need to switch to GPT-3.5 if you are using free credits.",
        );
      } else {
        alert(
          "You need to add funds to your OpenAI account to use this feature.",
        );
      }
      return "";
    }
  }
  try {
    console.log(
      `Debugging info: Retrieved ${JSON.stringify(data.choices[0], null, 4)}`,
    );
  } catch {
    console.log(
      `Debugging info: Failed to retrieve data.choices from the server. data = ${JSON.stringify(
        data,
      )}`,
    );
  }

  try {
    return data.choices[0].message.content.replace(/^\s*[\r\n]/gm, "");
  } catch {
    // return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
    return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
  }
}

async function sendPromptToAzureOpenAI(prompt, len, apiKey, apiUrl, aiModel) {
  const apiVersion = document.getElementById("azure-api-model-version").value;
  const endpoint = `${apiUrl}/openai/deployments/${aiModel}/chat/completions?api-version=${apiVersion}`;

  const body = JSON.stringify({
    messages: [
      {
        role: "system",
        content:
          "You are a Python programming assistant who ONLY responds with blocks of commented, optimized code. You never respond with text. Just code, starting with ``` and ending with ```.",
      },
      {
        role: "user",
        content: prompt,
      },
    ],
    user: "scalene-user",
  });

  console.log(body);

  const response = await fetch(endpoint, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "api-key": apiKey,
    },
    body: body,
  });

  const data = await response.json();
  if (data.error) {
    if (
      data.error.code in
      {
        invalid_request_error: true,
        model_not_found: true,
        insufficient_quota: true,
      }
    ) {
      return "";
    }
  }
  try {
    console.log(
      `Debugging info: Retrieved ${JSON.stringify(data.choices[0], null, 4)}`,
    );
  } catch {
    console.log(
      `Debugging info: Failed to retrieve data.choices from the server. data = ${JSON.stringify(
        data,
      )}`,
    );
  }

  try {
    return data.choices[0].message.content.replace(/^\s*[\r\n]/gm, "");
  } catch {
    // return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
    return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
  }
}

async function sendPromptToAmazon(prompt, len) {
  const serviceName = "bedrock";
  const region = "us-west-2";
  const modelId = "anthropic.claude-v2";
  const endpoint = `https://${serviceName}-runtime.${region}.amazonaws.com/model/${modelId}/invoke`;
  // const model = document.getElementById('language-model-amazon').value;

  const body = JSON.stringify({
    prompt: `Human: ${prompt}\n\nAssistant:\n`,
    max_tokens_to_sample: 2048,
    temperature: 0,
    top_k: 250,
    top_p: 1,
    stop_sequences: ["\n\nHuman:"],
    anthropic_version: "bedrock-2023-05-31",
  });

  console.log(body);

  var bedrockruntime = new AWS.BedrockRuntime();
  bedrockruntime.invokeModel(body, function (err, data) {
    if (err)
      console.log(err, err.stack); // an error occurred
    else console.log(data); // successful response
  });
  const response = await fetch(endpoint, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      //	    Authorization: `Bearer ${apiKey}`,
    },
    body: body,
  });

  const data = await response.json();
  console.log(data);
  try {
    console.log(
      `Debugging info: Retrieved ${JSON.stringify(data.choices[0], null, 4)}`,
    );
  } catch {
    console.log(
      `Debugging info: Failed to retrieve data.choices from the server. data = ${JSON.stringify(
        data,
      )}`,
    );
  }

  try {
    return data.choices[0].message.content.replace(/^\s*[\r\n]/gm, "");
  } catch {
    // return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
    return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
  }
}

async function sendPromptToOllama(prompt, len, model, ipAddr, portNum) {
  const url = `http://${ipAddr}:${portNum}/api/chat`;
  const headers = { "Content-Type": "application/json" };
  const body = JSON.stringify({
    model: model,
    messages: [
      {
        role: "system",
        content:
          "You are an expert code assistant who only responds in Python code.", //You are a Python programming assistant who ONLY responds with blocks of commented, optimized code. You never respond with text. Just code, in a JSON object with the key "code".'
      },
      {
        role: "user",
        content: prompt,
      },
    ],
    stream: false,
    //	format: "json",
    temperature: 0.3,
    frequency_penalty: 0,
    presence_penalty: 0,
    user: "scalene-user",
  });

  console.log(body);

  let done = false;
  let responseAggregated = "";
  let retried = 0;
  const retries = 3;

  while (!done) {
    if (retried >= retries) {
      return {};
    }

    try {
      const response = await fetch(url, {
        method: "POST",
        headers: headers,
        body: body,
      });

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const text = await response.text();
      const responses = text.split("\n");
      for (const resp of responses) {
        const responseJson = JSON.parse(resp);
        if (responseJson.message && responseJson.message.content) {
          responseAggregated += responseJson.message.content;
        }

        if (responseJson.done) {
          done = true;
          break;
        }
      }
    } catch (error) {
      console.log(`Error: ${error}`);
      retried++;
    }
  }

  console.log(responseAggregated);
  try {
    return responseAggregated; // data.choices[0].message.content.replace(/^\s*[\r\n]/gm, "");
  } catch {
    // return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
    return "# Query failed. See JavaScript console (in Chrome: View > Developer > JavaScript Console) for more info.\n";
  }
}

function countSpaces(str) {
  // Use a regular expression to match any whitespace character at the start of the string
  const match = str.match(/^\s+/);

  // If there was a match, return the length of the match
  if (match) {
    return match[0].length;
  }

  // Otherwise, return 0
  return 0;
}

async function optimizeCode(imports, code, line, context) {
  // Tailor prompt to request GPU optimizations or not.
  const useGPUs = document.getElementById("use-gpu-checkbox").checked; // globalThis.profile.gpu;

  let recommendedLibraries = ["sklearn"];
  if (useGPUs) {
    // Suggest cupy if we are using the GPU.
    recommendedLibraries.push("cupy");
  } else {
    // Suggest numpy otherwise.
    recommendedLibraries.push("numpy");
  }
  // TODO: remove anything already imported in imports

  const bigPrompt = generateScaleneOptimizedCodeRequest(
    context,
    code,
    line,
    recommendedLibraries,
    useGPUs,
  );

  const useGPUstring = useGPUs ? " or the GPU " : " ";
  // Check for a valid API key.
  // TODO: Add checks for Amazon / local
  let apiKey = "";
  let aiService = document.getElementById("service-select").value;
  if (aiService === "openai") {
    apiKey = document.getElementById("api-key").value;
  } else if (aiService === "azure-openai") {
    apiKey = document.getElementById("azure-api-key").value;
  }

  if ((aiService === "openai" || aiService === "azure-openai") && !apiKey) {
    alert(
      "To activate proposed optimizations, enter an OpenAI API key in AI optimization options.",
    );
    document.getElementById("ai-optimization-options").open = true;
    return "";
  }
  // If the code to be optimized is just one line of code, say so.
  let lineOf = " ";
  if (code.split("\n").length <= 2) {
    lineOf = " line of ";
  }

  let libraries = "import sklearn";
  if (useGPUs) {
    // Suggest cupy if we are using the GPU.
    libraries += "\nimport cupy";
  } else {
    // Suggest numpy otherwise.
    libraries += "\nimport numpy as np";
  }

  // Construct the prompt.

  const optimizePerformancePrompt = `Optimize the following${lineOf}Python code:\n\n${context}\n\n# Start of code\n\n${code}\n\n# End of code\n\nRewrite the above Python code only from "Start of code" to "End of code", to make it more efficient WITHOUT CHANGING ITS RESULTS. Assume the code has already executed all these imports; do NOT include them in the optimized code:\n\n${imports}\n\nUse native libraries if that would make it faster than pure Python. Consider using the following other libraries, if appropriate:\n\n${libraries}\n\nYour output should only consist of valid Python code. Output the resulting Python with brief explanations only included as comments prefaced with #. Include a detailed explanatory comment before the code, starting with the text "# Proposed optimization:". Make the code as clear and simple as possible, while also making it as fast and memory-efficient as possible. Use vectorized operations${useGPUstring}whenever it would substantially increase performance, and quantify the speedup in terms of orders of magnitude. Eliminate as many for loops, while loops, and list or dict comprehensions as possible, replacing them with vectorized equivalents. If the performance is not likely to increase, leave the code unchanged. Fix any errors in the optimized code. Optimized${lineOf}code:`;

  const context_ollama = "";
  const optimizePerformancePrompt_ollama_prev = `Optimize the following${lineOf}Python code:\n\n${context_ollama}\n\n# Start of code\n\n${code}\n\n# End of code\n\nRewrite the above Python code only from "Start of code" to "End of code", to make it more efficient WITHOUT CHANGING ITS RESULTS. Only output your result in JSON, with the optimized code in "code". Optimized${lineOf}code:`;

  const optimizePerformancePrompt_ollama_pp = `Rewrite the following Python code to make it run faster. Use vectorization if possible, eliminating as many loops as possible. Try to reduce computational complexity of operations. Only output the optimized code in JSON with the key 'code'. Original code: ${code}. Optimized code:`;

  // TODO parameterize based on CPU utilization, Python vs. C time, GPU choice, memory efficiency.
  const optimizePerformancePrompt_ollama = `# Original code\n${code}\n\n# This code is an optimized version of the original code that dramatically improves its performance. Whenever possible, the code has been changed to use native libraries and vectorization, and data structures like lists have been replaced by sets or dicts. Do not change any function names. Optimized code:\n`;

  const pure_optimizePerformancePrompt = `Optimize the following${lineOf}Python code:\n\n${context}\n\n# Start of code\n\n${code}\n\n# End of code\n\nRewrite the above Python code only from "Start of code" to "End of code", to make it more efficient WITHOUT CHANGING ITS RESULTS. Assume the code has already executed all these imports; do NOT include them in the optimized code:\n\n${imports}\n\nONLY USE PURE PYTHON.\n\nYour output should only consist of valid Python code. Output the resulting Python with brief explanations only included as comments prefaced with #. Include a detailed explanatory comment before the code, starting with the text "# Proposed optimization:". Make the code as clear and simple as possible, while also making it as fast and memory-efficient as possible. If the performance is not likely to increase, leave the code unchanged. Fix any errors in the optimized code. Optimized${lineOf}code:`;

  const memoryEfficiencyPrompt = `Optimize the following${lineOf} Python code:\n\n${context}\n\n# Start of code\n\n${code}\n\n\n# End of code\n\nRewrite the above Python code only from "Start of code" to "End of code", to make it more memory-efficient WITHOUT CHANGING ITS RESULTS. Assume the code has already executed all these imports; do NOT include them in the optimized code:\n\n${imports}\n\nUse native libraries if that would make it more space efficient than pure Python. Consider using the following other libraries, if appropriate:\n\n${libraries}\n\nYour output should only consist of valid Python code. Output the resulting Python with brief explanations only included as comments prefaced with #. Include a detailed explanatory comment before the code, starting with the text "# Proposed optimization:". Make the code as clear and simple as possible, while also making it as fast and memory-efficient as possible. Use native libraries whenever possible to reduce memory consumption; invoke del on variables and array elements as soon as it is safe to do so. If the memory consumption is not likely to be reduced, leave the code unchanged. Fix any errors in the optimized code. Optimized${lineOf}code:`;

  const optimizePerf = document.getElementById("optimize-performance").checked;

  let prompt;
  if (optimizePerf) {
    prompt = optimizePerformancePrompt;
  } else {
    prompt = memoryEfficiencyPrompt;
  }

  // Just use big prompt maybe FIXME
  prompt = bigPrompt;

  // Use number of words in the original code as a proxy for the number of tokens.
  const numWords = code.match(/\b\w+\b/g).length;

  switch (document.getElementById("service-select").value) {
    case "openai": {
      console.log(prompt);
      const result = await sendPromptToOpenAI(
        prompt,
        Math.max(numWords * 4, 500),
        apiKey,
      );
      return extractCode(result);
    }
    case "local": {
      console.log("Running " + document.getElementById("service-select").value);
      console.log(prompt);
      //      console.log(optimizePerformancePrompt_ollama);
      const result = await sendPromptToOllama(
        prompt, // optimizePerformancePrompt_ollama,
        Math.max(numWords * 4, 500),
        document.getElementById("language-model-local").value,
        document.getElementById("local-ip").value,
        document.getElementById("local-port").value,
      );
      if (result.includes("```")) {
        return extractPythonCodeBlock(result);
      } else {
        return result;
      }
    }
    case "amazon": {
      console.log("Running " + document.getElementById("service-select").value);
      console.log(prompt); // optimizePerformancePrompt_ollama);
      const result = await sendPromptToAmazon(
        prompt, // optimizePerformancePrompt_ollama,
        Math.max(numWords * 4, 500),
      );
      console.log(
        document.getElementById("service-select").value + " not yet supported.",
      );
      return "";
    }
    case "azure-openai": {
      console.log("Running " + document.getElementById("service-select").value);
      console.log(prompt);
      let azureOpenAiEndpoint = document.getElementById("azure-api-url").value;
      let azureOpenAiModel = document.getElementById("azure-api-model").value;
      const result = await sendPromptToAzureOpenAI(
        prompt,
        Math.max(numWords * 4, 500),
        apiKey,
        azureOpenAiEndpoint,
        azureOpenAiModel,
      );
      return extractCode(result);
    }
  }
}

function proposeOptimizationRegion(filename, file_number, line) {
  proposeOptimization(
    filename,
    file_number,
    JSON.parse(decodeURIComponent(line)),
    { regions: true },
  );
}

function proposeOptimizationLine(filename, file_number, line) {
  proposeOptimization(
    filename,
    file_number,
    JSON.parse(decodeURIComponent(line)),
    { regions: false },
  );
}

function proposeOptimization(filename, file_number, line, params) {
  filename = unescape(filename);
  const useRegion = params["regions"];
  const prof = globalThis.profile;
  const this_file = prof.files[filename].lines;
  const imports = prof.files[filename].imports.join("\n");
  const start_region_line = this_file[line.lineno - 1]["start_region_line"];
  const end_region_line = this_file[line.lineno - 1]["end_region_line"];
  let context;
  const code_line = this_file[line.lineno - 1]["line"];
  let code_region;
  if (useRegion) {
    code_region = this_file
      .slice(start_region_line - 1, end_region_line)
      .map((e) => e["line"])
      .join("");
    context = this_file
      .slice(
        Math.max(0, start_region_line - 10),
        Math.min(start_region_line - 1, this_file.length),
      )
      .map((e) => e["line"])
      .join("");
  } else {
    code_region = code_line;
    context = this_file
      .slice(
        Math.max(0, line.lineno - 10),
        Math.min(line.lineno - 1, this_file.length),
      )
      .map((e) => e["line"])
      .join("");
  }
  // Count the number of leading spaces to match indentation level on output
  let leadingSpaceCount = countSpaces(code_line) + 3; // including the lightning bolt and explosion
  let indent =
    WhiteLightning + WhiteExplosion + "&nbsp;".repeat(leadingSpaceCount - 1);
  const elt = document.getElementById(`code-${file_number}-${line.lineno}`);
  (async () => {
    // TODO: check Amazon credentials
    const service = document.getElementById("service-select").value;
    if (service === "openai") {
      const isValid = await isValidApiKey(
        document.getElementById("api-key").value,
      );
      if (!isValid) {
        alert(
          "You must enter a valid OpenAI API key to activate proposed optimizations.",
        );
        document.getElementById("ai-optimization-options").open = true;
        return;
      }
    }
    if (service == "local") {
      if (
        document.getElementById("local-models-list").style.display === "none"
      ) {
        // No service was found.
        alert(
          "You must be connected to a running Ollama server to activate proposed optimizations.",
        );
        document.getElementById("ai-optimization-options").open = true;
        return;
      }
    }
    elt.innerHTML = `<em>${indent}working...</em>`;
    let message = await optimizeCode(imports, code_region, line, context);
    if (!message) {
      elt.innerHTML = "";
      return;
    }
    // Canonicalize newlines
    message = message.replace(new RegExp("\r?\n", "g"), "\n");
    // Indent every line and format it
    const formattedCode = message
      .split("\n")
      .map(
        (line) =>
          indent + Prism.highlight(line, Prism.languages.python, "python"),
      )
      .join("<br />");
    // Display the proposed optimization, with click-to-copy functionality.
    elt.innerHTML = `<hr><span title="click to copy" style="cursor: copy" id="opt-${file_number}-${line.lineno}">${formattedCode}</span>`;
    thisElt = document.getElementById(`opt-${file_number}-${line.lineno}`);
    thisElt.addEventListener("click", async (e) => {
      await copyOnClick(e, message);
      // After copying, briefly change the cursor back to the default to provide some visual feedback..
      thisElt.style = "cursor: auto";
      await new Promise((resolve) => setTimeout(resolve, 125));
      thisElt.style = "cursor: copy";
    });
  })();
}

async function copyOnClick(event, message) {
  event.preventDefault();
  event.stopPropagation();
  await navigator.clipboard.writeText(message);
}

function memory_consumed_str(size_in_mb) {
  // Return a string corresponding to amount of memory consumed.
  let gigabytes = Math.floor(size_in_mb / 1024);
  let terabytes = Math.floor(gigabytes / 1024);
  if (terabytes > 0) {
    return `${(size_in_mb / 1048576).toFixed(0)}T`;
  } else if (gigabytes > 0) {
    return `${(size_in_mb / 1024).toFixed(0)}G`;
  } else {
    return `${size_in_mb.toFixed(0)}M`;
  }
}

function time_consumed_str(time_in_ms) {
  let hours = Math.floor(time_in_ms / 3600000);
  let minutes = Math.floor((time_in_ms % 3600000) / 60000);
  let seconds = Math.floor((time_in_ms % 60000) / 1000);
  let hours_exact = time_in_ms / 3600000;
  let minutes_exact = (time_in_ms % 3600000) / 60000;
  let seconds_exact = (time_in_ms % 60000) / 1000;
  if (hours > 0) {
    return `${hours.toFixed(0)}h:${minutes_exact.toFixed(
      0,
    )}m:${seconds_exact.toFixed(3)}s`;
  } else if (minutes >= 1) {
    return `${minutes.toFixed(0)}m:${seconds_exact.toFixed(3)}s`;
  } else if (seconds >= 1) {
    return `${seconds_exact.toFixed(3)}s`;
  } else {
    return `${time_in_ms.toFixed(0)}ms`;
  }
}

function makeTooltip(title, value) {
    // Tooltip for time bars, below
    let secs = value / 100 * globalThis.profile.elapsed_time_sec;
    return `(${title}) ` + value.toFixed(1) + "%" + " [" + time_consumed_str(secs * 1e3) + "]"
}

function makeBar(python, native, system, params) {
  // Make a time bar
  const widthThreshold1 = 20;
  const widthThreshold2 = 10;
  // console.log(`makeBar ${python} ${native} ${system}`);
  return {
    $schema: "https://vega.github.io/schema/vega-lite/v5.json",
    config: {
      view: {
        stroke: "transparent",
      },
    },
    autosize: {
      contains: "padding",
    },
    width: params.width,
    height: params.height,
    padding: 0,
    data: {
      values: [
        {
          x: 0,
          y: python.toFixed(1),
          c: makeTooltip("Python", python),
          d:
            python >= widthThreshold1
              ? python.toFixed(0) + "%"
              : python >= widthThreshold2
                ? python.toFixed(0)
                : "",
          q: python / 2,
        },
        {
          x: 0,
          y: native.toFixed(1),
          c: makeTooltip("native", native),
          d:
            native >= widthThreshold1
              ? native.toFixed(0) + "%"
              : native >= widthThreshold2
                ? native.toFixed(0)
                : "",
          q: python + native / 2,
        },
        {
          x: 0,
          y: system.toFixed(1),
          c: makeTooltip("system", system),
          d:
            system >= widthThreshold1
              ? system.toFixed(0) + "%"
              : system >= widthThreshold2
                ? system.toFixed(0)
                : "",
          q: python + native + system / 2,
        },
      ],
    },
    layer: [
      {
        mark: { type: "bar" },
        encoding: {
          x: {
            aggregate: "sum",
            field: "y",
            axis: false,
            stack: "zero",
            scale: { domain: [0, 100] },
          },
          color: {
            field: "c",
            type: "nominal",
            legend: false,
            scale: { range: ["darkblue", "#6495ED", "blue"] },
          },
          tooltip: [{ field: "c", type: "nominal", title: "time" }],
        },
      },
      {
        mark: {
          type: "text",
          align: "center",
          baseline: "middle",
          dx: 0,
        },
        encoding: {
          x: {
            aggregate: "sum",
            field: "q",
            axis: false,
          },
          text: { field: "d" },
          color: { value: "white" },
          tooltip: [{ field: "c", type: "nominal", title: "time" }],
        },
      },
    ],
  };
}


function makeGPUPie(util, gpu_device, params) {
  return {
    $schema: "https://vega.github.io/schema/vega-lite/v5.json",
    config: {
      view: {
        stroke: "transparent",
      },
    },
    autosize: {
      contains: "padding",
    },
    width: 30,
    height: 20,
    padding: 0,
    data: {
      values: [
        {
          category: 1,
          value: util.toFixed(1),
          c: "in use: " + util.toFixed(1) + "%",
        },
      ],
    },
    mark: "arc",
    encoding: {
      theta: {
        field: "value",
        type: "quantitative",
        scale: { domain: [0, 100] },
      },
      color: {
        field: "c",
        type: "nominal",
        legend: false,
        scale: { range: ["goldenrod", "#f4e6c2"] },
      },
      tooltip: [{ field: "c", type: "nominal", title: gpu_device }],
    },
  };
}

function makeGPUBar(util, gpu_device, params) {
  return {
    $schema: "https://vega.github.io/schema/vega-lite/v5.json",
    config: {
      view: {
        stroke: "transparent",
      },
    },
    autosize: {
      contains: "padding",
    },
    width: params.width,
    height: params.height,
    padding: 0,
    data: {
      values: [
        {
            x: 0,
            y: util.toFixed(0),
	    q: (util / 2).toFixed(0),
	    d: util >= 20 ? util.toFixed(0) + "%" : "",
	    dd: "in use: " + util.toFixed(0) + "%",
        },
      ],
    },
    layer: [
      {
        mark: { type: "bar" },
        encoding: {
          x: {
            aggregate: "sum",
            field: "y",
            axis: false,
            scale: { domain: [0, 100] },
          },
          color: {
            field: "dd",
            type: "nominal",
            legend: false,
            scale: { range:  ["goldenrod", "#f4e6c2"] },
          },
          tooltip: [{ field: "dd", type: "nominal", title: gpu_device + ":" } ],
        },
      },
      {
        mark: {
          type: "text",
          align: "center",
          baseline: "middle",
            dx: 0,
        },
        encoding: {
          x: {
            aggregate: "sum",
            field: "q",
            axis: false,
          },
          text: { field: "d" },
          color: { value: "white" },
          tooltip: [{ field: "dd", type: "nominal", title: gpu_device + ":" } ],
        },
      },
    ],
  };
}

function makeMemoryPie(native_mem, python_mem, params) {
  return {
    $schema: "https://vega.github.io/schema/vega-lite/v5.json",
    width: params.width,
    height: 20,
    padding: 0,
    data: {
      values: [
        {
          category: 1,
          value: native_mem.toFixed(1),
          c: "native: " + native_mem.toFixed(1) + "%",
        },
        {
          category: 2,
          value: python_mem.toFixed(1),
          c: "Python: " + python_mem.toFixed(1) + "%",
        },
      ],
    },
    mark: "arc",
    encoding: {
      theta: {
        field: "value",
        type: "quantitative",
        scale: { domain: [0, 100] },
      },
      color: {
        field: "c",
        type: "nominal",
        legend: false,
        scale: { range: ["darkgreen", "#50C878"] },
      },
      tooltip: [{ field: "c", type: "nominal", title: "memory" }],
    },
  };
}

function makeMemoryBar(memory, title, python_percent, total, color, params) {
  return {
    $schema: "https://vega.github.io/schema/vega-lite/v5.json",
    config: {
      view: {
        stroke: "transparent",
      },
    },
    autosize: {
      contains: "padding",
    },
    width: params.width,
    height: params.height,
    padding: 0,
    data: {
      values: [
        {
          x: 0,
          y: python_percent * memory,
          c: "(Python) " + memory_consumed_str(python_percent * memory),
          d:
            python_percent * memory > total * 0.2
              ? memory_consumed_str(python_percent * memory)
              : "",
          q: (python_percent * memory) / 2,
        },
        {
          x: 0,
          y: (1.0 - python_percent) * memory,
          c: "(native) " + memory_consumed_str((1.0 - python_percent) * memory),
          d:
            (1.0 - python_percent) * memory > total * 0.2
              ? memory_consumed_str((1.0 - python_percent) * memory)
              : "",
          q: python_percent * memory + ((1.0 - python_percent) * memory) / 2,
        },
      ],
    },
    layer: [
      {
        mark: { type: "bar" },
        encoding: {
          x: {
            aggregate: "sum",
            field: "y",
            axis: false,
            scale: { domain: [0, total] },
          },
          color: {
            field: "c",
            type: "nominal",
            legend: false,
            scale: { range: [color, "#50C878", "green"] },
          },
          // tooltip: [{ field: "c", type: "nominal", title: title }],
        },
      },
      {
        mark: {
          type: "text",
          align: "center",
          baseline: "middle",
          dx: 0,
        },
        encoding: {
          x: {
            aggregate: "sum",
            field: "q",
            axis: false,
          },
          text: { field: "d" },
          color: { value: "white" },
        },
      },
    ],
  };
}

function makeSparkline(samples, max_x, max_y, leak_velocity = 0, params) {
  const values = samples.map((v, i) => {
    let leak_str = "";
    if (leak_velocity != 0) {
      leak_str = `; possible leak (${memory_consumed_str(leak_velocity)}/s)`;
    }
    return {
      x: v[0],
      y: v[1],
      y_text:
        memory_consumed_str(v[1]) +
        " (@ " +
        time_consumed_str(v[0] / 1e6) +
        ")" +
        leak_str,
    };
  });
  let leak_info = "";
  if (leak_velocity != 0) {
    leak_info = "possible leak";
    params.height -= 10; // FIXME should be actual height of font
  }

  const strokeWidth = 1; // 0.25;
  return {
    $schema: "https://vega.github.io/schema/vega-lite/v5.json",
    data: { values: values },
    width: params.width,
    height: params.height,
    padding: 0,
    title: {
      text: leak_info,
      baseline: "line-bottom",
      color: "red",
      offset: 0,
      lineHeight: 10,
      orient: "bottom",
      fontStyle: "italic",
    },
    encoding: {
      x: {
        field: "x",
        type: "quantitative",
        title: "",
        axis: {
          tickCount: 10,
          tickSize: 0,
          labelExpr: "",
        },
        scale: {
          domain: [0, max_x],
        },
      },
    },
    layer: [
      {
        encoding: {
          y: {
            field: "y",
            type: "quantitative",
            axis: null,
            scale: {
              domain: [0, max_y],
            },
          },
          color: {
            field: "c",
            type: "nominal",
            legend: null,
            scale: {
              range: ["darkgreen"],
            },
          },
        },

        layer: [
          { mark: "line" },
          {
            transform: [{ filter: { param: "hover", empty: false } }],
            mark: "point",
          },
        ],
      },

      {
        mark: "rule",
        encoding: {
          opacity: {
            condition: { value: 0.3, param: "hover", empty: false },
            value: 0,
          },
          tooltip: [{ field: "y_text", type: "nominal", title: "memory" }],
        },
        params: [
          {
            name: "hover",
            select: {
              type: "point",
              fields: ["y"],
              nearest: true,
              on: "mousemove",
            },
          },
        ],
      },
    ],
  };
}

const CPUColor = "blue";
const MemoryColor = "green";
const CopyColor = "goldenrod";
let columns = [];

function makeTableHeader(fname, gpu, gpu_device, memory, params) {
  let tableTitle;
  if (params["functions"]) {
    tableTitle = "function profile";
  } else {
    tableTitle = "line profile";
  }
  columns = [
    {
      title: ["time", ""],
      color: CPUColor,
      width: 0,
      info: "Execution time (Python + native + system)",
    },
  ];
  if (memory) {
    columns = columns.concat([
      {
        title: ["memory", "peak"],
        color: MemoryColor,
        width: 0,
        info: "Peak amount of memory allocated by line / function",
      },
      {
        title: ["memory", "average"],
        color: MemoryColor,
        width: 0,
        info: "Average amount of memory allocated by line / function",
      },
      {
        title: ["memory", "timeline"],
        color: MemoryColor,
        width: 0,
        info: "Memory footprint over time",
      },
      {
        title: ["memory", "activity"],
        color: MemoryColor,
        width: 0,
        info: "% of bytes allocated by line / function over total bytes allocated in file",
      },
      {
        title: ["copy", ""],
        color: CopyColor,
        width: 0,
        info: "Rate of copying memory",
      },
    ]);
  }
  if (gpu) {
    columns.push({
      title: [gpu_device, "util."],
      color: CopyColor,
      width: 0,
	info: `% utilization of ${gpu_device} by line / function (may be inaccurate if ${gpu_device} is not dedicated)`,
    });
    columns.push({
      title: [gpu_device, "memory"],
      color: CopyColor,
      width: 0,
	info: `Peak ${gpu_device} memory allocated by line / function (may be inaccurate if ${gpu_device} is not dedicated)`,
    });
  }
  columns.push({ title: ["", ""], color: "black", width: 100 });
  let s = "";
  s += '<thead class="thead-light">';
  s += '<tr data-sort-method="thead">';
  for (const col of columns) {
    s += `<th class="F${escape(
      fname,
    )}-nonline"><font style="font-variant: small-caps; text-decoration: underline; width:${
      col.width
    }" color=${col.color}>`;
    if (col.info) {
      s += `<a style="cursor:pointer;" title="${col.info}">${col.title[0]}</a>`;
    } else {
      s += `<a style="cursor:pointer;">${col.title[0]}</a>`;
    }
    s += "</font>&nbsp;&nbsp;</th>";
  }
  let id;
  if (params["functions"]) {
    id = "functionProfile";
  } else {
    id = "lineProfile";
  }
  s += `<th id=${
    escape(fname) + "-" + id
  } style="width:10000"><font style="font-variant: small-caps; text-decoration: underline">${tableTitle}</font><font style="font-size:small; font-style: italic">&nbsp; (click to reset order)</font></th>`;
  s += "</tr>";
  s += '<tr data-sort-method="thead">';
  for (const col of columns) {
    s += `<th style="width:${col.width}"><em><font style="font-size: small" color=${col.color}>${col.title[1]}</font></em></th>`;
  }
  s += `<th><code>${fname}</code></th></tr>`;
  s += "</thead>";
  return s;
}

function hideEmptyProfiles() {
  const elts = document.getElementsByClassName("empty-profile");
  for (elt of elts) {
    s = elt.style;
    s.display = "none";
  }
}

function toggleReduced() {
  const elts = document.getElementsByClassName("empty-profile");
  for (elt of elts) {
    s = elt.style;
    if (s.display == "") {
      s.display = "none";
    } else {
      s.display = "";
    }
  }
}

function makeProfileLine(
  line,
  filename,
  file_number,
  prof,
  cpu_bars,
  memory_bars,
  memory_sparklines,
  memory_activity,
  gpu_pies,
  propose_optimizations,
) {
  let total_time =
    line.n_cpu_percent_python + line.n_cpu_percent_c + line.n_sys_percent;
  let total_region_time = 0;
  let region_has_memory_results = 0;
  let region_has_gpu_results = 0;
  for (
    let lineno = line.start_region_line;
    lineno < line.end_region_line;
    lineno++
  ) {
    currline = prof["files"][filename]["lines"][lineno];
    total_region_time +=
      currline.n_cpu_percent_python +
      currline.n_cpu_percent_c +
      currline.n_sys_percent;
    region_has_memory_results +=
      currline.n_avg_mb +
      currline.n_peak_mb +
      currline.memory_samples.length +
      (currline.n_usage_fraction >= 0.01);
    region_has_gpu_results |= line.n_gpu_percent >= 1.0;
  }
  // Disable optimization proposals for low CPU runtime lines.

  // TODO: tailor prompt for memory optimization when that's the only inefficiency.
  // ALSO propose optimizations not just for execution time but also for memory usage.
  if (propose_optimizations) {
    if (total_time < 1.0 && line.start_region_line === line.end_region_line) {
      propose_optimizations = false;
    }
    if (line.start_region_line != line.end_region_line) {
      if (total_region_time < 1.0) {
        propose_optimizations = false;
      }
    }
  }
  const has_memory_results =
    line.n_avg_mb +
    line.n_peak_mb +
    line.memory_samples.length +
    (line.n_usage_fraction >= 0.01);
  const has_gpu_results = line.n_gpu_percent >= 1.0;
  const start_region_line = line.start_region_line;
  const end_region_line = line.end_region_line;
  // Only show the explosion (optimizing a whole region) once.
  let explosionString;
  let showExplosion;
  if (
    start_region_line === end_region_line ||
    [[start_region_line - 1, end_region_line]] in showedExplosion
  ) {
    explosionString = WhiteExplosion;
    showExplosion = false;
  } else {
    explosionString = Explosion;
    if (start_region_line && end_region_line) {
      showedExplosion[[start_region_line - 1, end_region_line]] = true;
      showExplosion = true;
    }
  }
  // If the region is too big, for some definition of "too big", don't show it.
  showExplosion &= end_region_line - start_region_line <= maxLinesPerRegion;

  let s = "";
  if (
    total_time > 1.0 ||
    has_memory_results ||
    has_gpu_results ||
    (showExplosion &&
      start_region_line != end_region_line &&
      (total_region_time >= 1.0 ||
        region_has_memory_results ||
        region_has_gpu_results))
  ) {
    s += "<tr>";
  } else {
    s += "<tr class='empty-profile'>";
  }
  const total_time_str = String(total_time.toFixed(1)).padStart(10, " ");
  s += `<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${total_time_str}'>`;
  s += `<span style="height: 20; width: 100; vertical-align: middle" id="cpu_bar${cpu_bars.length}"></span>`;
  if (total_time) {
    cpu_bars.push(
      makeBar(
        line.n_cpu_percent_python,
        line.n_cpu_percent_c,
        line.n_sys_percent,
          { height: 20, width: 100 },
      ),
    );
  } else {
    cpu_bars.push(null);
  }
  if (prof.memory) {
    s += `<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${String(
      line.n_peak_mb.toFixed(0),
    ).padStart(10, "0")}'>`;
    s += `<span style="height: 20; width: 100; vertical-align: middle" id="memory_bar${memory_bars.length}"></span>`;
    if (line.n_peak_mb) {
      memory_bars.push(
        makeMemoryBar(
          line.n_peak_mb.toFixed(0),
          "peak memory",
          parseFloat(line.n_python_fraction),
          prof.max_footprint_mb.toFixed(2),
          "darkgreen",
          { height: 20, width: 100 },
        ),
      );
    } else {
      memory_bars.push(null);
    }
    s += `<td style="height: 20; width: 100; vertical-align: middle" align="left" data-sort='${String(
      line.n_avg_mb.toFixed(0),
    ).padStart(10, "0")}'>`;
    s += `<span style="height: 20; width: 100; vertical-align: middle" id="memory_bar${memory_bars.length}"></span>`;
    s += "</td>";
    if (line.n_avg_mb) {
      memory_bars.push(
        makeMemoryBar(
          line.n_avg_mb.toFixed(0),
          "average memory",
          parseFloat(line.n_python_fraction),
          prof.max_footprint_mb.toFixed(2),
          "darkgreen",
          { height: 20, width: 100 },
        ),
      );
    } else {
      memory_bars.push(null);
    }
    s += "</td>";
    s += `<td style='vertical-align: middle; width: 100'><span style="height:20; width: 100; vertical-align: middle" id="memory_sparkline${memory_sparklines.length}"></span>`;
    s += "</td>";
    if (line.memory_samples.length > 0) {
      let leak_velocity = 0;
      if ("leaks" in prof.files[filename]) {
        if (line.lineno in prof.files[filename].leaks) {
          leak_velocity = prof.files[filename].leaks[line.lineno].velocity_mb_s;
        }
      }
      memory_sparklines.push(
        makeSparkline(
          line.memory_samples,
          prof.elapsed_time_sec * 1e9,
          prof.max_footprint_mb,
          leak_velocity,
          { height: 20, width: 75 },
        ),
      );
    } else {
      memory_sparklines.push(null);
    }
    s += '<td style="width: 100; vertical-align: middle" align="center">';
    if (line.n_usage_fraction >= 0.01) {
      s += `<span style="height: 20; width: 30; vertical-align: middle" id="memory_activity${memory_activity.length}"></span>`;
      memory_activity.push(
        makeMemoryPie(
          100 *
            line.n_usage_fraction *
            (1 - parseFloat(line.n_python_fraction)),
          100 * line.n_usage_fraction * parseFloat(line.n_python_fraction),
          { width: 30 },
        ),
      );
    } else {
      memory_activity.push(null);
    }
    //      s += `<font style="font-size: small">${String(
    //        (100 * line.n_usage_fraction).toFixed(0)
    //      ).padStart(10, " ")}%&nbsp;&nbsp;&nbsp;</font>`;
    s += "</td>";
    if (line.n_copy_mb_s < 1.0) {
      s += '<td style="width: 100"></td>';
    } else {
      s += `<td style="width: 100; vertical-align: middle" align="right"><font style="font-size: small" color="${CopyColor}">${line.n_copy_mb_s.toFixed(
        0,
      )}&nbsp;&nbsp;&nbsp;</font></td>`;
    }
  }
  if (prof.gpu) {
    if (line.n_gpu_percent < 1.0) {
      s += '<td style="width: 100"></td>';
    } else {
      //	    s += `<td style="width: 100; vertical-align: middle" align="right"><font style="font-size: small" color="${CopyColor}">${line.n_gpu_percent.toFixed(0)}%</font></td>`;
      s += `<td style="width: 50; vertical-align: middle" align="right" data-sort="${line.n_gpu_percent}">`;
      s += `<span style="height: 20; width: 30; vertical-align: middle" id="gpu_pie${gpu_pies.length}"></span>`;
      s += "</td>";
      gpu_pies.push(makeGPUPie(line.n_gpu_percent, prof.gpu_device, { height: 20, width: 100 }));
      // gpu_pies.push(makeGPUBar(line.n_gpu_percent, prof.gpu_device, { height: 20, width: 100 }));
    }
    if (true) {
      if (line.n_gpu_peak_memory_mb < 1.0 || line.n_gpu_percent < 1.0) {
        s += '<td style="width: 100"></td>';
      } else {
	  let mem = line.n_gpu_peak_memory_mb;
	  let memStr = "MB";
	  if (mem >= 1024) {
	      mem /= 1024;
	      memStr = "GB";
	  }
          s += `<td style="width: 100; vertical-align: middle" align="right"><font style="font-size: small" color="${CopyColor}">${mem.toFixed(0)}${memStr}&nbsp;&nbsp;</font></td>`;
      }
    }
  }
  const empty_profile =
    total_time ||
    has_memory_results ||
    has_gpu_results ||
    end_region_line != start_region_line
      ? ""
      : "empty-profile";
  s += `<td align="right" class="dummy ${empty_profile}" style="vertical-align: middle; width: 50" data-sort="${
    line.lineno
  }"><span onclick="vsNavigate('${escape(filename)}',${
    line.lineno
  })"><font color="gray" style="font-size: 70%; vertical-align: middle" >${
    line.lineno
  }&nbsp;</font></span></td>`;

  const regionOptimizationString =
    propose_optimizations && showExplosion
      ? `${explosionString}&nbsp;`
      : `${WhiteExplosion}&nbsp;`;

  // Convert back any escaped Unicode.
  line.line = unescapeUnicode(line.line);

  const codeLine = Prism.highlight(line.line, Prism.languages.python, "python");
  s += `<td style="height:10" align="left" bgcolor="whitesmoke" style="vertical-align: middle" data-sort="${line.lineno}">`;
  let newLine = structuredClone(line);
  // TODO: verify that this isn't double counting anything
  if (propose_optimizations && showExplosion) {
    // Construct a new line corresponding to this region.
    let mb_copied = 0;
    for (let lineno = start_region_line; lineno < end_region_line; lineno++) {
      currline = prof["files"][filename]["lines"][lineno];
      mb_copied += currline.n_copy_mb * prof.elapsed_time_sec;
      newLine.n_cpu_percent_python += currline.n_cpu_percent_python;
      newLine.n_cpu_percent_c += currline.n_cpu_percent_c;
      newLine.n_sys_percent += currline.n_sys_percent;
      newLine.n_gpu_percent += currline.n_gpu_percent;
      if (currline.n_peak_mb > newLine.n_peak_mb) {
        newLine.n_peak_mb = currline.n_peak_mb;
        newLine.n_python_fraction = currline.n_python_fraction;
      }
      // TODO:
      // GPU memory
      newLine.n_core_utilization +=
        (currline.n_cpu_percent_python + currline.n_cpu_percent_c) *
        currline.n_core_utilization; // weigh by percentage
    }
    newLine.n_copy_mb_s = mb_copied / prof.elapsed_time_sec;
    s += `<span style="vertical-align: middle; cursor: pointer" title="Propose an optimization for the entire region starting here." onclick="proposeOptimizationRegion('${escape(
      filename,
    )}', ${file_number}, '${encodeURIComponent(JSON.stringify(newLine))}'); event.preventDefault()">${regionOptimizationString}</span>`;
  } else {
    s += regionOptimizationString;
  }

  const lineOptimizationString = propose_optimizations
    ? `${Lightning}`
    : `${WhiteLightning}`;
  if (propose_optimizations) {
    s += `<span style="vertical-align: middle; cursor: pointer" title="Propose an optimization for this line." onclick="proposeOptimizationLine('${escape(filename)}', ${file_number}, '${encodeURIComponent(JSON.stringify(line))}'); event.preventDefault()">${lineOptimizationString}</span>`;
    // s += `<span style="vertical-align: middle; cursor: pointer" title="Propose an optimization for this line." onclick="proposeOptimizationLine('${escape(filename,)}', ${file_number}, ${JSON.stringify(line)}); event.preventDefault()">${lineOptimizationString}</span>`;
  } else {
    s += lineOptimizationString;
  }
  s += `<pre style="height: 10; display: inline; white-space: pre-wrap; overflow-x: auto; border: 0px; vertical-align: middle"><code class="language-python ${empty_profile}">${codeLine}<span id="code-${file_number}-${line.lineno}" bgcolor="white"></span></code></pre></td>`;
  s += "</tr>";
  return s;
}

// Track all profile ids so we can collapse and expand them en masse.
let allIDs = [];

function collapseAll() {
  for (const id of allIds) {
    collapseDisplay(id);
  }
}

function expandAll() {
  for (const id of allIds) {
    expandDisplay(id);
  }
}

function collapseDisplay(id) {
  const d = document.getElementById(`profile-${id}`);
  d.style.display = "none";
  document.getElementById(`button-${id}`).innerHTML = RightTriangle;
}

function expandDisplay(id) {
  const d = document.getElementById(`profile-${id}`);
  d.style.display = "block";
  document.getElementById(`button-${id}`).innerHTML = DownTriangle;
}

function toggleDisplay(id) {
  const d = document.getElementById(`profile-${id}`);
  if (d.style.display == "block") {
    d.style.display = "none";
    document.getElementById(`button-${id}`).innerHTML = RightTriangle;
  } else {
    d.style.display = "block";
    document.getElementById(`button-${id}`).innerHTML = DownTriangle;
  }
}

String.prototype.padWithNonBreakingSpaces = function (targetLength) {
  let nbsp = "&nbsp;";
  let padding = "";
  let currentLength = this.length * nbsp.length;
  targetLength *= nbsp.length;

  while (currentLength < targetLength) {
    padding += nbsp;
    currentLength += nbsp.length;
  }

  return padding + this;
};

async function display(prof) {
  //    console.log(JSON.stringify(prof.stacks));
  // Clear explosions.
  showedExplosion = {};
  // Restore the API key from local storage (if any).
  let old_key = "";
  old_key = window.localStorage.getItem("scalene-api-key");

  if (old_key) {
    document.getElementById("api-key").value = old_key;
    // Update the status.
    checkApiKey(old_key);
  }

  let selectedService = window.localStorage.getItem("scalene-service-select");
  if (selectedService) {
    document.getElementById("service-select").value = selectedService;
    toggleServiceFields();
  }

  // Restore the old GPU toggle from local storage (if any).
  const gpu_checkbox = document.getElementById("use-gpu-checkbox");
  old_gpu_checkbox = window.localStorage.getItem("use-gpu-checkbox");
  if (old_gpu_checkbox) {
    if (gpu_checkbox.checked.toString() != old_gpu_checkbox) {
      gpu_checkbox.click();
    }
  } else {
    // Set the GPU checkbox on if the profile indicated the presence of a GPU.
    if (gpu_checkbox.checked != prof.gpu) {
      gpu_checkbox.click();
    }
  }
  globalThis.profile = prof;
  let memory_sparklines = [];
  let memory_activity = [];
  let cpu_bars = [];
  let gpu_pies = [];
  let memory_bars = [];
  let tableID = 0;
  let s = "";
  s += '<span class="row justify-content-center">';
  s += '<span class="col-auto">';
  s += '<table width="50%" class="table text-center table-condensed">';
  s += "<tr>";
  s += `<td><font style="font-size: small"><b>Time:</b> <font color="darkblue">Python</font> | <font color="#6495ED">native</font> | <font color="blue">system</font><br /></font></td>`;
  s += '<td width="10"></td>';
  if (prof.memory) {
    s += `<td><font style="font-size: small"><b>Memory:</b> <font color="darkgreen">Python</font> | <font color="#50C878">native</font><br /></font></td>`;
    s += '<td width="10"></td>';
    s += '<td valign="middle" style="vertical-align: middle">';
    s += `<font style="font-size: small"><b>Memory timeline: </b>(max: ${memory_consumed_str(
      prof.max_footprint_mb,
    )}, growth: ${prof.growth_rate.toFixed(1)}%)</font>`;
    s += "</td>";
  }
  s += "</tr>";
  s += "<tr>";
  s +=
    '<td height="10"><span style="height: 20; width: 200; vertical-align: middle" id="cpu_bar0"></span></td>';
  s += "<td></td>";
  if (prof.memory) {
    s +=
      '<td height="20"><span style="height: 20; width: 150; vertical-align: middle" id="memory_bar0"></span></td>';
    s += "<td></td>";
    s +=
      '<td align="left"><span style="vertical-align: middle" id="memory_sparkline0"></span></td>';
    memory_sparklines.push(
      makeSparkline(
        prof.samples,
        prof.elapsed_time_sec * 1e9,
        prof.max_footprint_mb,
        0,
        { height: 20, width: 200 },
      ),
    );
  }
  s += "</tr>";

  // Compute overall usage.
  let cpu_python = 0;
  let cpu_native = 0;
  let cpu_system = 0;
  let mem_python = 0;
  let mem_native = 0;
  let max_alloc = 0;
  let cp = {};
  let cn = {};
  let cs = {};
  let mp = {};
  let ma = {};
  for (const f in prof.files) {
    cp[f] = 0;
    cn[f] = 0;
    cs[f] = 0;
    mp[f] = 0;
    ma[f] = 0;
    for (const l in prof.files[f].lines) {
      const line = prof.files[f].lines[l];
      cp[f] += line.n_cpu_percent_python;
      cn[f] += line.n_cpu_percent_c;
      cs[f] += line.n_sys_percent;
      if (line.n_peak_mb > ma[f]) {
        ma[f] = line.n_peak_mb;
        mp[f] += line.n_peak_mb * line.n_python_fraction;
      }
      max_alloc += line.n_malloc_mb;
    }
    cpu_python += cp[f];
    cpu_native += cn[f];
    cpu_system += cs[f];
    mem_python += mp[f];
  }
  cpu_bars.push(
    makeBar(cpu_python, cpu_native, cpu_system, { height: 20, width: 200 }),
  );
  if (prof.memory) {
    memory_bars.push(
      makeMemoryBar(
        prof.max_footprint_mb.toFixed(2),
        "memory",
        mem_python / max_alloc,
        prof.max_footprint_mb.toFixed(2),
        "darkgreen",
        { height: 20, width: 150 },
      ),
    );
  }

  s += '<tr><td colspan="10">';
  s += `<span class="text-center"><font style="font-size: 90%; font-style: italic; font-color: darkgray">hover over bars to see breakdowns; click on <font style="font-variant:small-caps; text-decoration:underline">column headers</font> to sort.</font></span>`;
  s += "</td></tr>";
  s += "</table>";
  s += "</span>";
  s += "</span>";

  if (JSON.stringify(prof) === "{}") {
    // Empty profile.
    s += `
    <form id="jsonFile" name="jsonFile" enctype="multipart/form-data" method="post">
      <div class="form-group">
	<div class="d-flex justify-content-center">
	  <label for='fileinput' style="padding: 5px 5px; border-radius: 5px; border: 1px ridge black; font-size: 0.8rem; height: auto;">Select a profile (.json)</label>
	  <input style="height: 0; width: 10; opacity:0" type='file' id='fileinput' accept='.json' onchange="loadFile();">
	</div>
      </div>
    </form>
    </div>`;
    const p = document.getElementById("profile");
    p.innerHTML = s;
    return;
  }

  s +=
    '<br class="text-left"><span style="font-size: 80%; color: blue; cursor : pointer;" onClick="expandAll()">&nbsp;show all</span> | <span style="font-size: 80%; color: blue; cursor : pointer;" onClick="collapseAll()">hide all</span>';
  s += ` | <span style="font-size: 80%; color: blue" onClick="document.getElementById('reduce-checkbox').click()">only display profiled lines&nbsp;</span><input type="checkbox" id="reduce-checkbox" checked onClick="toggleReduced()" /></br>`;
  s += '<div class="container-fluid">';

  // Convert files to an array and sort it in descending order by percent of CPU time.
  let files = Object.entries(prof.files);
  files.sort((x, y) => {
    return y[1].percent_cpu_time - x[1].percent_cpu_time;
  });

  // Print profile for each file
  let fileIteration = 0;
  allIds = [];
  let excludedFiles = new Set();
  for (const ff of files) {
    fileIteration++;
    // Stop once total CPU time / memory consumption are below some threshold (1%)
    // NOTE: need to incorporate GPU time here as well. FIXME.
    if (ff[1].percent_cpu_time < 1.0 && ma[ff[0]] < 0.01 * max_alloc) {
      excludedFiles.add(ff);
      continue;
    }
    const id = `file-${fileIteration}`;
    allIds.push(id);
    s +=
      '<p class="text-left sticky-top bg-white bg-opacity-75" style="backdrop-filter: blur(2px)">';
    let displayStr = "display:block;";
    let triangle = DownTriangle;
    if (fileIteration !== 1) {
      displayStr = "display:none;";
      triangle = RightTriangle;
    }

    s += `<span style="height: 20; width: 100; vertical-align: middle" id="cpu_bar${cpu_bars.length}"></span>&nbsp;`;
    cpu_bars.push(
      makeBar(cp[ff[0]], cn[ff[0]], cs[ff[0]], { height: 20, width: 100 }),
    );
    if (prof.memory) {
      s += `<span style="height: 20; width: 100; vertical-align: middle" id="memory_bar${memory_bars.length}"></span>`;
      memory_bars.push(
        makeMemoryBar(
          ma[ff[0]],
          "peak memory",
          mp[ff[0]] / ma[ff[0]],
          prof.max_footprint_mb.toFixed(2),
          "darkgreen",
          { height: 20, width: 100 },
        ),
      );
    }
    s += `<font style="font-size: 90%">% of time = ${ff[1].percent_cpu_time
      .toFixed(1)
      .padWithNonBreakingSpaces(5)}% (${time_consumed_str(
      (ff[1].percent_cpu_time / 100.0) * prof.elapsed_time_sec * 1e3,
    ).padWithNonBreakingSpaces(8)} / ${time_consumed_str(
      prof.elapsed_time_sec * 1e3,
    ).padWithNonBreakingSpaces(8)})<br />`;
    s += `<span id="button-${id}" title="Click to show or hide profile." style="cursor: pointer; color: blue;" onClick="toggleDisplay('${id}')">`;
    s += `${triangle}`;
    s += "</span>";
    s += `<code> ${ff[0]}</code>`;
    s += `</font></p>`;
    s += `<div style="${displayStr}" id="profile-${id}">`;
    s += `<table class="profile table table-hover table-condensed" id="table-${tableID}">`;
    tableID++;
      s += makeTableHeader(ff[0], prof.gpu, prof.gpu_device, prof.memory, { functions: false });
    s += "<tbody>";
    // Print per-line profiles.
    let prevLineno = -1;
    for (const l in ff[1].lines) {
      const line = ff[1].lines[l];

      if (false) {
        // Disabling spacers
        // Add a space whenever we skip a line.
        if (line.lineno > prevLineno + 1) {
          s += "<tr>";
          for (let i = 0; i < columns.length; i++) {
            s += "<td></td>";
          }
          s += `<td class="F${escape(
            ff[0],
          )}-blankline" style="line-height: 1px; background-color: lightgray" data-sort="${
            prevLineno + 1
          }">&nbsp;</td>`;
          s += "</tr>";
        }
      }
      prevLineno = line.lineno;
      s += makeProfileLine(
        line,
        ff[0],
        fileIteration,
        prof,
        cpu_bars,
        memory_bars,
        memory_sparklines,
        memory_activity,
        gpu_pies,
        true,
      );
    }
    s += "</tbody>";
    s += "</table>";
    // Print out function summaries.
    if (prof.files[ff[0]].functions.length) {
      s += `<table class="profile table table-hover table-condensed" id="table-${tableID}">`;
	s += makeTableHeader(ff[0], prof.gpu, prof.gpu_device, prof.memory, { functions: true });
      s += "<tbody>";
      tableID++;
      for (const l in prof.files[ff[0]].functions) {
        const line = prof.files[ff[0]].functions[l];
        s += makeProfileLine(
          line,
          ff[0],
          fileIteration,
          prof,
          cpu_bars,
          memory_bars,
          memory_sparklines,
          memory_activity,
          gpu_pies,
          false, // no optimizations here
        );
      }
      s += "</table>";
    }
    s += "</div>";
    //    fileIteration++;
    // Insert empty lines between files.
    if (fileIteration < files.length) {
      s += "<hr>";
    }
  }
  // Remove any excluded files.
  files = files.filter((x) => !excludedFiles.has(x));
  s += "</div>";
  const p = document.getElementById("profile");
  p.innerHTML = s;

  // Logic for turning on and off the gray line separators.

  // If you click on any header to sort (except line profiles), turn gray lines off.
  for (const ff of files) {
    const allHeaders = document.getElementsByClassName(
      `F${escape(ff[0])}-nonline`,
    );
    for (let i = 0; i < allHeaders.length; i++) {
      allHeaders[i].addEventListener("click", (e) => {
        const all = document.getElementsByClassName(
          `F${escape(ff[0])}-blankline`,
        );
        for (let i = 0; i < all.length; i++) {
          all[i].style.display = "none";
        }
      });
    }
  }

  // If you click on the line profile header, and gray lines are off, turn them back on.
  for (const ff of files) {
    document
      .getElementById(`${escape(ff[0])}-lineProfile`)
      .addEventListener("click", (e) => {
        const all = document.getElementsByClassName(
          `F${escape(ff[0])}-blankline`,
        );
        for (let i = 0; i < all.length; i++) {
          if (all[i].style.display === "none") {
            all[i].style.display = "block";
          }
        }
      });
  }

  for (let i = 0; i < tableID; i++) {
    new Tablesort(document.getElementById(`table-${i}`), { ascending: true });
  }
  memory_sparklines.forEach((p, index) => {
    if (p) {
      (async () => {
        await vegaEmbed(`#memory_sparkline${index}`, p, {
          actions: false,
          renderer: "svg",
        });
      })();
    }
  });
  cpu_bars.forEach((p, index) => {
    if (p) {
      (async () => {
        await vegaEmbed(`#cpu_bar${index}`, p, { actions: false });
      })();
    }
  });
  gpu_pies.forEach((p, index) => {
    if (p) {
      (async () => {
        await vegaEmbed(`#gpu_pie${index}`, p, { actions: false });
      })();
    }
  });
  memory_activity.forEach((p, index) => {
    if (p) {
      (async () => {
        await vegaEmbed(`#memory_activity${index}`, p, { actions: false });
      })();
    }
  });
  memory_bars.forEach((p, index) => {
    if (p) {
      (async () => {
        await vegaEmbed(`#memory_bar${index}`, p, { actions: false });
      })();
    }
  });
  // Hide all empty profiles by default.
  hideEmptyProfiles();
  if (prof.program) {
    document.title = "Scalene - " + prof.program;
  } else {
    document.title = "Scalene";
  }
}

function load(profile) {
  (async () => {
    // let resp = await fetch(jsonFile);
    // let prof = await resp.json();
    await display(profile);
  })();
}

function loadFetch() {
  (async () => {
    let resp = await fetch("profile.json");
    let profile = await resp.json();
    load(profile);
  })();
}

function loadFile() {
  const input = document.getElementById("fileinput");
  const file = input.files[0];
  const fr = new FileReader();
  fr.onload = doSomething;
  fr.readAsText(file);
}

function doSomething(e) {
  let lines = e.target.result;
  const profile = JSON.parse(lines);
  load(profile);
}

function loadDemo() {
  load(example_profile);
}

// JavaScript function to toggle fields based on selected service
function toggleServiceFields() {
  let service = document.getElementById("service-select").value;
  window.localStorage.setItem("scalene-service-select", service);
  document.getElementById("openai-fields").style.display =
    service === "openai" ? "block" : "none";
  document.getElementById("amazon-fields").style.display =
    service === "amazon" ? "block" : "none";
  document.getElementById("local-fields").style.display =
    service === "local" ? "block" : "none";
  document.getElementById("azure-openai-fields").style.display =
    service === "azure-openai" ? "block" : "none";
}

function revealInstallMessage() {
  document.getElementById("install-models-message").style.display = "block";
  document.getElementById("local-models-list").style.display = "none";
}

async function fetchModelNames() {
  try {
    const local_ip = document.getElementById("local-ip").value;
    const local_port = document.getElementById("local-port").value;
    const response = await fetch(`http://${local_ip}:${local_port}/api/tags`);
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    const data = await response.json();

    // Extracting the model names
    const modelNames = data.models.map((model) => model.name);
    if (modelNames.length === 0) {
      revealInstallMessage();
    }
    return modelNames;
  } catch (error) {
    console.error("Error fetching model names:", error);
    revealInstallMessage();
    return [];
  }
}

function createSelectElement(modelNames) {
  // Create the select element
  const select = document.createElement("select");
  select.style.fontSize = "0.8rem";
  select.id = "language-model-local";
  select.classList.add("persistent");
  select.name = "language-model-local-label";

  // Add options to the select element
  modelNames.forEach((modelName) => {
    const option = document.createElement("option");
    option.value = modelName;
    option.textContent = modelName;
    option.id = modelName;
    select.appendChild(option);
  });

  return select;
}

function replaceDivWithSelect() {
  fetchModelNames().then((modelNames) => {
    // Create the select element with options
    const selectElement = createSelectElement(modelNames);

    // Find the div and replace its content with the select element
    const div = document.getElementById("language-local-models");
    if (div) {
      div.innerHTML = ""; // Clear existing content
      div.appendChild(selectElement);
    } else {
      console.error('Div with ID "language-local-models" not found.');
    }
    atLeastOneModel = true;
  });
}

function restoreState(el) {
  const savedValue = localStorage.getItem(el.id);

  if (savedValue !== null) {
    switch (el.type) {
      case "checkbox":
      case "radio":
        el.checked = savedValue === "true";
        break;
      default:
        el.value = savedValue;
        break;
    }
  }
}

function saveState(el) {
  el.addEventListener("change", () => {
    switch (el.type) {
      case "checkbox":
      case "radio":
        localStorage.setItem(el.id, el.checked);
        break;
      default:
        localStorage.setItem(el.id, el.value);
        break;
    }
  });
}

// Process all DOM elements in the class 'persistent', which saves their state in localStorage and restores them on load.
function processPersistentElements() {
  const persistentElements = document.querySelectorAll(".persistent");

  // Restore state
  persistentElements.forEach((el) => {
    restoreState(el);
  });

  // Save state
  persistentElements.forEach((el) => {
    saveState(el);
  });
}

// Call the function to replace the div with the select element
replaceDivWithSelect();

// Handle updating persistence when the DOM is updated.
const observeDOM = () => {
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.addedNodes) {
        mutation.addedNodes.forEach((node) => {
          if (node.nodeType === 1 && node.matches(".persistent")) {
            restoreState(node);
            node.addEventListener("change", () => saveState(node));
          }
        });
      }
    });
  });

  observer.observe(document.body, {
    childList: true,
    subtree: true,
  });
};

document.addEventListener("DOMContentLoaded", () => {
  processPersistentElements();
});

observeDOM();

// We periodically send a heartbeat to the server to keep it alive.
// The server shuts down if it hasn't received a heartbeat in a sufficiently long interval;
// This handles both the case when the browser tab is closed and when the browser is shut down.
function sendHeartbeat() {
  let xhr = new XMLHttpRequest();
  xhr.open("GET", "/heartbeat", true);
  xhr.send();
}

setInterval(sendHeartbeat, 10000); // Send heartbeat every 10 seconds

      window.addEventListener("load", () => {
	  load(profile);
      });
      //load(profile);
    </script>
      <nav class="navbar fixed-bottom navbar-default justify-content-center bg-light bg-opacity-75" style="backdrop-filter: blur(2px);">
	<div class="container justify-content-center">
	  <p class="text-center">
	    <font style="font-size:small">
	      <div class="text-and-upload">
		  <a href="https://github.com/plasma-umass/scalene">Scalene</a> version 1.5.45, 2024.10.01
		  &nbsp;|&nbsp;
		  <a href="https://github.com/plasma-umass/scalene/issues/new/choose">report an issue or request a feature</a>
		  &nbsp;|&nbsp;
		  <a href="https://github.com/plasma-umass/scalene/issues/58">share your Scalene success stories</a>
		  &nbsp;|&nbsp;
		  <a href="javascript:void(0);" onclick="clickToLoadFile();">load another profile</a>
		<form id="jsonFile" name="jsonFile" enctype="multipart/form-data" method="post" style="display: inline;">
		  <input style="height: 0; width: 0; opacity: 0" type="file" id="fileinput" accept=".json" onchange="loadFile()">
		  <!-- SVG icon -->
		  <svg class="svg-upload" onclick="clickToLoadFile();" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
		    <title>Load another profile (.json)</title>
		    <g data-name="upload">
		      <rect width="16" height="2" x="4" y="4" rx="1" ry="1" transform="rotate(180 12 5)"></rect>
		      <rect width="4" height="2" x="17" y="5" rx="1" ry="1" transform="rotate(90 19 6)"></rect>
		      <rect width="4" height="2" x="3" y="5" rx="1" ry="1" transform="rotate(90 5 6)"></rect>
		      <path d="M8 14a1 1 0 0 1-.8-.4 1 1 0 0 1 .2-1.4l4-3a1 1 0 0 1 1.18 0l4 2.82a1 1 0 0 1 .24 1.39 1 1 0 0 1-1.4.24L12 11.24 8.6 13.8a1 1 0 0 1-.6.2z"></path>
		      <path d="M12 21a1 1 0 0 1-1-1v-8a1 1 0 0 1 2 0v8a1 1 0 0 1-1 1z"></path>
		    </g>
		  </svg>
		</form>
	      </div>
	    </font>
	  </p>
	</div>
      </nav>
  </body>
</html>